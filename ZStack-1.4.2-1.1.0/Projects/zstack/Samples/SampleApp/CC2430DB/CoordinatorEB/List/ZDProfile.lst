##############################################################################
#                                                                            #
# IAR 8051 C/C++ Compiler V7.20H/W32                   17/Oct/2013  21:26:01 #
# Copyright 2004-2006 IAR Systems. All rights reserved.                      #
#                                                                            #
#    Core               =  plain                                             #
#    Code model         =  banked                                            #
#    Data model         =  large                                             #
#    Calling convention =  xdata reentrant                                   #
#    Constant location  =  data                                              #
#    Dptr setup         =  1,16                                              #
#    Source file        =  D:\Texas Instruments\ZStack-1.4.2-1.1.0\Component #
#                          s\stack\zdo\ZDProfile.c                           #
#    Command line       =  -f E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿Ú #
#                          ÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\S #
#                          ampleApp\CC2430DB\..\..\..\Tools\CC2430DB\f8wCoor #
#                          d.cfg (-DCPU32MHZ -DFORCE_MAC_NEAR                #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TR #
#                          UE -DZDO_COORDINATOR -DRTR_NWK -DBLINK_LEDS       #
#                          "-DCONST=const __code" -DGENERIC=__generic) -f    #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\Tools\CC2430DB\f8wConfig. #
#                          cfg (-DSECURE=0 -DDEFAULT_CHANLIST=0x00000800     #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFFF                      #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_M #
#                          ASK=0x007F -DBEACON_REQUEST_DELAY=100             #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                    #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_P #
#                          OLLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7           #
#                          -DMAX_RREQ_ENTRIES=10 -DAPSC_MAX_FRAME_RETRIES=3  #
#                          -DNWK_MAX_DATA_RETRIES=2                          #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9        #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=20          #
#                          -DNWK_MAX_BINDING_ENTRIES=10                      #
#                          -DMAX_BINDING_CLUSTER_IDS=5                       #
#                          "-DDEFAULT_KEY={0x01, 0x03, 0x05, 0x07, 0x09,     #
#                          0x0B, 0x0D, 0x0F, 0x00, 0x02, 0x04, 0x06, 0x08,   #
#                          0x0A, 0x0C, 0x0D}" -DRFD_RCVC_ALWAYS_ON=FALSE     #
#                          -DPOLL_RATE=1000 -DQUEUED_POLL_RATE=100           #
#                          -DRESPONSE_POLL_RATE=100 -DREJOIN_POLL_RATE=440   #
#                          -DTOP_BOOT_PAGES=0) -I "D:\Program Files\IAR      #
#                          Systems\Embedded Workbench 4.05 Evaluation        #
#                          version\8051\inc\" -I "D:\Program Files\IAR       #
#                          Systems\Embedded Workbench 4.05 Evaluation        #
#                          version\8051\inc\clib\" -I                        #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ #
#                          ¶Æ½Ì¨\CC2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\ #
#                          zstack\Samples\SampleApp\CC2430DB\..\Source\ -I   #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\ZMain\TI2430DB\ -I        #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\mt\ -I   #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\hal\incl #
#                          ude\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC243 #
#                          0´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samp #
#                          les\SampleApp\CC2430DB\..\..\..\..\..\Components\ #
#                          hal\target\CC2430EB\ -I                           #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\osal\mcu #
#                          \ccsoc\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC #
#                          2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\S #
#                          amples\SampleApp\CC2430DB\..\..\..\..\..\Componen #
#                          ts\osal\include\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨ #
#                          Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects #
#                          \zstack\Samples\SampleApp\CC2430DB\..\..\..\..\.. #
#                          \Components\stack\af\ -I                          #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\stack\nw #
#                          k\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´ #
#                          ®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Sample #
#                          s\SampleApp\CC2430DB\..\..\..\..\..\Components\st #
#                          ack\sec\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\C #
#                          C2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\ #
#                          Samples\SampleApp\CC2430DB\..\..\..\..\..\Compone #
#                          nts\stack\sys\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶ #
#                          Æ½Ì¨\CC2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\z #
#                          stack\Samples\SampleApp\CC2430DB\..\..\..\..\..\C #
#                          omponents\stack\zdo\ -I                           #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\zmac\f8w #
#                          \ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´® #
#                          ¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples #
#                          \SampleApp\CC2430DB\..\..\..\..\..\Components\zma #
#                          c\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´ #
#                          ®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Sample #
#                          s\SampleApp\CC2430DB\..\..\..\..\..\Components\se #
#                          rvices\saddr\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ #
#                          ½Ì¨\CC2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zs #
#                          tack\Samples\SampleApp\CC2430DB\..\..\..\..\..\Co #
#                          mponents\services\sdata\ -I                       #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\mac\incl #
#                          ude\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC243 #
#                          0´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samp #
#                          les\SampleApp\CC2430DB\..\..\..\..\..\Components\ #
#                          mac\high_level\ -I E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ #
#                          ¶Æ½Ì¨\CC2430´®¿ÚÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\ #
#                          zstack\Samples\SampleApp\CC2430DB\..\..\..\..\..\ #
#                          Components\mac\low_level\srf03\ -I                #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\..\..\..\..\..\Components\mac\low_ #
#                          level\srf03\single_chip\ -D CC2430EB -D ZTOOL_P1  #
#                          -D MT_TASK -D MT_ZDO_FUNC -lC                     #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\CoordinatorEB\List\ -lA            #
#                          E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\CoordinatorEB\List\                #
#                          --diag_suppress Pe001,Pa010 --diag_remark pe550   #
#                          -o E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿Ú #
#                          ÊÕ·¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\S #
#                          ampleApp\CC2430DB\CoordinatorEB\Obj\ -e           #
#                          --require_prototypes -z9 --no_code_motion         #
#                          --debug --core=plain --dptr=16,1                  #
#                          --data_model=large --code_model=banked            #
#                          --calling_convention=xdata_reentrant              #
#                          --place_constants=data --nr_virtual_regs 8        #
#                          "D:\Texas Instruments\ZStack-1.4.2-1.1.0\Componen #
#                          ts\stack\zdo\ZDProfile.c"                         #
#    List file          =  E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\CoordinatorEB\List\ZDProfile.lst   #
#    Object file        =  E:\CPESÆ½Ì¨\Ó²¼þÆ½Ì¨\CC2430Í¨Ñ¶Æ½Ì¨\CC2430´®¿ÚÊÕ· #
#                          ¢\ZStack-1.4.2-1.1.0\Projects\zstack\Samples\Samp #
#                          leApp\CC2430DB\CoordinatorEB\Obj\ZDProfile.r51    #
#                                                                            #
#                                                                            #
##############################################################################

D:\Texas Instruments\ZStack-1.4.2-1.1.0\Components\stack\zdo\ZDProfile.c
      1          /*********************************************************************
      2              Filename:       ZDProfile.c
      3              Revised:        $Date: 2007-05-14 17:34:18 -0700 (Mon, 14 May 2007) $
      4              Revision:       $Revision: 14296 $
      5          
      6              Description:
      7          
      8                This Zigbee Device Profile.
      9          
     10              Notes:
     11          
     12              Copyright (c) 2006 by Texas Instruments, Inc.
     13              All Rights Reserved.  Permission to use, reproduce, copy, prepare
     14              derivative works, modify, distribute, perform, display or sell this
     15              software and/or its documentation for any purpose is prohibited
     16              without the express written consent of Texas Instruments, Inc.
     17          *********************************************************************/
     18          
     19          /*********************************************************************
     20           * INCLUDES
     21           */
     22          #include "ZComdef.h"
     23          #include "OSAL.h"
     24          #include "AF.h"
     25          #include "NLMEDE.h"
     26          #include "nwk_util.h"
     27          #include "APS.h"
     28          
     29          #include "ZDCache.h"
     30          #include "ZDConfig.h"
     31          #include "ZDProfile.h"
     32          #include "ZDObject.h"
     33          
     34          #if defined( LCD_SUPPORTED )
     35            #include "OnBoard.h"
     36          #endif
     37          
     38          #include "nwk_util.h"
     39          
     40          /*********************************************************************
     41           * MACROS
     42           */
     43          
     44          #define ZADDR_TO_AFADDR( pZADDR, AFADDR ) {                            \
     45            (AFADDR).endPoint = ZDP_AF_ENDPOINT;                                 \
     46            (AFADDR).addrMode = (afAddrMode_t)(pZADDR)->addrMode;                \
     47            (AFADDR).addr.shortAddr = (pZADDR)->addr.shortAddr;                  \
     48          }
     49          
     50          #define FillAndSendBuffer( TRANSSEQ, ADDR, ID, LEN, BUF ) {     \
     51            afStatus_t stat;                                    \
     52            ZDP_TmpBuf = (BUF)+1;                               \
     53            stat = fillAndSend( (TRANSSEQ), (ADDR), (ID), (LEN) );          \
     54            ZDP_TmpBuf = ZDP_Buf+1;                             \
     55            return stat;                                        \
     56          }
     57          
     58          #define FillAndSendTxOptions( TRANSSEQ, ADDR, ID, LEN, TxO ) {  \
     59            afStatus_t stat;                                    \
     60            ZDP_TxOptions = (TxO);                              \
     61            stat = fillAndSend( (TRANSSEQ), (ADDR), (ID), (LEN) );          \
     62            ZDP_TxOptions = AF_TX_OPTIONS_NONE;                 \
     63            return stat;                                        \
     64          }
     65          
     66          /*********************************************************************
     67           * CONSTANTS
     68           */
     69          
     70          #define ZDP_BUF_SZ          80
     71          

   \                                 In segment CODE_C, align 1
     72          CONST byte ZDP_AF_ENDPOINT = 0;
   \                     ZDP_AF_ENDPOINT:
   \   000000   00           DB 0
     73          
     74          /*********************************************************************
     75           * TYPEDEFS
     76           */
     77          
     78          /*********************************************************************
     79           * GLOBAL VARIABLES
     80           */
     81          

   \                                 In segment XDATA_Z, align 1, keep-with-next
   \   000000                REQUIRE __INIT_XDATA_Z
     82          byte ZDP_TransID = 0;
   \                     ZDP_TransID:
   \   000000                DS 1
     83          
     84          /*********************************************************************
     85           * EXTERNAL VARIABLES
     86           */
     87          
     88          extern endPointDesc_t ZDApp_epDesc;
     89          
     90          /*********************************************************************
     91           * EXTERNAL FUNCTIONS
     92           */
     93          
     94          /*********************************************************************
     95           * LOCAL FUNCTIONS
     96           */
     97          
     98          static afStatus_t fillAndSend( uint8 *transSeq, zAddrType_t *addr, cId_t clusterID, byte len );
     99          
    100          /*********************************************************************
    101           * LOCAL VARIABLES
    102           */
    103          

   \                                 In segment XDATA_Z, align 1, keep-with-next
   \   000000                REQUIRE __INIT_XDATA_Z
    104          static byte  ZDP_Buf[ ZDP_BUF_SZ ];
   \                     ??ZDP_Buf:
   \   000000                DS 80

   \                                 In segment XDATA_I, align 1, keep-with-next
    105          static byte *ZDP_TmpBuf = ZDP_Buf+1;
   \                     ??ZDP_TmpBuf:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for ZDP_TmpBuf>`
   \   000002                REQUIRE __INIT_XDATA_I

   \                                 In segment XDATA_Z, align 1, keep-with-next
   \   000000                REQUIRE __INIT_XDATA_Z
    106          static byte ZDP_TxOptions = AF_TX_OPTIONS_NONE;
   \                     ??ZDP_TxOptions:
   \   000000                DS 1
    107          
    108          /*********************************************************************
    109           * @fn          fillAndSend
    110           *
    111           * @brief       Combined to reduce space
    112           *
    113           * @param
    114           * @param
    115           *
    116           * @return      afStatus_t
    117           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    118          static afStatus_t fillAndSend( uint8 *transSeq, zAddrType_t *addr, cId_t clusterID, byte len )
   \                     ??fillAndSend:
    119          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 4
   \   000005   74FC         MOV     A,#-0x4
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 0,R2
   \   00000C   8B..         MOV     ?V0 + 1,R3
   \   00000E   7413         MOV     A,#0x13
   \   000010   12....       LCALL   ?XSTACK_DISP0_8
   \   000013   12....       LCALL   ?Subroutine49 & 0xFFFF
    120          #if ( AF_V1_SUPPORT )
    121          
    122            byte proVer = NLME_GetProtocolVersion();
    123          #endif
    124            afAddrType_t afAddr;
    125          
    126            ZADDR_TO_AFADDR( addr, afAddr );
   \                     ??CrossCallReturnLabel_116:
   \   000016   7403         MOV     A,#0x3
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   E4           CLR     A
   \   00001C   F0           MOVX    @DPTR,A
   \   00001D   8C82         MOV     DPL,R4
   \   00001F   8D83         MOV     DPH,R5
   \   000021   A3           INC     DPTR
   \   000022   A3           INC     DPTR
   \   000023   A3           INC     DPTR
   \   000024   A3           INC     DPTR
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   E0           MOVX    A,@DPTR
   \   00002A   C0E0         PUSH    A
   \   00002C   7402         MOV     A,#0x2
   \   00002E   12....       LCALL   ?XSTACK_DISP0_8
   \   000031   D0E0         POP     A
   \   000033   F0           MOVX    @DPTR,A
   \   000034   8C82         MOV     DPL,R4
   \   000036   8D83         MOV     DPH,R5
   \   000038   E0           MOVX    A,@DPTR
   \   000039   FA           MOV     R2,A
   \   00003A   A3           INC     DPTR
   \   00003B   E0           MOVX    A,@DPTR
   \   00003C   FB           MOV     R3,A
   \   00003D   85..82       MOV     DPL,?XSP + 0
   \   000040   85..83       MOV     DPH,?XSP + 1
   \   000043   EA           MOV     A,R2
   \   000044   F0           MOVX    @DPTR,A
   \   000045   A3           INC     DPTR
   \   000046   EB           MOV     A,R3
   \   000047   F0           MOVX    @DPTR,A
    127          
    128          #if ( AF_V1_SUPPORT )
    129            if ( proVer == ZB_PROT_V1_0 )
    130            {
    131              return ( afFillAndSendMessage( &afAddr, ZDP_AF_ENDPOINT, clusterID,
    132                         1, FRAMETYPE_MSG, transSeq,
    133                         NULL, NULL, NULL, NULL, len, ZDP_TmpBuf,
    134                         ZDP_TxOptions, FALSE, AF_DEFAULT_RADIUS ) );
    135            }
    136            else
    137          #endif
    138            {
    139              *(ZDP_TmpBuf-1) = *transSeq;
   \   000048   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   00004B   E0           MOVX    A,@DPTR
   \   00004C   24FF         ADD     A,#-0x1
   \   00004E   F5..         MOV     ?V0 + 4,A
   \   000050   A3           INC     DPTR
   \   000051   E0           MOVX    A,@DPTR
   \   000052   34FF         ADDC    A,#-0x1
   \   000054   F5..         MOV     ?V0 + 5,A
   \   000056   85..82       MOV     DPL,?V0 + 0
   \   000059   85..83       MOV     DPH,?V0 + 1
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   85..82       MOV     DPL,?V0 + 4
   \   000060   85..83       MOV     DPH,?V0 + 5
   \   000063   F0           MOVX    @DPTR,A
    140          
    141              return AF_DataRequest( &afAddr, &ZDApp_epDesc, clusterID,
    142                                     (uint16)(len+1), (uint8*)(ZDP_TmpBuf-1),
    143                                     transSeq, ZDP_TxOptions,  AF_DEFAULT_RADIUS );
   \   000064                ; Setup parameters for call to function AF_DataRequest
   \   000064   75..0A       MOV     ?V0 + 6,#0xa
   \   000067   78..         MOV     R0,#?V0 + 6
   \   000069   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00006C   78..         MOV     R0,#?V0 + 0
   \   00006E   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000071   78..         MOV     R0,#?V0 + 4
   \   000073   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000076   89..         MOV     ?V0 + 0,R1
   \   000078   7401         MOV     A,#0x1
   \   00007A   25..         ADD     A,?V0 + 0
   \   00007C   F5..         MOV     ?V0 + 0,A
   \   00007E   E4           CLR     A
   \   00007F   3400         ADDC    A,#0x0
   \   000081   F5..         MOV     ?V0 + 1,A
   \   000083   78..         MOV     R0,#?V0 + 0
   \   000085   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000088   78..         MOV     R0,#?V0 + 2
   \   00008A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00008D   90....       MOV     DPTR,#??ZDP_TxOptions
   \   000090   E0           MOVX    A,@DPTR
   \   000091   F9           MOV     R1,A
   \   000092   7C..         MOV     R4,#(ZDApp_epDesc & 0xff)
   \   000094   7D..         MOV     R5,#((ZDApp_epDesc >> 8) & 0xff)
   \   000096   7409         MOV     A,#0x9
   \   000098   12....       LCALL   ?XSTACK_DISP0_8
   \   00009B   AA82         MOV     R2,DPL
   \   00009D   AB83         MOV     R3,DPH
   \   00009F   90....       MOV     DPTR,#(AF_DataRequest & 0xffff)
   \   0000A2   74..         MOV     A,#((AF_DataRequest >> 16) & 0xff)
   \   0000A4   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000A7   7409         MOV     A,#0x9
   \   0000A9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000AC   7404         MOV     A,#0x4
   \   0000AE                REQUIRE ?Subroutine62
   \   0000AE                ; // Fall through to label ?Subroutine62
    144            }
    145          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine62:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F07         MOV     R7,#0x7
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine49:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F5..         MOV     ?V0 + 2,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   F5..         MOV     ?V0 + 3,A
   \   000007   22           RET
    146          
    147          /*********************************************************************
    148           * @fn          ZDP_SendData
    149           *
    150           * @brief       This builds and send a request message that has
    151           *              NWKAddrOfInterest as its only parameter.
    152           *
    153           * @param       dstAddr - destination address
    154           * @param       cmd - clusterID
    155           * @param       dataLen - number of bytes of data
    156           * @param       data - pointer to the data
    157           * @param       SecurityEnable - Security Options
    158           *
    159           * @return      afStatus_t
    160           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    161          afStatus_t ZDP_SendData( byte *TransSeq, zAddrType_t *dstAddr, uint16 cmd,
   \                     ZDP_SendData:
    162                                  byte len, byte *buf, byte SecurityEnable )
    163          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   89..         MOV     ?V0 + 2,R1
   \   000007   740E         MOV     A,#0xe
   \   000009   12....       LCALL   ?XSTACK_DISP0_8
   \   00000C   12....       LCALL   ??Subroutine18_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_45:
   \   00000F   7410         MOV     A,#0x10
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   12....       LCALL   ??Subroutine25_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_62:
   \   000017   7412         MOV     A,#0x12
   \   000019   12....       LCALL   ?XSTACK_DISP0_8
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   F5..         MOV     ?V0 + 3,A
    164            byte *pBuf = ZDP_TmpBuf;
   \   00001F   12....       LCALL   ?Subroutine14 & 0xFFFF
    165            byte cnt = len;
   \                     ??CrossCallReturnLabel_30:
   \   000022   85....       MOV     ?V0 + 4,?V0 + 2
   \   000025   8010         SJMP    ??ZDP_SendData_0
    166          
    167            while ( cnt-- )
    168            {
    169              *pBuf++ = *buf++;
   \                     ??ZDP_SendData_1:
   \   000027   12....       LCALL   ?Subroutine22 & 0xFFFF
   \                     ??CrossCallReturnLabel_151:
   \   00002A   AE82         MOV     R6,DPL
   \   00002C   AF83         MOV     R7,DPH
   \   00002E   8882         MOV     DPL,R0
   \   000030   8983         MOV     DPH,R1
   \   000032   A3           INC     DPTR
   \   000033   A882         MOV     R0,DPL
   \   000035   A983         MOV     R1,DPH
    170            }
   \                     ??ZDP_SendData_0:
   \   000037   85....       MOV     ?V0 + 5,?V0 + 4
   \   00003A   74FF         MOV     A,#-0x1
   \   00003C   25..         ADD     A,?V0 + 5
   \   00003E   F5..         MOV     ?V0 + 4,A
   \   000040   E5..         MOV     A,?V0 + 5
   \   000042   70E3         JNZ     ??ZDP_SendData_1
    171          
    172            FillAndSendTxOptions( TransSeq, dstAddr, cmd, len,
    173                         (AF_DEFAULT_RADIUS | ((SecurityEnable) ? AF_EN_SECURITY : 0)) );
   \   000044   E5..         MOV     A,?V0 + 3
   \   000046   6004         JZ      ??ZDP_SendData_2
   \   000048   7840         MOV     R0,#0x40
   \   00004A   8002         SJMP    ??ZDP_SendData_3
   \                     ??ZDP_SendData_2:
   \   00004C   7800         MOV     R0,#0x0
   \                     ??ZDP_SendData_3:
   \   00004E   E8           MOV     A,R0
   \   00004F   440A         ORL     A,#0xa
   \   000051   90....       MOV     DPTR,#??ZDP_TxOptions
   \   000054   F0           MOVX    @DPTR,A
   \   000055                ; Setup parameters for call to function fillAndSend
   \   000055   78..         MOV     R0,#?V0 + 0
   \   000057   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005A   A9..         MOV     R1,?V0 + 2
   \   00005C   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00005F   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   000061   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000064   7402         MOV     A,#0x2
   \   000066   12....       LCALL   ?DEALLOC_XSTACK8
   \   000069   E4           CLR     A
   \   00006A   90....       MOV     DPTR,#??ZDP_TxOptions
   \   00006D   F0           MOVX    @DPTR,A
   \   00006E   7F06         MOV     R7,#0x6
   \   000070   02....       LJMP    ?BANKED_LEAVE_XDATA
    174          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine66:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004   A3           INC     DPTR
   \   000005   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine22:
   \   000000   8E82         MOV     DPL,R6
   \   000002   8F83         MOV     DPH,R7
   \   000004   E0           MOVX    A,@DPTR
   \   000005   8882         MOV     DPL,R0
   \   000007   8983         MOV     DPH,R1
   \   000009   F0           MOVX    @DPTR,A
   \   00000A   80..         SJMP    ?Subroutine66

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine18:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \                     ??Subroutine18_0:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F5..         MOV     ?V0 + 0,A
   \   000006   A3           INC     DPTR
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F5..         MOV     ?V0 + 1,A
   \   00000A   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine25:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \                     ??Subroutine25_0:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FE           MOV     R6,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FF           MOV     R7,A
   \   000008   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine14:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \                     ??Subroutine14_0:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F8           MOV     R0,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   F9           MOV     R1,A
   \   000008   22           RET
    175          
    176          #if defined ( ZDO_NODEDESC_REQUEST ) || defined ( ZDO_POWERDESC_REQUEST ) ||\
    177              defined ( ZDO_ACTIVEEP_REQUEST ) || defined ( ZDO_COMPLEXDESC_REQUEST ) ||\
    178              defined ( ZDO_USERDESC_REQUEST )
    179          /*********************************************************************
    180           * @fn          ZDP_NWKAddrOfInterestReq
    181           *
    182           * @brief       This builds and send a request message that has
    183           *              NWKAddrOfInterest as its only parameter.
    184           *
    185           * @param       dstAddr - destination address
    186           * @param       nwkAddr - 16 bit address
    187           * @param       SecurityEnable - Security Options
    188           *
    189           * @return      afStatus_t
    190           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    191          afStatus_t ZDP_NWKAddrOfInterestReq( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_NWKAddrOfInterestReq:
    192                                               byte cmd, byte SecurityEnable )
    193          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    194            ZDP_TmpBuf[0] = LO_UINT16( nwkAddr );
   \   000005   12....       LCALL   ?Subroutine5 & 0xFFFF
    195            ZDP_TmpBuf[1] = HI_UINT16( nwkAddr );
    196          
    197            return fillAndSend( &ZDP_TransID, dstAddr, cmd, 2 );
   \                     ??CrossCallReturnLabel_14:
   \   000008                ; Setup parameters for call to function fillAndSend
   \   000008   89..         MOV     ?V0 + 0,R1
   \   00000A   75..00       MOV     ?V0 + 1,#0x0
   \   00000D   78..         MOV     R0,#?V0 + 0
   \   00000F   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000012   7902         MOV     R1,#0x2
   \   000014                REQUIRE ?Subroutine70
   \   000014                ; // Fall through to label ?Subroutine70
    198          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine70:
   \   000000   EA           MOV     A,R2
   \   000001   FC           MOV     R4,A
   \   000002   EB           MOV     A,R3
   \   000003   FD           MOV     R5,A
   \   000004   7A..         MOV     R2,#(ZDP_TransID & 0xff)
   \   000006   7B..         MOV     R3,#((ZDP_TransID >> 8) & 0xff)
   \   000008   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00000B   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   00000D   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000010   7402         MOV     A,#0x2
   \   000012   80..         SJMP    ??Subroutine63_1

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine63:
   \   000000   EA           MOV     A,R2
   \   000001   FC           MOV     R4,A
   \   000002   EB           MOV     A,R3
   \                     ??Subroutine63_0:
   \   000003   FD           MOV     R5,A
   \   000004   7402         MOV     A,#0x2
   \   000006   12....       LCALL   ?XSTACK_DISP0_8
   \   000009   AA82         MOV     R2,DPL
   \   00000B   AB83         MOV     R3,DPH
   \   00000D   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   000010   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   000012   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000015   7402         MOV     A,#0x2
   \   000017   12....       LCALL   ?DEALLOC_XSTACK8
   \   00001A   7401         MOV     A,#0x1
   \                     ??Subroutine63_1:
   \   00001C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00001F   7F02         MOV     R7,#0x2
   \   000021   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine5:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   000003   12....       LCALL   ?Subroutine61 & 0xFFFF
   \                     ??CrossCallReturnLabel_146:
   \   000006   EC           MOV     A,R4
   \   000007   F0           MOVX    @DPTR,A
   \   000008   12....       LCALL   ?Subroutine48 & 0xFFFF
   \                     ??CrossCallReturnLabel_112:
   \   00000B   ED           MOV     A,R5
   \   00000C   F0           MOVX    @DPTR,A
   \   00000D   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine48:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \                     ??Subroutine48_0:
   \   000003   12....       LCALL   ?Subroutine61 & 0xFFFF
   \                     ??CrossCallReturnLabel_147:
   \   000006   A3           INC     DPTR
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine61:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002                REQUIRE ?Subroutine65
   \   000002                ; // Fall through to label ?Subroutine65

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine65:
   \   000000   A3           INC     DPTR
   \   000001   E0           MOVX    A,@DPTR
   \   000002   F583         MOV     DPH,A
   \   000004   8882         MOV     DPL,R0
   \   000006   22           RET
    199          #endif // ZDO_NODEDESC_REQUEST ZDO_POWERDESC_REQUEST ZDO_ACTIVEEP_REQUEST ZDO_COMPLEXDESC_REQUEST  ZDO_USERDESC_REQUEST
    200          
    201          /*********************************************************************
    202           * Address Requests
    203           */
    204          
    205          #if defined ( ZDO_NWKADDR_REQUEST )
    206          /*********************************************************************
    207           * @fn          ZDP_NwkAddrReq
    208           *
    209           * @brief       This builds and send a NWK_addr_req message.  This
    210           *              function sends a broadcast message looking for a 16
    211           *              bit address with a 64 bit address as bait.
    212           *
    213           * @param       IEEEAddress - looking for this device
    214           * @param       SecurityEnable - Security Options
    215           *
    216           * @return      afStatus_t
    217           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    218          afStatus_t ZDP_NwkAddrReq( byte *IEEEAddress, byte ReqType,
   \                     ZDP_NwkAddrReq:
    219                                     byte StartIndex, byte SecurityEnable )
    220          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   8A..         MOV     ?V0 + 2,R2
   \   00000C   8B..         MOV     ?V0 + 3,R3
   \   00000E   89..         MOV     ?V0 + 0,R1
   \   000010   8C..         MOV     ?V0 + 1,R4
    221            byte *pBuf = ZDP_TmpBuf;
   \   000012   12....       LCALL   ?Subroutine25 & 0xFFFF
    222            byte len = Z_EXTADDR_LEN + 1 + 1;  // IEEEAddress + ReqType + StartIndex.
    223            zAddrType_t dstAddr;
    224          
    225            if ( osal_ExtAddrEqual( saveExtAddr, IEEEAddress ) == FALSE )
   \                     ??CrossCallReturnLabel_63:
   \   000015                ; Setup parameters for call to function osal_ExtAddrEqual
   \   000015   AC..         MOV     R4,?V0 + 2
   \   000017   AD..         MOV     R5,?V0 + 3
   \   000019   7A..         MOV     R2,#(saveExtAddr & 0xff)
   \   00001B   7B..         MOV     R3,#((saveExtAddr >> 8) & 0xff)
   \   00001D   90....       MOV     DPTR,#(osal_ExtAddrEqual & 0xffff)
   \   000020   74..         MOV     A,#((osal_ExtAddrEqual >> 16) & 0xff)
   \   000022   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000025   E9           MOV     A,R1
   \   000026   700E         JNZ     ??ZDP_NwkAddrReq_0
    226            {
    227              dstAddr.addrMode = AddrBroadcast;
   \   000028   7408         MOV     A,#0x8
   \   00002A   12....       LCALL   ?XSTACK_DISP0_8
   \   00002D   12....       LCALL   ?Subroutine32 & 0xFFFF
    228              dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
   \                     ??CrossCallReturnLabel_76:
   \   000030   74FF         MOV     A,#-0x1
   \   000032   F0           MOVX    @DPTR,A
   \   000033   A3           INC     DPTR
   \   000034   800E         SJMP    ??CrossCallReturnLabel_28
    229            }
    230            else
    231            {
    232              dstAddr.addrMode = Addr16Bit;
   \                     ??ZDP_NwkAddrReq_0:
   \   000036   7408         MOV     A,#0x8
   \   000038   12....       LCALL   ?XSTACK_DISP0_8
   \   00003B   7402         MOV     A,#0x2
   \   00003D   F0           MOVX    @DPTR,A
    233              dstAddr.addr.shortAddr = ZDAppNwkAddr.addr.shortAddr;
   \   00003E   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000041   12....       LCALL   ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_28:
   \   000044   F0           MOVX    @DPTR,A
    234            }
    235          
    236            pBuf = osal_cpyExtAddr( pBuf, IEEEAddress );
   \   000045                ; Setup parameters for call to function osal_cpyExtAddr
   \   000045   AC..         MOV     R4,?V0 + 2
   \   000047   AD..         MOV     R5,?V0 + 3
   \   000049   EE           MOV     A,R6
   \   00004A   FA           MOV     R2,A
   \   00004B   EF           MOV     A,R7
   \   00004C   FB           MOV     R3,A
   \   00004D   90....       MOV     DPTR,#(osal_cpyExtAddr & 0xffff)
   \   000050   74..         MOV     A,#((osal_cpyExtAddr >> 16) & 0xff)
   \   000052   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000055   8A..         MOV     ?V0 + 2,R2
   \   000057   8B..         MOV     ?V0 + 3,R3
   \   000059   AE..         MOV     R6,?V0 + 2
   \   00005B   AF..         MOV     R7,?V0 + 3
    237          
    238            *pBuf++ = ReqType;
   \   00005D   8E82         MOV     DPL,R6
   \   00005F   8F83         MOV     DPH,R7
   \   000061   E5..         MOV     A,?V0 + 0
   \   000063   F0           MOVX    @DPTR,A
    239            *pBuf++ = StartIndex;
   \   000064   A3           INC     DPTR
   \   000065   E5..         MOV     A,?V0 + 1
   \   000067   F0           MOVX    @DPTR,A
    240          
    241            return fillAndSend( &ZDP_TransID, &dstAddr, NWK_addr_req, len );
   \   000068                ; Setup parameters for call to function fillAndSend
   \   000068   75..00       MOV     ?V0 + 0,#0x0
   \   00006B   75..00       MOV     ?V0 + 1,#0x0
   \   00006E   78..         MOV     R0,#?V0 + 0
   \   000070   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000073   790A         MOV     R1,#0xa
   \   000075   7402         MOV     A,#0x2
   \   000077   12....       LCALL   ?XSTACK_DISP0_8
   \   00007A   AC82         MOV     R4,DPL
   \   00007C   AD83         MOV     R5,DPH
   \   00007E   7A..         MOV     R2,#(ZDP_TransID & 0xff)
   \   000080   7B..         MOV     R3,#((ZDP_TransID >> 8) & 0xff)
   \   000082   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   000085   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   000087   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   00008A   7402         MOV     A,#0x2
   \   00008C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00008F   7409         MOV     A,#0x9
   \   000091                REQUIRE ?Subroutine64
   \   000091                ; // Fall through to label ?Subroutine64
    242          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine64:
   \   000000   12....       LCALL   ?DEALLOC_XSTACK8
   \   000003   7F04         MOV     R7,#0x4
   \   000005   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine32:
   \   000000   740F         MOV     A,#0xf
   \                     ??Subroutine32_0:
   \   000002   F0           MOVX    @DPTR,A
   \   000003   85..82       MOV     DPL,?XSP + 0
   \   000006   85..83       MOV     DPH,?XSP + 1
   \   000009   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine13:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F8           MOV     R0,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   F9           MOV     R1,A
   \   000005   85..82       MOV     DPL,?XSP + 0
   \   000008   85..83       MOV     DPH,?XSP + 1
   \   00000B   E8           MOV     A,R0
   \   00000C   F0           MOVX    @DPTR,A
   \   00000D   A3           INC     DPTR
   \   00000E   E9           MOV     A,R1
   \   00000F   22           RET
    243          #endif
    244          
    245          #if defined ( ZDO_IEEEADDR_REQUEST )
    246          /*********************************************************************
    247           * @fn          ZDP_IEEEAddrReq
    248           *
    249           * @brief       This builds and send a IEEE_addr_req message.  This
    250           *              function sends a unicast message looking for a 64
    251           *              bit IEEE address with a 16 bit address as bait.
    252           *
    253           * @param       ReqType - ZDP_IEEEADDR_REQTYPE_SINGLE or
    254           *                        ZDP_IEEEADDR_REQTYPE_EXTENDED
    255           * @param       SecurityEnable - Security Options
    256           *
    257           * @return      afStatus_t
    258           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    259          afStatus_t ZDP_IEEEAddrReq( uint16 shortAddr, byte ReqType,
   \                     ZDP_IEEEAddrReq:
    260                                      byte StartIndex, byte SecurityEnable )
    261          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FD           MOV     R5,A
    262            byte *pBuf = ZDP_TmpBuf;
   \   00000C   12....       LCALL   ?Subroutine14 & 0xFFFF
    263            byte len = 2 + 1 + 1;  // shortAddr + ReqType + StartIndex.
    264            zAddrType_t dstAddr;
    265          
    266            dstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \                     ??CrossCallReturnLabel_31:
   \   00000F   7408         MOV     A,#0x8
   \   000011   12....       LCALL   ?XSTACK_DISP0_8
   \   000014   7402         MOV     A,#0x2
   \   000016   12....       LCALL   ??Subroutine32_0 & 0xFFFF
    267            dstAddr.addr.shortAddr = shortAddr;
   \                     ??CrossCallReturnLabel_78:
   \   000019   EA           MOV     A,R2
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   A3           INC     DPTR
   \   00001C   EB           MOV     A,R3
   \   00001D   F0           MOVX    @DPTR,A
    268          
    269            *pBuf++ = LO_UINT16( shortAddr );
   \   00001E   EA           MOV     A,R2
   \   00001F   8882         MOV     DPL,R0
   \   000021   8983         MOV     DPH,R1
   \   000023   F0           MOVX    @DPTR,A
   \   000024   A3           INC     DPTR
    270            *pBuf++ = HI_UINT16( shortAddr );
   \   000025   EB           MOV     A,R3
   \   000026   F0           MOVX    @DPTR,A
   \   000027   A3           INC     DPTR
    271          
    272            *pBuf++ = ReqType;
   \   000028   ED           MOV     A,R5
   \   000029   F0           MOVX    @DPTR,A
    273            *pBuf++ = StartIndex;
   \   00002A   EC           MOV     A,R4
   \   00002B   A3           INC     DPTR
   \   00002C   F0           MOVX    @DPTR,A
    274          
    275            return fillAndSend( &ZDP_TransID, &dstAddr, IEEE_addr_req, len );
   \   00002D                ; Setup parameters for call to function fillAndSend
   \   00002D   75..01       MOV     ?V0 + 0,#0x1
   \   000030   75..00       MOV     ?V0 + 1,#0x0
   \   000033   78..         MOV     R0,#?V0 + 0
   \   000035   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000038   7904         MOV     R1,#0x4
   \   00003A   7402         MOV     A,#0x2
   \   00003C   12....       LCALL   ?XSTACK_DISP0_8
   \   00003F   AC82         MOV     R4,DPL
   \   000041   AD83         MOV     R5,DPH
   \   000043   7A..         MOV     R2,#(ZDP_TransID & 0xff)
   \   000045   7B..         MOV     R3,#((ZDP_TransID >> 8) & 0xff)
   \   000047   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00004A   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   00004C   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   00004F   7402         MOV     A,#0x2
   \   000051   12....       LCALL   ?DEALLOC_XSTACK8
   \   000054                REQUIRE ?Subroutine71
   \   000054                ; // Fall through to label ?Subroutine71
    276          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine71:
   \   000000   7409         MOV     A,#0x9
   \   000002   02....       LJMP    ??Subroutine63_1 & 0xFFFF
    277          #endif
    278          
    279          #if defined ( ZDO_MATCH_REQUEST )
    280          /*********************************************************************
    281           * @fn          ZDP_MatchDescReq
    282           *
    283           * @brief       This builds and send a Match_Desc_req message.  This
    284           *              function sends a broadcast or unicast message
    285           *              requesting the list of endpoint/interfaces that
    286           *              match profile ID and cluster IDs.
    287           *
    288           * @param       dstAddr - destination address
    289           * @param       ProfileID - Profile ID
    290           * @param       NumInClusters - number of input clusters
    291           * @param       InClusterList - input cluster ID list
    292           * @param       NumOutClusters - number of output clusters
    293           * @param       OutClusterList - output cluster ID list
    294           * @param       SecurityEnable - Security Options
    295           *
    296           * @return      afStatus_t
    297           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    298          afStatus_t ZDP_MatchDescReq( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_MatchDescReq:
    299                                          uint16 ProfileID,
    300                                          byte NumInClusters, cId_t *InClusterList,
    301                                          byte NumOutClusters, cId_t *OutClusterList,
    302                                          byte SecurityEnable )
    303          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 2
   \   000005   74FE         MOV     A,#-0x2
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   85..82       MOV     DPL,?XSP + 0
   \   00000D   85..83       MOV     DPH,?XSP + 1
   \   000010   EA           MOV     A,R2
   \   000011   F0           MOVX    @DPTR,A
   \   000012   A3           INC     DPTR
   \   000013   EB           MOV     A,R3
   \   000014   F0           MOVX    @DPTR,A
   \   000015   EC           MOV     A,R4
   \   000016   FE           MOV     R6,A
   \   000017   ED           MOV     A,R5
   \   000018   FF           MOV     R7,A
   \   000019   89..         MOV     ?V0 + 6,R1
   \   00001B   7412         MOV     A,#0x12
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   12....       LCALL   ??Subroutine18_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_46:
   \   000023   7416         MOV     A,#0x16
   \   000025   12....       LCALL   ?XSTACK_DISP0_8
   \   000028   E0           MOVX    A,@DPTR
   \   000029   F5..         MOV     ?V0 + 7,A
   \   00002B   7417         MOV     A,#0x17
   \   00002D   12....       LCALL   ?XSTACK_DISP0_8
   \   000030   12....       LCALL   ?Subroutine20 & 0xFFFF
    304            byte *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_51:
   \   000033   12....       LCALL   ?Subroutine19 & 0xFFFF
    305            // nwkAddr+ProfileID+NumInClusters+NumOutClusters.
    306            byte i, len = 2 + 2 + 1 + 1;  // nwkAddr+ProfileID+NumInClusters+NumOutClusters.
    307            uint8 protoVer = NLME_GetProtocolVersion();
   \                     ??CrossCallReturnLabel_152:
   \   000036   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000039   E9           MOV     A,R1
   \   00003A   FB           MOV     R3,A
    308          
    309            len += (NumInClusters + NumOutClusters)*((protoVer != ZB_PROT_V1_0) ? sizeof ( uint16 ) : sizeof( uint8 ));
   \   00003B   7401         MOV     A,#0x1
   \   00003D   6B           XRL     A,R3
   \   00003E   6004         JZ      ??ZDP_MatchDescReq_0
   \   000040   7802         MOV     R0,#0x2
   \   000042   8002         SJMP    ??ZDP_MatchDescReq_1
   \                     ??ZDP_MatchDescReq_0:
   \   000044   7801         MOV     R0,#0x1
   \                     ??ZDP_MatchDescReq_1:
   \   000046   E5..         MOV     A,?V0 + 7
   \   000048   25..         ADD     A,?V0 + 6
   \   00004A   F5F0         MOV     B,A
   \   00004C   E8           MOV     A,R0
   \   00004D   A4           MUL     AB
   \   00004E   2406         ADD     A,#0x6
   \   000050   FA           MOV     R2,A
    310          
    311            if ( len >= ZDP_BUF_SZ-1 )
   \   000051   C3           CLR     C
   \   000052   944F         SUBB    A,#0x4f
   \   000054   4005         JC      ??ZDP_MatchDescReq_2
    312            {
    313              return afStatus_MEM_FAIL;
   \   000056   7981         MOV     R1,#-0x7f
   \   000058   02....       LJMP    ??ZDP_MatchDescReq_3 & 0xFFFF
    314            }
    315          
    316            *pBuf++ = LO_UINT16( nwkAddr );   // NWKAddrOfInterest
   \                     ??ZDP_MatchDescReq_2:
   \   00005B   EE           MOV     A,R6
   \   00005C   85..82       MOV     DPL,?V0 + 2
   \   00005F   85..83       MOV     DPH,?V0 + 3
   \   000062   F0           MOVX    @DPTR,A
   \   000063   A3           INC     DPTR
    317            *pBuf++ = HI_UINT16( nwkAddr );
   \   000064   EF           MOV     A,R7
   \   000065   12....       LCALL   ?Subroutine33 & 0xFFFF
    318          
    319            *pBuf++ = LO_UINT16( ProfileID );   // Profile ID
    320            *pBuf++ = HI_UINT16( ProfileID );
    321          
    322            *pBuf++ = NumInClusters; // Input cluster list
   \                     ??CrossCallReturnLabel_79:
   \   000068   E5..         MOV     A,?V0 + 6
   \   00006A   12....       LCALL   ?Subroutine35 & 0xFFFF
    323            if ( NumInClusters )
   \                     ??CrossCallReturnLabel_83:
   \   00006D   6028         JZ      ??ZDP_MatchDescReq_4
    324            {
    325              for (i=0; i<NumInClusters; ++i)  {
   \   00006F   7C00         MOV     R4,#0x0
    326                *pBuf++ = LO_UINT16( InClusterList[i] );
   \                     ??ZDP_MatchDescReq_5:
   \   000071   EC           MOV     A,R4
   \   000072   C3           CLR     C
   \   000073   33           RLC     A
   \   000074   F8           MOV     R0,A
   \   000075   E4           CLR     A
   \   000076   33           RLC     A
   \   000077   F9           MOV     R1,A
   \   000078   7414         MOV     A,#0x14
   \   00007A   12....       LCALL   ?XSTACK_DISP0_8
   \   00007D   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_70:
   \   000080   12....       LCALL   ?Subroutine10 & 0xFFFF
    327                if (protoVer != ZB_PROT_V1_0)  {
   \                     ??CrossCallReturnLabel_22:
   \   000083   600B         JZ      ??CrossCallReturnLabel_39
    328                  *pBuf++ = HI_UINT16( InClusterList[i] );
   \   000085   7414         MOV     A,#0x14
   \   000087   12....       LCALL   ?XSTACK_DISP0_8
   \   00008A   12....       LCALL   ?Subroutine29 & 0xFFFF
   \                     ??CrossCallReturnLabel_71:
   \   00008D   12....       LCALL   ?Subroutine15 & 0xFFFF
    329                }
    330              }
   \                     ??CrossCallReturnLabel_39:
   \   000090   0C           INC     R4
   \   000091   EC           MOV     A,R4
   \   000092   C3           CLR     C
   \   000093   95..         SUBB    A,?V0 + 6
   \   000095   40DA         JC      ??ZDP_MatchDescReq_5
    331            }
    332          
    333            *pBuf++ = NumOutClusters; // Output cluster list
   \                     ??ZDP_MatchDescReq_4:
   \   000097   85..82       MOV     DPL,?V0 + 2
   \   00009A   85..83       MOV     DPH,?V0 + 3
   \   00009D   E5..         MOV     A,?V0 + 7
   \   00009F   12....       LCALL   ?Subroutine35 & 0xFFFF
    334            if ( NumOutClusters )
   \                     ??CrossCallReturnLabel_84:
   \   0000A2   6028         JZ      ??ZDP_MatchDescReq_6
    335            {
    336              for (i=0; i<NumOutClusters; ++i)  {
   \   0000A4   7C00         MOV     R4,#0x0
    337                *pBuf++ = LO_UINT16( OutClusterList[i] );
   \                     ??ZDP_MatchDescReq_7:
   \   0000A6   EC           MOV     A,R4
   \   0000A7   C3           CLR     C
   \   0000A8   33           RLC     A
   \   0000A9   F8           MOV     R0,A
   \   0000AA   E4           CLR     A
   \   0000AB   33           RLC     A
   \   0000AC   F9           MOV     R1,A
   \   0000AD   E5..         MOV     A,?V0 + 4
   \   0000AF   28           ADD     A,R0
   \   0000B0   F582         MOV     DPL,A
   \   0000B2   E5..         MOV     A,?V0 + 5
   \   0000B4   39           ADDC    A,R1
   \   0000B5   12....       LCALL   ?Subroutine10 & 0xFFFF
    338                if (protoVer != ZB_PROT_V1_0)  {
   \                     ??CrossCallReturnLabel_23:
   \   0000B8   600B         JZ      ??CrossCallReturnLabel_40
    339                  *pBuf++ = HI_UINT16( OutClusterList[i] );
   \   0000BA   E5..         MOV     A,?V0 + 4
   \   0000BC   28           ADD     A,R0
   \   0000BD   F582         MOV     DPL,A
   \   0000BF   E5..         MOV     A,?V0 + 5
   \   0000C1   39           ADDC    A,R1
   \   0000C2   12....       LCALL   ?Subroutine15 & 0xFFFF
    340                }
    341              }
   \                     ??CrossCallReturnLabel_40:
   \   0000C5   0C           INC     R4
   \   0000C6   EC           MOV     A,R4
   \   0000C7   C3           CLR     C
   \   0000C8   95..         SUBB    A,?V0 + 7
   \   0000CA   40DA         JC      ??ZDP_MatchDescReq_7
    342            }
    343          
    344            return fillAndSend( &ZDP_TransID, dstAddr, Match_Desc_req, len );
   \                     ??ZDP_MatchDescReq_6:
   \   0000CC                ; Setup parameters for call to function fillAndSend
   \   0000CC   75..06       MOV     ?V0 + 0,#0x6
   \   0000CF   75..00       MOV     ?V0 + 1,#0x0
   \   0000D2   78..         MOV     R0,#?V0 + 0
   \   0000D4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000D7   EA           MOV     A,R2
   \   0000D8   F9           MOV     R1,A
   \   0000D9   7402         MOV     A,#0x2
   \   0000DB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DE   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   0000E1   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000E4   7402         MOV     A,#0x2
   \   0000E6   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDP_MatchDescReq_3:
   \   0000E9   02....       LJMP    ?Subroutine69 & 0xFFFF
    345          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine29:
   \   000000   12....       LCALL   ?Subroutine60 & 0xFFFF
   \                     ??CrossCallReturnLabel_140:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine60:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   28           ADD     A,R0
   \   000002   FD           MOV     R5,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   39           ADDC    A,R1
   \   000006   8D82         MOV     DPL,R5
   \   000008   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine15:
   \   000000   12....       LCALL   ?Subroutine46 & 0xFFFF
   \                     ??CrossCallReturnLabel_109:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine10:
   \   000000   12....       LCALL   ?Subroutine44 & 0xFFFF
   \                     ??CrossCallReturnLabel_103:
   \   000003   6B           XRL     A,R3
   \   000004   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine33:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   E5..         MOV     A,?V0 + 0
   \   000004   F0           MOVX    @DPTR,A
   \   000005   A3           INC     DPTR
   \   000006   E5..         MOV     A,?V0 + 1
   \   000008   F0           MOVX    @DPTR,A
   \   000009   A3           INC     DPTR
   \   00000A   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine67:
   \   000000   90....       MOV     DPTR,#(NLME_GetProtocolVersion & 0xffff)
   \   000003   74..         MOV     A,#((NLME_GetProtocolVersion >> 16) & 0xff)
   \   000005   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine69:
   \   000000   7402         MOV     A,#0x2
   \                     ??Subroutine69_0:
   \   000002   12....       LCALL   ?DEALLOC_XSTACK8
   \   000005   7F08         MOV     R7,#0x8
   \   000007   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine20:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F5..         MOV     ?V0 + 4,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   F5..         MOV     ?V0 + 5,A
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine35:
   \   000000   12....       LCALL   ?Subroutine53 & 0xFFFF
   \                     ??CrossCallReturnLabel_126:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine53:
   \   000000   12....       LCALL   ??Subroutine55_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_131:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine19:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   000003   12....       LCALL   ?Subroutine49 & 0xFFFF
   \                     ??CrossCallReturnLabel_118:
   \   000006                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   000006                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   000006   02....       LJMP    ?Subroutine67 & 0xFFFF

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FC           MOV     R4,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FD           MOV     R5,A
   \   000005   7A..         MOV     R2,#(ZDP_TransID & 0xff)
   \   000007   7B..         MOV     R3,#((ZDP_TransID >> 8) & 0xff)
   \   000009   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00000C   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   00000E   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine46:
   \   000000   F583         MOV     DPH,A
   \   000002   A3           INC     DPTR
   \   000003   12....       LCALL   ?Subroutine55 & 0xFFFF
   \                     ??CrossCallReturnLabel_130:
   \   000006   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine55:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 2
   \   000004   85..83       MOV     DPH,?V0 + 3
   \                     ??Subroutine55_0:
   \   000007   F0           MOVX    @DPTR,A
   \   000008   A3           INC     DPTR
   \   000009   8582..       MOV     ?V0 + 2,DPL
   \   00000C   8583..       MOV     ?V0 + 3,DPH
   \   00000F   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine44:
   \   000000   F583         MOV     DPH,A
   \   000002   12....       LCALL   ?Subroutine55 & 0xFFFF
   \                     ??CrossCallReturnLabel_129:
   \   000005   7401         MOV     A,#0x1
   \   000007   22           RET
    346          #endif // ZDO_MATCH_REQUEST
    347          
    348          #if defined ( ZDO_SIMPLEDESC_REQUEST )
    349          /*********************************************************************
    350           * @fn          ZDP_SimpleDescReq
    351           *
    352           * @brief       This builds and send a NWK_Simple_Desc_req
    353           *              message.  This function sends unicast message to the
    354           *              destination device.
    355           *
    356           * @param       dstAddr - destination address
    357           * @param       nwkAddr - 16 bit address
    358           * @param       epIntf - endpoint/interface
    359           * @param       SecurityEnable - Security Options
    360           *
    361           * @return      afStatus_t
    362           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    363          afStatus_t ZDP_SimpleDescReq( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_SimpleDescReq:
    364                                              byte endPoint, byte SecurityEnable )
    365          
    366          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    367            ZDP_TmpBuf[0] = LO_UINT16( nwkAddr );
   \   000005   12....       LCALL   ?Subroutine5 & 0xFFFF
    368            ZDP_TmpBuf[1] = HI_UINT16( nwkAddr );
    369            ZDP_TmpBuf[2] = endPoint;
   \                     ??CrossCallReturnLabel_15:
   \   000008   12....       LCALL   ?Subroutine21 & 0xFFFF
    370          
    371            return fillAndSend( &ZDP_TransID, dstAddr, Simple_Desc_req, 3 );
   \                     ??CrossCallReturnLabel_55:
   \   00000B                ; Setup parameters for call to function fillAndSend
   \   00000B   75..04       MOV     ?V0 + 0,#0x4
   \   00000E   75..00       MOV     ?V0 + 1,#0x0
   \   000011   78..         MOV     R0,#?V0 + 0
   \   000013   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000016   7903         MOV     R1,#0x3
   \   000018   02....       LJMP    ?Subroutine70 & 0xFFFF
    372          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine21:
   \   000000   12....       LCALL   ?Subroutine48 & 0xFFFF
   \                     ??CrossCallReturnLabel_114:
   \   000003   A3           INC     DPTR
   \   000004   E9           MOV     A,R1
   \   000005   F0           MOVX    @DPTR,A
   \   000006   22           RET
    373          #endif // ZDO_SIMPLEDESC_REQUEST
    374          
    375          #if defined ( ZDO_USERDESCSET_REQUEST )
    376          /*********************************************************************
    377           * @fn          ZDP_UserDescSet
    378           *
    379           * @brief       This builds and send a User_Desc_set message to set
    380           *              the user descriptor.  This function sends unicast
    381           *              message to the destination device.
    382           *
    383           * @param       dstAddr - destination address
    384           * @param       nwkAddr - 16 bit address
    385           * @param       UserDescriptor - user descriptor
    386           * @param       SecurityEnable - Security Options
    387           *
    388           * @return      afStatus_t
    389           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    390          afStatus_t ZDP_UserDescSet( zAddrType_t *dstAddr, uint16 nwkAddr,
   \                     ZDP_UserDescSet:
    391                                    UserDescriptorFormat_t *UserDescriptor,
    392                                    byte SecurityEnable )
    393          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 6,R2
   \   000007   8B..         MOV     ?V0 + 7,R3
   \   000009   7410         MOV     A,#0x10
   \   00000B   12....       LCALL   ?XSTACK_DISP0_8
   \   00000E   12....       LCALL   ??Subroutine18_0 & 0xFFFF
    394            byte *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_47:
   \   000011   12....       LCALL   ?Subroutine25 & 0xFFFF
    395            byte len = (UserDescriptor->len < AF_MAX_USER_DESCRIPTOR_LEN) ?
    396                        UserDescriptor->len : AF_MAX_USER_DESCRIPTOR_LEN;
   \                     ??CrossCallReturnLabel_64:
   \   000014   85..82       MOV     DPL,?V0 + 0
   \   000017   85..83       MOV     DPH,?V0 + 1
   \   00001A   E0           MOVX    A,@DPTR
   \   00001B   C3           CLR     C
   \   00001C   9410         SUBB    A,#0x10
   \   00001E   5005         JNC     ??ZDP_UserDescSet_0
   \   000020   E0           MOVX    A,@DPTR
   \   000021   F5..         MOV     ?V0 + 4,A
   \   000023   8003         SJMP    ??ZDP_UserDescSet_1
   \                     ??ZDP_UserDescSet_0:
   \   000025   75..10       MOV     ?V0 + 4,#0x10
    397            byte addrLen = 2;
   \                     ??ZDP_UserDescSet_1:
   \   000028   75..02       MOV     ?V0 + 3,#0x2
    398          
    399            *pBuf++ = LO_UINT16( nwkAddr );
   \   00002B   EC           MOV     A,R4
   \   00002C   8E82         MOV     DPL,R6
   \   00002E   8F83         MOV     DPH,R7
   \   000030   F0           MOVX    @DPTR,A
   \   000031   A3           INC     DPTR
    400            *pBuf++ = HI_UINT16( nwkAddr );
   \   000032   ED           MOV     A,R5
   \   000033   12....       LCALL   ?Subroutine36 & 0xFFFF
    401          
    402            if ( NLME_GetProtocolVersion() == ZB_PROT_V1_1 )
   \                     ??CrossCallReturnLabel_86:
   \   000036                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   000036   90....       MOV     DPTR,#(NLME_GetProtocolVersion & 0xffff)
   \   000039   74..         MOV     A,#((NLME_GetProtocolVersion >> 16) & 0xff)
   \   00003B   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   00003E   E9           MOV     A,R1
   \   00003F   6402         XRL     A,#0x2
   \   000041   700E         JNZ     ??ZDP_UserDescSet_2
    403            {
    404              *pBuf++ = len;
   \   000043   8E82         MOV     DPL,R6
   \   000045   8F83         MOV     DPH,R7
   \   000047   E5..         MOV     A,?V0 + 4
   \   000049   F0           MOVX    @DPTR,A
   \   00004A   A3           INC     DPTR
   \   00004B   0E           INC     R6
   \   00004C   AF83         MOV     R7,DPH
    405              addrLen = 3;
   \   00004E   75..03       MOV     ?V0 + 3,#0x3
    406            }
    407            pBuf = osal_memcpy( pBuf, UserDescriptor->desc, len );
   \                     ??ZDP_UserDescSet_2:
   \   000051                ; Setup parameters for call to function osal_memcpy
   \   000051   85..82       MOV     DPL,?V0 + 0
   \   000054   85..83       MOV     DPH,?V0 + 1
   \   000057   A3           INC     DPTR
   \   000058   A982         MOV     R1,DPL
   \   00005A   AA83         MOV     R2,DPH
   \   00005C   89..         MOV     ?V0 + 0,R1
   \   00005E   8A..         MOV     ?V0 + 1,R2
   \   000060   75..00       MOV     ?V0 + 2,#0x0
   \   000063   78..         MOV     R0,#?V0 + 0
   \   000065   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000068   AC..         MOV     R4,?V0 + 4
   \   00006A   7D00         MOV     R5,#0x0
   \   00006C   EE           MOV     A,R6
   \   00006D   FA           MOV     R2,A
   \   00006E   EF           MOV     A,R7
   \   00006F   FB           MOV     R3,A
   \   000070   90....       MOV     DPTR,#(osal_memcpy & 0xffff)
   \   000073   74..         MOV     A,#((osal_memcpy >> 16) & 0xff)
   \   000075   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000078   7403         MOV     A,#0x3
   \   00007A   12....       LCALL   ?DEALLOC_XSTACK8
    408            osal_memset( pBuf, AF_USER_DESCRIPTOR_FILL, AF_MAX_USER_DESCRIPTOR_LEN-len );
   \   00007D                ; Setup parameters for call to function osal_memset
   \   00007D   7410         MOV     A,#0x10
   \   00007F   C3           CLR     C
   \   000080   95..         SUBB    A,?V0 + 4
   \   000082   FC           MOV     R4,A
   \   000083   E4           CLR     A
   \   000084   9400         SUBB    A,#0x0
   \   000086   FD           MOV     R5,A
   \   000087   7920         MOV     R1,#0x20
   \   000089   90....       MOV     DPTR,#(osal_memset & 0xffff)
   \   00008C   74..         MOV     A,#((osal_memset >> 16) & 0xff)
   \   00008E   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    409          
    410            return fillAndSend( &ZDP_TransID, dstAddr, User_Desc_set, (AF_MAX_USER_DESCRIPTOR_LEN + addrLen) );
   \   000091                ; Setup parameters for call to function fillAndSend
   \   000091   75..14       MOV     ?V0 + 0,#0x14
   \   000094   75..00       MOV     ?V0 + 1,#0x0
   \   000097   78..         MOV     R0,#?V0 + 0
   \   000099   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009C   7410         MOV     A,#0x10
   \   00009E   25..         ADD     A,?V0 + 3
   \   0000A0   F9           MOV     R1,A
   \   0000A1   AC..         MOV     R4,?V0 + 6
   \   0000A3   AD..         MOV     R5,?V0 + 7
   \   0000A5   7A..         MOV     R2,#(ZDP_TransID & 0xff)
   \   0000A7   7B..         MOV     R3,#((ZDP_TransID >> 8) & 0xff)
   \   0000A9   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   0000AC   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   0000AE   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000B1   02....       LJMP    ?Subroutine69 & 0xFFFF
    411          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine36:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   AE82         MOV     R6,DPL
   \   000004   AF83         MOV     R7,DPH
   \   000006   22           RET
    412          #endif // ZDO_USERDESCSET_REQUEST
    413          
    414          #if defined ( ZDO_SERVERDISC_REQUEST )
    415          /*********************************************************************
    416           * @fn          ZDP_ServerDiscReq
    417           *
    418           * @brief       Build and send a Server_Discovery_req request message.
    419           *
    420           * @param       serverMask - 16-bit bit-mask of server services being sought.
    421           * @param       SecurityEnable - Security Options
    422           *
    423           * @return      afStatus_t
    424           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    425          afStatus_t ZDP_ServerDiscReq( uint16 serverMask, byte SecurityEnable )
   \                     ZDP_ServerDiscReq:
    426          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    427            byte *pBuf = ZDP_TmpBuf;
   \   00000A   12....       LCALL   ?Subroutine23 & 0xFFFF
    428            zAddrType_t dstAddr;
    429          
    430            dstAddr.addrMode = AddrBroadcast;
   \                     ??CrossCallReturnLabel_57:
   \   00000D   7408         MOV     A,#0x8
   \   00000F   12....       LCALL   ?XSTACK_DISP0_8
   \   000012   12....       LCALL   ?Subroutine32 & 0xFFFF
    431            dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR_DEVZCZR;
   \                     ??CrossCallReturnLabel_77:
   \   000015   74FC         MOV     A,#-0x4
   \   000017   F0           MOVX    @DPTR,A
   \   000018   A3           INC     DPTR
   \   000019   74FF         MOV     A,#-0x1
   \   00001B   F0           MOVX    @DPTR,A
    432          
    433            *pBuf++ = LO_UINT16( serverMask );
   \   00001C   EA           MOV     A,R2
   \   00001D   8C82         MOV     DPL,R4
   \   00001F   8D83         MOV     DPH,R5
   \   000021   F0           MOVX    @DPTR,A
    434            *pBuf = HI_UINT16( serverMask );
   \   000022   EB           MOV     A,R3
   \   000023   A3           INC     DPTR
   \   000024   F0           MOVX    @DPTR,A
    435          
    436            FillAndSendTxOptions( &ZDP_TransID, &dstAddr, Server_Discovery_req, 2,
    437                       ((SecurityEnable) ? AF_EN_SECURITY : AF_TX_OPTIONS_NONE) );
   \   000025   E9           MOV     A,R1
   \   000026   6004         JZ      ??ZDP_ServerDiscReq_0
   \   000028   7440         MOV     A,#0x40
   \   00002A   8001         SJMP    ??ZDP_ServerDiscReq_1
   \                     ??ZDP_ServerDiscReq_0:
   \   00002C   E4           CLR     A
   \                     ??ZDP_ServerDiscReq_1:
   \   00002D   90....       MOV     DPTR,#??ZDP_TxOptions
   \   000030   F0           MOVX    @DPTR,A
   \   000031                ; Setup parameters for call to function fillAndSend
   \   000031   75..15       MOV     ?V0 + 0,#0x15
   \   000034   75..00       MOV     ?V0 + 1,#0x0
   \   000037   78..         MOV     R0,#?V0 + 0
   \   000039   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00003C   7902         MOV     R1,#0x2
   \   00003E   E9           MOV     A,R1
   \   00003F   12....       LCALL   ?XSTACK_DISP0_8
   \   000042   AC82         MOV     R4,DPL
   \   000044   AD83         MOV     R5,DPH
   \   000046   7A..         MOV     R2,#(ZDP_TransID & 0xff)
   \   000048   7B..         MOV     R3,#((ZDP_TransID >> 8) & 0xff)
   \   00004A   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00004D   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   00004F   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000052   7402         MOV     A,#0x2
   \   000054   12....       LCALL   ?DEALLOC_XSTACK8
   \   000057   E4           CLR     A
   \   000058   90....       MOV     DPTR,#??ZDP_TxOptions
   \   00005B   F0           MOVX    @DPTR,A
   \   00005C   02....       LJMP    ?Subroutine71 & 0xFFFF
    438          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine23:
   \   000000   90....       MOV     DPTR,#??ZDP_TmpBuf
   \                     ??Subroutine23_0:
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FC           MOV     R4,A
   \   000005   A3           INC     DPTR
   \   000006   E0           MOVX    A,@DPTR
   \   000007   FD           MOV     R5,A
   \   000008   22           RET
    439          #endif
    440          
    441          #if defined ( ZDO_ENDDEVICE_ANNCE_REQUEST ) || defined ( ZDO_ENDDEVICE_ANNCE_GENERATE )
    442          /*********************************************************************
    443           * @fn          ZDP_EndDeviceAnnce
    444           *
    445           * @brief       This builds and send an End_Device_Annce
    446           *              message.  This function sends a broadcast message.
    447           *
    448           * @param       nwkAddr - 16 bit address of the device
    449           * @param       IEEEAddr - 64 bit address of the device
    450           * @param       capabilities - device capabilities.  This field is only
    451           *                 sent for v1.1 networks.
    452           * @param       SecurityEnable - Security Options
    453           *
    454           * @return      afStatus_t
    455           */
    456          afStatus_t ZDP_EndDeviceAnnce( uint16 nwkAddr, byte *IEEEAddr,
    457                                        byte capabilities, byte SecurityEnable )
    458          {
    459            zAddrType_t dstAddr;
    460            uint8 len;
    461          
    462            dstAddr.addrMode = (afAddrMode_t)AddrBroadcast;
    463            dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
    464          
    465            ZDP_TmpBuf[0] = LO_UINT16( nwkAddr );
    466            ZDP_TmpBuf[1] = HI_UINT16( nwkAddr );
    467            osal_cpyExtAddr( &ZDP_TmpBuf[2], IEEEAddr );
    468            len = 2 + Z_EXTADDR_LEN;
    469          
    470            if ( NLME_GetProtocolVersion() != ZB_PROT_V1_0 )
    471            {
    472              ZDP_TmpBuf[10] = capabilities;
    473              len++;
    474            }
    475          
    476            return fillAndSend( &ZDP_TransID, &dstAddr, End_Device_annce, len );
    477          }
    478          #endif // ZDO_ENDDEVICE_ANNCE_REQUEST
    479          
    480          /*********************************************************************
    481           * Address Responses
    482           */
    483          
    484          /*********************************************************************
    485           * @fn      zdpProcessAddrReq
    486           *
    487           * @brief   Process an incoming NWK_addr_req or IEEE_addr_req message and then
    488           *          build and send a corresponding NWK_addr_rsp or IEEE_addr_rsp msg.
    489           *
    490           * @param   seq - Message sequence number of the request.
    491           * @param   src - Source address of the request.
    492           * @param   msg - Incoming request message.
    493           * @param   cId - Cluster ID of the request.
    494           * @param   sty - Security enable/disable options.
    495           *
    496           * @return  none
    497           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    498          static void zdpProcessAddrReq(
   \                     ??zdpProcessAddrReq:
    499                              byte seq, zAddrType_t *src, byte *msg, uint16 cId, byte sty )
    500          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 6
   \   000005   74FA         MOV     A,#-0x6
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7403         MOV     A,#0x3
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   E9           MOV     A,R1
   \   000010   F0           MOVX    @DPTR,A
   \   000011   7404         MOV     A,#0x4
   \   000013   12....       LCALL   ?XSTACK_DISP0_8
   \   000016   EA           MOV     A,R2
   \   000017   F0           MOVX    @DPTR,A
   \   000018   A3           INC     DPTR
   \   000019   EB           MOV     A,R3
   \   00001A   F0           MOVX    @DPTR,A
   \   00001B   7401         MOV     A,#0x1
   \   00001D   12....       LCALL   ?XSTACK_DISP0_8
   \   000020   EC           MOV     A,R4
   \   000021   F0           MOVX    @DPTR,A
   \   000022   A3           INC     DPTR
   \   000023   ED           MOV     A,R5
   \   000024   F0           MOVX    @DPTR,A
   \   000025   7416         MOV     A,#0x16
   \   000027   12....       LCALL   ?XSTACK_DISP0_8
   \   00002A   E0           MOVX    A,@DPTR
   \   00002B   F5..         MOV     ?V0 + 6,A
   \   00002D   A3           INC     DPTR
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   F5..         MOV     ?V0 + 7,A
    501            byte reqType = msg[(cId == NWK_addr_req) ? Z_EXTADDR_LEN : sizeof( uint16 ) ];
   \   000031   E5..         MOV     A,?V0 + 6
   \   000033   7002         JNZ     ??zdpProcessAddrReq_1
   \   000035   E5..         MOV     A,?V0 + 7
   \                     ??zdpProcessAddrReq_1:
   \   000037   7004         JNZ     ??zdpProcessAddrReq_2
   \   000039   7808         MOV     R0,#0x8
   \   00003B   8002         SJMP    ??zdpProcessAddrReq_3
   \                     ??zdpProcessAddrReq_2:
   \   00003D   7802         MOV     R0,#0x2
   \                     ??zdpProcessAddrReq_3:
   \   00003F   7401         MOV     A,#0x1
   \   000041   12....       LCALL   ?XSTACK_DISP0_8
   \   000044   E0           MOVX    A,@DPTR
   \   000045   28           ADD     A,R0
   \   000046   FA           MOV     R2,A
   \   000047   A3           INC     DPTR
   \   000048   E0           MOVX    A,@DPTR
   \   000049   3400         ADDC    A,#0x0
   \   00004B   8A82         MOV     DPL,R2
   \   00004D   F583         MOV     DPH,A
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   F5..         MOV     ?V0 + 3,A
    502          
    503            uint16 aoi = INVALID_NODE_ADDR;
    504            byte *ieee = NULL;
   \   000052   75..00       MOV     ?V0 + 4,#0x0
   \   000055   75..00       MOV     ?V0 + 5,#0x0
    505          
    506            if ( cId == NWK_addr_req )
   \   000058   E5..         MOV     A,?V0 + 6
   \   00005A   7002         JNZ     ??zdpProcessAddrReq_4
   \   00005C   E5..         MOV     A,?V0 + 7
   \                     ??zdpProcessAddrReq_4:
   \   00005E   7024         JNZ     ??zdpProcessAddrReq_5
    507            {
    508              ieee = msg;
   \   000060   7401         MOV     A,#0x1
   \   000062   12....       LCALL   ?XSTACK_DISP0_8
   \   000065   12....       LCALL   ?Subroutine20 & 0xFFFF
    509          
    510              if ( osal_ExtAddrEqual( saveExtAddr, ieee ) )
   \                     ??CrossCallReturnLabel_52:
   \   000068                ; Setup parameters for call to function osal_ExtAddrEqual
   \   000068   AC..         MOV     R4,?V0 + 4
   \   00006A   7A..         MOV     R2,#(saveExtAddr & 0xff)
   \   00006C   7B..         MOV     R3,#((saveExtAddr >> 8) & 0xff)
   \   00006E   90....       MOV     DPTR,#(osal_ExtAddrEqual & 0xffff)
   \   000071   74..         MOV     A,#((osal_ExtAddrEqual >> 16) & 0xff)
   \   000073   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000076   E9           MOV     A,R1
   \   000077   7003         JNZ     $+5
   \   000079   02....       LJMP    ??zdpProcessAddrReq_6 & 0xFFFF
    511              {
    512                aoi = ZDAppNwkAddr.addr.shortAddr;
   \   00007C   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00007F   12....       LCALL   ??Subroutine25_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_65:
   \   000082   8030         SJMP    ??zdpProcessAddrReq_7
    513              }
    514              /*
    515              else if ( reqType == ZDP_ADDR_REQTYPE_MEMBERSHIP )
    516              {
    517                //ggg - what to do?
    518              }
    519              */
    520          #if defined( ZDO_CACHE ) && ( CACHE_DEV_MAX > 0 )
    521              else
    522              {
    523                aoi = ZDCacheGetNwkAddr( msg );
    524              }
    525          #endif
    526            }
    527            else  // if ( cId == IEEE_addr_req )
    528            {
    529              aoi = BUILD_UINT16( msg[0], msg[1] );
   \                     ??zdpProcessAddrReq_5:
   \   000084   7401         MOV     A,#0x1
   \   000086   12....       LCALL   ?XSTACK_DISP0_8
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   F8           MOV     R0,A
   \   00008B   12....       LCALL   ?Subroutine65 & 0xFFFF
   \                     ??CrossCallReturnLabel_142:
   \   00008E   E0           MOVX    A,@DPTR
   \   00008F   FA           MOV     R2,A
   \   000090   7401         MOV     A,#0x1
   \   000092   12....       LCALL   ?XSTACK_DISP0_8
   \   000095   12....       LCALL   ?Subroutine65 & 0xFFFF
   \                     ??CrossCallReturnLabel_143:
   \   000098   A3           INC     DPTR
   \   000099   E0           MOVX    A,@DPTR
   \   00009A   F9           MOV     R1,A
   \   00009B   E4           CLR     A
   \   00009C   2A           ADD     A,R2
   \   00009D   FE           MOV     R6,A
   \   00009E   E9           MOV     A,R1
   \   00009F   3400         ADDC    A,#0x0
   \   0000A1   FF           MOV     R7,A
    530          
    531              if ( aoi == ZDAppNwkAddr.addr.shortAddr )
   \   0000A2   90....       MOV     DPTR,#ZDAppNwkAddr
   \   0000A5   E0           MOVX    A,@DPTR
   \   0000A6   6E           XRL     A,R6
   \   0000A7   7003         JNZ     ??zdpProcessAddrReq_8
   \   0000A9   A3           INC     DPTR
   \   0000AA   E0           MOVX    A,@DPTR
   \   0000AB   6F           XRL     A,R7
   \                     ??zdpProcessAddrReq_8:
   \   0000AC   7006         JNZ     ??zdpProcessAddrReq_7
    532              {
    533                ieee = saveExtAddr;
   \   0000AE   75....       MOV     ?V0 + 4,#(saveExtAddr & 0xff)
   \   0000B1   75....       MOV     ?V0 + 5,#((saveExtAddr >> 8) & 0xff)
    534              }
    535          #if defined( ZDO_CACHE ) && ( CACHE_DEV_MAX > 0 )
    536              else
    537              {
    538                ieee = ZDCacheGetExtAddr( aoi );
    539              }
    540          #endif
    541            }
    542          
    543            if ( (aoi != INVALID_NODE_ADDR) && (ieee != NULL) )
   \                     ??zdpProcessAddrReq_7:
   \   0000B4   74FE         MOV     A,#-0x2
   \   0000B6   6E           XRL     A,R6
   \   0000B7   7003         JNZ     ??zdpProcessAddrReq_9
   \   0000B9   74FF         MOV     A,#-0x1
   \   0000BB   6F           XRL     A,R7
   \                     ??zdpProcessAddrReq_9:
   \   0000BC   7003         JNZ     $+5
   \   0000BE   02....       LJMP    ??zdpProcessAddrReq_6 & 0xFFFF
   \   0000C1   E5..         MOV     A,?V0 + 4
   \   0000C3   7002         JNZ     ??zdpProcessAddrReq_10
   \   0000C5   E5..         MOV     A,?V0 + 5
   \                     ??zdpProcessAddrReq_10:
   \   0000C7   7003         JNZ     $+5
   \   0000C9   02....       LJMP    ??zdpProcessAddrReq_6 & 0xFFFF
    544            {
    545              byte *pBuf = ZDP_TmpBuf;
   \   0000CC   12....       LCALL   ?Subroutine18 & 0xFFFF
    546              // Status + IEEE-Addr + Nwk-Addr.
    547              byte len = 1 + Z_EXTADDR_LEN + 2;
   \                     ??CrossCallReturnLabel_48:
   \   0000CF   75..0B       MOV     ?V0 + 2,#0xb
    548          
    549              byte stat = ((reqType == ZDP_ADDR_REQTYPE_SINGLE) ||
    550                        (reqType == ZDP_ADDR_REQTYPE_EXTENDED) ||
    551                    ((reqType == ZDP_ADDR_REQTYPE_MEMBERSHIP) && (cId == NWK_addr_req)) ) ?
    552                ZDP_SUCCESS : ZDP_INVALID_REQTYPE;
   \   0000D2   E5..         MOV     A,?V0 + 3
   \   0000D4   6014         JZ      ??zdpProcessAddrReq_11
   \   0000D6   7401         MOV     A,#0x1
   \   0000D8   65..         XRL     A,?V0 + 3
   \   0000DA   600E         JZ      ??zdpProcessAddrReq_11
   \   0000DC   7402         MOV     A,#0x2
   \   0000DE   65..         XRL     A,?V0 + 3
   \   0000E0   700C         JNZ     ??zdpProcessAddrReq_12
   \   0000E2   E5..         MOV     A,?V0 + 6
   \   0000E4   7002         JNZ     ??zdpProcessAddrReq_13
   \   0000E6   E5..         MOV     A,?V0 + 7
   \                     ??zdpProcessAddrReq_13:
   \   0000E8   7004         JNZ     ??zdpProcessAddrReq_12
   \                     ??zdpProcessAddrReq_11:
   \   0000EA   7A00         MOV     R2,#0x0
   \   0000EC   8002         SJMP    ??zdpProcessAddrReq_14
   \                     ??zdpProcessAddrReq_12:
   \   0000EE   7A80         MOV     R2,#-0x80
    553          
    554              *pBuf++ = stat;
   \                     ??zdpProcessAddrReq_14:
   \   0000F0   EA           MOV     A,R2
   \   0000F1   85..82       MOV     DPL,?V0 + 0
   \   0000F4   85..83       MOV     DPH,?V0 + 1
   \   0000F7   F0           MOVX    @DPTR,A
    555          
    556              pBuf = osal_cpyExtAddr( pBuf, ieee );
   \   0000F8                ; Setup parameters for call to function osal_cpyExtAddr
   \   0000F8   AC..         MOV     R4,?V0 + 4
   \   0000FA   AD..         MOV     R5,?V0 + 5
   \   0000FC   A3           INC     DPTR
   \   0000FD   AA82         MOV     R2,DPL
   \   0000FF   AB83         MOV     R3,DPH
   \   000101   90....       MOV     DPTR,#(osal_cpyExtAddr & 0xffff)
   \   000104   74..         MOV     A,#((osal_cpyExtAddr >> 16) & 0xff)
   \   000106   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    557          
    558              *pBuf++ = LO_UINT16( aoi );
   \   000109   EE           MOV     A,R6
   \   00010A   8A82         MOV     DPL,R2
   \   00010C   8B83         MOV     DPH,R3
   \   00010E   F0           MOVX    @DPTR,A
   \   00010F   A3           INC     DPTR
    559              *pBuf++ = HI_UINT16( aoi );
   \   000110   EF           MOV     A,R7
   \   000111   12....       LCALL   ?Subroutine31 & 0xFFFF
    560          
    561          #if defined( RTR_NWK )
    562              if ( (reqType == ZDP_ADDR_REQTYPE_EXTENDED) &&
    563                   (aoi == ZDAppNwkAddr.addr.shortAddr) )
   \                     ??CrossCallReturnLabel_74:
   \   000114   6003         JZ      $+5
   \   000116   02....       LJMP    ??zdpProcessAddrReq_15 & 0xFFFF
   \   000119   90....       MOV     DPTR,#ZDAppNwkAddr
   \   00011C   E0           MOVX    A,@DPTR
   \   00011D   6E           XRL     A,R6
   \   00011E   7003         JNZ     ??zdpProcessAddrReq_16
   \   000120   A3           INC     DPTR
   \   000121   E0           MOVX    A,@DPTR
   \   000122   6F           XRL     A,R7
   \                     ??zdpProcessAddrReq_16:
   \   000123   6003         JZ      $+5
   \   000125   02....       LJMP    ??zdpProcessAddrReq_15 & 0xFFFF
    564              {
    565                byte cnt = 0;
   \   000128   E4           CLR     A
   \   000129   85..82       MOV     DPL,?XSP + 0
   \   00012C   85..83       MOV     DPH,?XSP + 1
   \   00012F   F0           MOVX    @DPTR,A
    566                uint16 *list = AssocMakeList( &cnt );
   \   000130                ; Setup parameters for call to function AssocMakeList
   \   000130   AA82         MOV     R2,DPL
   \   000132   AB83         MOV     R3,DPH
   \   000134   90....       MOV     DPTR,#(AssocMakeList & 0xffff)
   \   000137   74..         MOV     A,#((AssocMakeList >> 16) & 0xff)
   \   000139   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    567          
    568                // NumAssocDev field is only present on success.
    569                *pBuf++ = cnt;
   \   00013C   85..82       MOV     DPL,?XSP + 0
   \   00013F   85..83       MOV     DPH,?XSP + 1
   \   000142   12....       LCALL   ?Subroutine16 & 0xFFFF
    570                len++;
   \                     ??CrossCallReturnLabel_41:
   \   000145   75..0C       MOV     ?V0 + 2,#0xc
    571          
    572                if ( list != NULL )
   \   000148   EA           MOV     A,R2
   \   000149   7001         JNZ     ??zdpProcessAddrReq_17
   \   00014B   EB           MOV     A,R3
   \                     ??zdpProcessAddrReq_17:
   \   00014C   607B         JZ      ??zdpProcessAddrReq_15
    573                {
    574                  byte idx =
    575                    msg[(((cId == NWK_addr_req) ? Z_EXTADDR_LEN : sizeof( uint16 )) + 1)];
   \   00014E   E5..         MOV     A,?V0 + 6
   \   000150   7002         JNZ     ??zdpProcessAddrReq_18
   \   000152   E5..         MOV     A,?V0 + 7
   \                     ??zdpProcessAddrReq_18:
   \   000154   7004         JNZ     ??zdpProcessAddrReq_19
   \   000156   7808         MOV     R0,#0x8
   \   000158   8002         SJMP    ??zdpProcessAddrReq_20
   \                     ??zdpProcessAddrReq_19:
   \   00015A   7802         MOV     R0,#0x2
   \                     ??zdpProcessAddrReq_20:
   \   00015C   7401         MOV     A,#0x1
   \   00015E   12....       LCALL   ?XSTACK_DISP0_8
   \   000161   E0           MOVX    A,@DPTR
   \   000162   28           ADD     A,R0
   \   000163   FC           MOV     R4,A
   \   000164   A3           INC     DPTR
   \   000165   E0           MOVX    A,@DPTR
   \   000166   3400         ADDC    A,#0x0
   \   000168   8C82         MOV     DPL,R4
   \   00016A   F583         MOV     DPH,A
   \   00016C   A3           INC     DPTR
   \   00016D   E0           MOVX    A,@DPTR
   \   00016E   FC           MOV     R4,A
    576                  uint16 *pList = list + idx;
   \   00016F   C3           CLR     C
   \   000170   33           RLC     A
   \   000171   F8           MOV     R0,A
   \   000172   E4           CLR     A
   \   000173   33           RLC     A
   \   000174   F9           MOV     R1,A
   \   000175   EA           MOV     A,R2
   \   000176   28           ADD     A,R0
   \   000177   F8           MOV     R0,A
   \   000178   EB           MOV     A,R3
   \   000179   39           ADDC    A,R1
   \   00017A   F9           MOV     R1,A
    577          
    578                  // StartIndex field is only present if NumAssocDev field is non-zero.
    579                  *pBuf++ = idx;
   \   00017B   EC           MOV     A,R4
   \   00017C   85..82       MOV     DPL,?V0 + 0
   \   00017F   85..83       MOV     DPH,?V0 + 1
   \   000182   12....       LCALL   ?Subroutine38 & 0xFFFF
    580                  len++;
   \                     ??CrossCallReturnLabel_91:
   \   000185   75..0D       MOV     ?V0 + 2,#0xd
    581          
    582                  if ( cnt > idx )
   \   000188   85..82       MOV     DPL,?XSP + 0
   \   00018B   85..83       MOV     DPH,?XSP + 1
   \   00018E   E0           MOVX    A,@DPTR
   \   00018F   FD           MOV     R5,A
   \   000190   EC           MOV     A,R4
   \   000191   C3           CLR     C
   \   000192   9D           SUBB    A,R5
   \   000193   500C         JNC     ??zdpProcessAddrReq_21
    583                  {
    584                    cnt -= idx;
   \   000195   E0           MOVX    A,@DPTR
   \   000196   C3           CLR     C
   \   000197   9C           SUBB    A,R4
   \   000198   F0           MOVX    @DPTR,A
    585                    len += (cnt * sizeof( uint16 ));
   \   000199   C3           CLR     C
   \   00019A   33           RLC     A
   \   00019B   240D         ADD     A,#0xd
   \   00019D   F5..         MOV     ?V0 + 2,A
   \   00019F   801D         SJMP    ??zdpProcessAddrReq_22
    586                  }
    587                  else
    588                  {
    589                    cnt = 0;
   \                     ??zdpProcessAddrReq_21:
   \   0001A1   E4           CLR     A
   \   0001A2   F0           MOVX    @DPTR,A
   \   0001A3   801C         SJMP    ??zdpProcessAddrReq_23
    590                  }
    591          
    592                  while ( cnt != 0 )
    593                  {
    594                    *pBuf++ = LO_UINT16( *pList );
   \                     ??zdpProcessAddrReq_24:
   \   0001A5   12....       LCALL   ?Subroutine8 & 0xFFFF
    595                    *pBuf++ = HI_UINT16( *pList );
   \                     ??CrossCallReturnLabel_156:
   \   0001A8   A3           INC     DPTR
   \   0001A9   12....       LCALL   ?Subroutine16 & 0xFFFF
    596                    pList++;
   \                     ??CrossCallReturnLabel_42:
   \   0001AC   E8           MOV     A,R0
   \   0001AD   2402         ADD     A,#0x2
   \   0001AF   08           INC     R0
   \   0001B0   08           INC     R0
   \   0001B1   E9           MOV     A,R1
   \   0001B2   3400         ADDC    A,#0x0
   \   0001B4   F9           MOV     R1,A
    597                    cnt--;
   \   0001B5   85..82       MOV     DPL,?XSP + 0
   \   0001B8   85..83       MOV     DPH,?XSP + 1
   \   0001BB   E0           MOVX    A,@DPTR
   \   0001BC   14           DEC     A
   \   0001BD   F0           MOVX    @DPTR,A
    598                  }
   \                     ??zdpProcessAddrReq_22:
   \   0001BE   E0           MOVX    A,@DPTR
   \   0001BF   70E4         JNZ     ??zdpProcessAddrReq_24
    599          
    600                  osal_mem_free( (byte *)list );
   \                     ??zdpProcessAddrReq_23:
   \   0001C1                ; Setup parameters for call to function osal_mem_free
   \   0001C1   90....       MOV     DPTR,#(osal_mem_free & 0xffff)
   \   0001C4   74..         MOV     A,#((osal_mem_free >> 16) & 0xff)
   \   0001C6   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
    601                }
    602              }
    603          
    604          #endif
    605          
    606              ZDP_TxOptions = AF_MSG_ACK_REQUEST;
   \                     ??zdpProcessAddrReq_15:
   \   0001C9   7410         MOV     A,#0x10
   \   0001CB   90....       MOV     DPTR,#??ZDP_TxOptions
   \   0001CE   F0           MOVX    @DPTR,A
    607              fillAndSend( &seq, src, (cId_t)(cId | ZDO_RESPONSE_BIT), len );
   \   0001CF                ; Setup parameters for call to function fillAndSend
   \   0001CF   E5..         MOV     A,?V0 + 6
   \   0001D1   F5..         MOV     ?V0 + 0,A
   \   0001D3   7480         MOV     A,#-0x80
   \   0001D5   45..         ORL     A,?V0 + 7
   \   0001D7   F5..         MOV     ?V0 + 1,A
   \   0001D9   78..         MOV     R0,#?V0 + 0
   \   0001DB   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001DE   A9..         MOV     R1,?V0 + 2
   \   0001E0   7406         MOV     A,#0x6
   \   0001E2   12....       LCALL   ?XSTACK_DISP0_8
   \   0001E5   12....       LCALL   ??Subroutine23_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_58:
   \   0001E8   7405         MOV     A,#0x5
   \   0001EA   12....       LCALL   ?XSTACK_DISP0_8
   \   0001ED   AA82         MOV     R2,DPL
   \   0001EF   AB83         MOV     R3,DPH
   \   0001F1   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   0001F4   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   0001F6   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0001F9   7402         MOV     A,#0x2
   \   0001FB   12....       LCALL   ?DEALLOC_XSTACK8
    608              ZDP_TxOptions = AF_TX_OPTIONS_NONE;
   \   0001FE   E4           CLR     A
   \   0001FF   90....       MOV     DPTR,#??ZDP_TxOptions
   \   000202   F0           MOVX    @DPTR,A
    609            }
    610          }
   \                     ??zdpProcessAddrReq_6:
   \   000203   7406         MOV     A,#0x6
   \   000205   02....       LJMP    ??Subroutine69_0 & 0xFFFF

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine16:
   \   000000   12....       LCALL   ?Subroutine47 & 0xFFFF
   \                     ??CrossCallReturnLabel_111:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine47:
   \   000000   12....       LCALL   ?Subroutine58 & 0xFFFF
   \                     ??CrossCallReturnLabel_136:
   \   000003   12....       LCALL   ?Subroutine57 & 0xFFFF
   \                     ??CrossCallReturnLabel_132:
   \   000006   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine68:
   \   000000   8882         MOV     DPL,R0
   \   000002   8983         MOV     DPH,R1
   \   000004   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine58:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   85..82       MOV     DPL,?V0 + 0
   \   000004   85..83       MOV     DPH,?V0 + 1
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine38:
   \   000000   12....       LCALL   ?Subroutine54 & 0xFFFF
   \                     ??CrossCallReturnLabel_128:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine54:
   \   000000   12....       LCALL   ?Subroutine57 & 0xFFFF
   \                     ??CrossCallReturnLabel_133:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine57:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   8582..       MOV     ?V0 + 0,DPL
   \   000005   8583..       MOV     ?V0 + 1,DPH
   \   000008   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine31:
   \   000000   12....       LCALL   ?Subroutine54 & 0xFFFF
   \                     ??CrossCallReturnLabel_127:
   \   000003   7401         MOV     A,#0x1
   \   000005   65..         XRL     A,?V0 + 3
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine8:
   \   000000   8882         MOV     DPL,R0
   \   000002   8983         MOV     DPH,R1
   \   000004   12....       LCALL   ?Subroutine47 & 0xFFFF
   \                     ??CrossCallReturnLabel_110:
   \   000007   02....       LJMP    ?Subroutine68 & 0xFFFF
    611          
    612          /*********************************************************************
    613           * @fn          ZDP_NodeDescMsg
    614           *
    615           * @brief       Builds and sends a Node Descriptor message, unicast to the
    616           *              specified device.
    617           *
    618           * @param       dstAddr - destination address
    619           * @param       nwkAddr - 16 bit network address for device
    620           * @param       pNodeDesc - pointer to the node descriptor
    621           * @param       SecurityEnable - Security Options
    622           *
    623           * @return      afStatus_t
    624           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    625          afStatus_t ZDP_NodeDescMsg( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_NodeDescMsg:
    626                 uint16 nwkAddr, NodeDescriptorFormat_t *pNodeDesc, byte SecurityEnable )
    627          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 2,R2
   \   000014   8B..         MOV     ?V0 + 3,R3
   \   000016   8C..         MOV     ?V0 + 0,R4
   \   000018   8D..         MOV     ?V0 + 1,R5
   \   00001A   740D         MOV     A,#0xd
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   12....       LCALL   ?Subroutine24 & 0xFFFF
    628            byte proVer = NLME_GetProtocolVersion();
   \                     ??CrossCallReturnLabel_154:
   \   000022   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000025   E9           MOV     A,R1
   \   000026   FA           MOV     R2,A
    629            byte *pBuf = ZDP_TmpBuf;
   \   000027   12....       LCALL   ?Subroutine14 & 0xFFFF
    630            byte len;
    631          
    632            if ( proVer == ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_32:
   \   00002A   7401         MOV     A,#0x1
   \   00002C   6A           XRL     A,R2
   \   00002D   7004         JNZ     ??ZDP_NodeDescMsg_0
    633            {
    634              len = 1 + 2 + 8;  // Status + nwkAddr + Node descriptor
   \   00002F   7C0B         MOV     R4,#0xb
   \   000031   8002         SJMP    ??ZDP_NodeDescMsg_1
    635            }
    636            else
    637            {
    638              len = 1 + 2 + 10;  // Status + nwkAddr + Node descriptor
   \                     ??ZDP_NodeDescMsg_0:
   \   000033   7C0D         MOV     R4,#0xd
    639            }
    640          
    641            *pBuf++ = ZDP_SUCCESS;
   \                     ??ZDP_NodeDescMsg_1:
   \   000035   E4           CLR     A
   \   000036   8882         MOV     DPL,R0
   \   000038   8983         MOV     DPH,R1
   \   00003A   12....       LCALL   ?Subroutine33 & 0xFFFF
    642          
    643            *pBuf++ = LO_UINT16( nwkAddr );
    644            *pBuf++ = HI_UINT16( nwkAddr );
   \                     ??CrossCallReturnLabel_80:
   \   00003D   A882         MOV     R0,DPL
   \   00003F   A983         MOV     R1,DPH
    645          
    646            if ( proVer == ZB_PROT_V1_0 )
   \   000041   7401         MOV     A,#0x1
   \   000043   6A           XRL     A,R2
   \   000044   8E82         MOV     DPL,R6
   \   000046   8F83         MOV     DPH,R7
   \   000048   7005         JNZ     ??ZDP_NodeDescMsg_2
    647            {
    648              *pBuf++ = (byte)(pNodeDesc->LogicalType & 0x07);
   \   00004A   E0           MOVX    A,@DPTR
   \   00004B   5407         ANL     A,#0x7
   \   00004D   8003         SJMP    ??ZDP_NodeDescMsg_3
    649            }
    650            else
    651            {
    652              *pBuf++ = (byte)((pNodeDesc->ComplexDescAvail << 3) |
    653                               (pNodeDesc->UserDescAvail << 4) |
    654                               (pNodeDesc->LogicalType & 0x07));
   \                     ??ZDP_NodeDescMsg_2:
   \   00004F   E0           MOVX    A,@DPTR
   \   000050   541F         ANL     A,#0x1f
   \                     ??ZDP_NodeDescMsg_3:
   \   000052   12....       LCALL   ?Subroutine52 & 0xFFFF
    655            }
    656          
    657            *pBuf++ = (byte)((pNodeDesc->FrequencyBand << 3) | (pNodeDesc->APSFlags & 0x07));
   \                     ??CrossCallReturnLabel_123:
   \   000055   12....       LCALL   ?Subroutine12 & 0xFFFF
    658            *pBuf++ = pNodeDesc->CapabilityFlags;
   \                     ??CrossCallReturnLabel_26:
   \   000058   12....       LCALL   ?Subroutine12 & 0xFFFF
    659            *pBuf++ = pNodeDesc->ManufacturerCode[0];
   \                     ??CrossCallReturnLabel_27:
   \   00005B   A3           INC     DPTR
   \   00005C   12....       LCALL   ?Subroutine9 & 0xFFFF
    660            *pBuf++ = pNodeDesc->ManufacturerCode[1];
   \                     ??CrossCallReturnLabel_20:
   \   00005F   12....       LCALL   ?Subroutine9 & 0xFFFF
    661            *pBuf++ = pNodeDesc->MaxBufferSize;
   \                     ??CrossCallReturnLabel_21:
   \   000062   A3           INC     DPTR
   \   000063   12....       LCALL   ?Subroutine7 & 0xFFFF
    662            *pBuf++ = pNodeDesc->MaxTransferSize[0];
   \                     ??CrossCallReturnLabel_18:
   \   000066   12....       LCALL   ?Subroutine7 & 0xFFFF
    663            *pBuf++ = pNodeDesc->MaxTransferSize[1];
   \                     ??CrossCallReturnLabel_19:
   \   000069   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_158:
   \   00006C   F0           MOVX    @DPTR,A
   \   00006D   A3           INC     DPTR
   \   00006E   08           INC     R0
   \   00006F   A983         MOV     R1,DPH
    664          
    665            if ( proVer != ZB_PROT_V1_0 )
   \   000071   7401         MOV     A,#0x1
   \   000073   6A           XRL     A,R2
   \   000074   6019         JZ      ??ZDP_NodeDescMsg_4
    666            {
    667              *pBuf++ = LO_UINT16( pNodeDesc->ServerMask );
   \   000076   EE           MOV     A,R6
   \   000077   2408         ADD     A,#0x8
   \   000079   FA           MOV     R2,A
   \   00007A   EF           MOV     A,R7
   \   00007B   3400         ADDC    A,#0x0
   \   00007D   FB           MOV     R3,A
   \   00007E   8A82         MOV     DPL,R2
   \   000080   8B83         MOV     DPH,R3
   \   000082   12....       LCALL   ??Subroutine28_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_159:
   \   000085   F0           MOVX    @DPTR,A
    668              *pBuf++ = HI_UINT16( pNodeDesc->ServerMask );
   \   000086   8A82         MOV     DPL,R2
   \   000088   8B83         MOV     DPH,R3
   \   00008A   12....       LCALL   ?Subroutine28 & 0xFFFF
   \                     ??CrossCallReturnLabel_160:
   \   00008D   A3           INC     DPTR
   \   00008E   F0           MOVX    @DPTR,A
    669            }
    670          
    671            return fillAndSend( &TransSeq, dstAddr, Node_Desc_rsp, len );
   \                     ??ZDP_NodeDescMsg_4:
   \   00008F                ; Setup parameters for call to function fillAndSend
   \   00008F   75..02       MOV     ?V0 + 0,#0x2
   \   000092   75..80       MOV     ?V0 + 1,#-0x80
   \   000095   78..         MOV     R0,#?V0 + 0
   \   000097   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00009A   EC           MOV     A,R4
   \   00009B   F9           MOV     R1,A
   \   00009C   AC..         MOV     R4,?V0 + 2
   \   00009E   AD..         MOV     R5,?V0 + 3
   \   0000A0   7402         MOV     A,#0x2
   \   0000A2   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A5   AA82         MOV     R2,DPL
   \   0000A7   AB83         MOV     R3,DPH
   \   0000A9   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   0000AC   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   0000AE   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000B1   7402         MOV     A,#0x2
   \   0000B3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B6   7401         MOV     A,#0x1
   \   0000B8   02....       LJMP    ?Subroutine64 & 0xFFFF
    672          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine12:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   12....       LCALL   ?Subroutine52 & 0xFFFF
   \                     ??CrossCallReturnLabel_124:
   \   000004   A3           INC     DPTR
   \   000005   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine52:
   \   000000   12....       LCALL   ?Subroutine56 & 0xFFFF
   \                     ??CrossCallReturnLabel_149:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine56:
   \   000000   8882         MOV     DPL,R0
   \   000002   8983         MOV     DPH,R1
   \   000004   F0           MOVX    @DPTR,A
   \   000005   A3           INC     DPTR
   \   000006   08           INC     R0
   \   000007   A983         MOV     R1,DPH
   \   000009                REQUIRE ?Subroutine66
   \   000009                ; // Fall through to label ?Subroutine66

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine9:
   \   000000   12....       LCALL   ?Subroutine43 & 0xFFFF
   \                     ??CrossCallReturnLabel_101:
   \   000003   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine43:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   12....       LCALL   ?Subroutine56 & 0xFFFF
   \                     ??CrossCallReturnLabel_150:
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine7:
   \   000000   12....       LCALL   ?Subroutine43 & 0xFFFF
   \                     ??CrossCallReturnLabel_102:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine28:
   \   000000   A3           INC     DPTR
   \                     ??Subroutine28_0:
   \   000001   E0           MOVX    A,@DPTR
   \   000002                REQUIRE ?Subroutine68
   \   000002                ; // Fall through to label ?Subroutine68

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine24:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   FE           MOV     R6,A
   \   000002   A3           INC     DPTR
   \   000003   E0           MOVX    A,@DPTR
   \   000004   FF           MOV     R7,A
   \   000005                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   000005                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   000005                REQUIRE ?Subroutine67
   \   000005                ; // Fall through to label ?Subroutine67
    673          
    674          /*********************************************************************
    675           * @fn          ZDP_PowerDescMsg
    676           *
    677           * @brief       Builds and sends a Power Descriptor message, unicast to the
    678           *              specified device.
    679           *
    680           * @param       dstAddr - destination address
    681           * @param       Status - message status (ZDP_SUCCESS or other)
    682           * @param       nwkAddr - 16 bit network address for device
    683           * @param       pPowerDesc - pointer to the node descriptor
    684           * @param       SecurityEnable - Security Options
    685           *
    686           * @return      afStatus_t
    687           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    688          afStatus_t ZDP_PowerDescMsg( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_PowerDescMsg:
    689            uint16 nwkAddr, NodePowerDescriptorFormat_t *pPowerDesc, byte SecurityEnable )
    690          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   740B         MOV     A,#0xb
   \   000014   12....       LCALL   ?XSTACK_DISP0_8
   \   000017   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_33:
   \   00001A   E8           MOV     A,R0
   \   00001B   FE           MOV     R6,A
   \   00001C   E9           MOV     A,R1
   \   00001D   FF           MOV     R7,A
    691            byte *pBuf = ZDP_TmpBuf;
   \   00001E   12....       LCALL   ?Subroutine14 & 0xFFFF
    692            byte len = 1 + 2 + 2;  // Status + nwkAddr + Node Power descriptor.
    693          
    694            *pBuf++ = ZDP_SUCCESS;
   \                     ??CrossCallReturnLabel_34:
   \   000021   E4           CLR     A
   \   000022   8882         MOV     DPL,R0
   \   000024   8983         MOV     DPH,R1
   \   000026   12....       LCALL   ?Subroutine39 & 0xFFFF
    695          
    696            *pBuf++ = LO_UINT16( nwkAddr );
    697            *pBuf++ = HI_UINT16( nwkAddr );
   \                     ??CrossCallReturnLabel_93:
   \   000029   A882         MOV     R0,DPL
   \   00002B   A983         MOV     R1,DPH
    698          
    699            *pBuf++ = (byte)((pPowerDesc->AvailablePowerSources << 4)
    700                              | (pPowerDesc->PowerMode & 0x0F));
   \   00002D   12....       LCALL   ?Subroutine22 & 0xFFFF
    701            *pBuf++ = (byte)((pPowerDesc->CurrentPowerSourceLevel << 4)
    702                              | (pPowerDesc->CurrentPowerSource & 0x0F));
   \                     ??CrossCallReturnLabel_148:
   \   000030   12....       LCALL   ??Subroutine28_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_161:
   \   000033   A3           INC     DPTR
   \   000034   F0           MOVX    @DPTR,A
    703          
    704            return fillAndSend( &TransSeq, dstAddr, Power_Desc_rsp, len );
   \   000035                ; Setup parameters for call to function fillAndSend
   \   000035   75..03       MOV     ?V0 + 0,#0x3
   \   000038   75..80       MOV     ?V0 + 1,#-0x80
   \   00003B   78..         MOV     R0,#?V0 + 0
   \   00003D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000040   7905         MOV     R1,#0x5
   \   000042   02....       LJMP    ?Subroutine63 & 0xFFFF
    705          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine39:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   A3           INC     DPTR
   \   000002   EC           MOV     A,R4
   \   000003   F0           MOVX    @DPTR,A
   \   000004   A3           INC     DPTR
   \   000005   ED           MOV     A,R5
   \   000006   F0           MOVX    @DPTR,A
   \   000007   A3           INC     DPTR
   \   000008   22           RET
    706          
    707          /*********************************************************************
    708           * @fn          ZDP_SimpleDescMsg
    709           *
    710           * @brief       Builds and sends a Simple Descriptor message, unicast to the
    711           *              specified device.
    712           *
    713           * @param       dstAddr - destination address
    714           * @param       Status - message status (ZDP_SUCCESS or other)
    715           * @param       pSimpleDesc - pointer to the node descriptor
    716           * @param       SecurityEnable - Security Options
    717           *
    718           * @return      afStatus_t
    719           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    720          afStatus_t ZDP_SimpleDescMsg( byte TransSeq, zAddrType_t *dstAddr, byte Status,
   \                     ZDP_SimpleDescMsg:
    721                                        SimpleDescriptionFormat_t *pSimpleDesc,
    722                                        cId_t clusterID, byte SecurityEnable )
    723          {
   \   000000   74F1         MOV     A,#-0xf
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 15
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 4,R2
   \   000014   8B..         MOV     ?V0 + 5,R3
   \   000016   8C..         MOV     ?V0 + 6,R4
   \   000018   7410         MOV     A,#0x10
   \   00001A   12....       LCALL   ?XSTACK_DISP0_8
   \   00001D   12....       LCALL   ??Subroutine18_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_49:
   \   000020   7412         MOV     A,#0x12
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   12....       LCALL   ?Subroutine49 & 0xFFFF
    724            uint8 *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_117:
   \   000028   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   00002B   12....       LCALL   ?Subroutine24 & 0xFFFF
    725            uint8 i, len;
    726            uint8 protoVer;
    727          
    728            protoVer = NLME_GetProtocolVersion();
   \                     ??CrossCallReturnLabel_155:
   \   00002E   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000031   E9           MOV     A,R1
   \   000032   FB           MOV     R3,A
    729          
    730            if ( Status == ZDP_SUCCESS && pSimpleDesc )
   \   000033   E5..         MOV     A,?V0 + 6
   \   000035   703E         JNZ     ??ZDP_SimpleDescMsg_0
   \   000037   E5..         MOV     A,?V0 + 0
   \   000039   7002         JNZ     ??ZDP_SimpleDescMsg_1
   \   00003B   E5..         MOV     A,?V0 + 1
   \                     ??ZDP_SimpleDescMsg_1:
   \   00003D   6036         JZ      ??ZDP_SimpleDescMsg_0
    731            {
    732              // Status + NWKAddrOfInterest + desc length + empty simple descriptor.
    733              len = 1 + 2 + 1 + 8;
    734              len += (pSimpleDesc->AppNumInClusters + pSimpleDesc->AppNumOutClusters)
    735                      * ((protoVer != ZB_PROT_V1_0) ? sizeof ( uint16 ) : sizeof( uint8 ));
   \   00003F   7401         MOV     A,#0x1
   \   000041   6B           XRL     A,R3
   \   000042   6004         JZ      ??ZDP_SimpleDescMsg_2
   \   000044   7802         MOV     R0,#0x2
   \   000046   8002         SJMP    ??ZDP_SimpleDescMsg_3
   \                     ??ZDP_SimpleDescMsg_2:
   \   000048   7801         MOV     R0,#0x1
   \                     ??ZDP_SimpleDescMsg_3:
   \   00004A   85..82       MOV     DPL,?V0 + 0
   \   00004D   85..83       MOV     DPH,?V0 + 1
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   A3           INC     DPTR
   \   000053   A3           INC     DPTR
   \   000054   A3           INC     DPTR
   \   000055   A3           INC     DPTR
   \   000056   A3           INC     DPTR
   \   000057   A3           INC     DPTR
   \   000058   A3           INC     DPTR
   \   000059   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_72:
   \   00005C   A3           INC     DPTR
   \   00005D   A3           INC     DPTR
   \   00005E   A3           INC     DPTR
   \   00005F   A3           INC     DPTR
   \   000060   A3           INC     DPTR
   \   000061   FA           MOV     R2,A
   \   000062   E0           MOVX    A,@DPTR
   \   000063   2A           ADD     A,R2
   \   000064   F5F0         MOV     B,A
   \   000066   E8           MOV     A,R0
   \   000067   A4           MUL     AB
   \   000068   240C         ADD     A,#0xc
   \   00006A   FA           MOV     R2,A
    736            }
    737            else
    738            {
    739              len = 2; // Status + desc length
    740            }
    741            if ( len >= ZDP_BUF_SZ-1 )
   \   00006B   C3           CLR     C
   \   00006C   944F         SUBB    A,#0x4f
   \   00006E   4007         JC      ??ZDP_SimpleDescMsg_4
    742            {
    743              return afStatus_MEM_FAIL;
   \   000070   7981         MOV     R1,#-0x7f
   \   000072   02....       LJMP    ??ZDP_SimpleDescMsg_5 & 0xFFFF
    744            }
   \                     ??ZDP_SimpleDescMsg_0:
   \   000075   7A02         MOV     R2,#0x2
    745          
    746            *pBuf++ = Status;
   \                     ??ZDP_SimpleDescMsg_4:
   \   000077   8E82         MOV     DPL,R6
   \   000079   8F83         MOV     DPH,R7
   \   00007B   E5..         MOV     A,?V0 + 6
   \   00007D   12....       LCALL   ?Subroutine36 & 0xFFFF
    747          
    748            *pBuf++ = LO_UINT16( ZDAppNwkAddr.addr.shortAddr );
   \                     ??CrossCallReturnLabel_87:
   \   000080   90....       MOV     DPTR,#ZDAppNwkAddr
   \   000083   12....       LCALL   ??Subroutine4_0 & 0xFFFF
    749            *pBuf++ = HI_UINT16( ZDAppNwkAddr.addr.shortAddr );
   \                     ??CrossCallReturnLabel_9:
   \   000086   90....       MOV     DPTR,#(ZDAppNwkAddr + 1)
   \   000089   12....       LCALL   ?Subroutine59 & 0xFFFF
    750          
    751            if ( len > 2 )
   \                     ??CrossCallReturnLabel_137:
   \   00008C   EA           MOV     A,R2
   \   00008D   C3           CLR     C
   \   00008E   9403         SUBB    A,#0x3
   \   000090   5003         JNC     $+5
   \   000092   02....       LJMP    ??ZDP_SimpleDescMsg_6 & 0xFFFF
    752            {
    753              *pBuf++ = len - 4;   // Simple descriptor length
   \   000095   74FC         MOV     A,#-0x4
   \   000097   2A           ADD     A,R2
   \   000098   F0           MOVX    @DPTR,A
   \   000099   A3           INC     DPTR
   \   00009A   0E           INC     R6
   \   00009B   0E           INC     R6
   \   00009C   AF83         MOV     R7,DPH
    754          
    755              *pBuf++ = pSimpleDesc->EndPoint;
   \   00009E   85..82       MOV     DPL,?V0 + 0
   \   0000A1   85..83       MOV     DPH,?V0 + 1
   \   0000A4   12....       LCALL   ??Subroutine4_0 & 0xFFFF
    756              *pBuf++ = LO_UINT16( pSimpleDesc->AppProfId );
   \                     ??CrossCallReturnLabel_10:
   \   0000A7   85..82       MOV     DPL,?V0 + 0
   \   0000AA   85..83       MOV     DPH,?V0 + 1
   \   0000AD   A3           INC     DPTR
   \   0000AE   A882         MOV     R0,DPL
   \   0000B0   A983         MOV     R1,DPH
   \   0000B2   12....       LCALL   ?Subroutine3 & 0xFFFF
    757              *pBuf++ = HI_UINT16( pSimpleDesc->AppProfId );
    758              *pBuf++ = LO_UINT16( pSimpleDesc->AppDeviceId );
   \                     ??CrossCallReturnLabel_7:
   \   0000B5   E5..         MOV     A,?V0 + 0
   \   0000B7   2403         ADD     A,#0x3
   \   0000B9   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_162:
   \   0000BC   12....       LCALL   ?Subroutine3 & 0xFFFF
    759              *pBuf++ = HI_UINT16( pSimpleDesc->AppDeviceId );
    760          
    761              if ( protoVer == ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_8:
   \   0000BF   7401         MOV     A,#0x1
   \   0000C1   6B           XRL     A,R3
   \   0000C2   85..82       MOV     DPL,?V0 + 0
   \   0000C5   85..83       MOV     DPH,?V0 + 1
   \   0000C8   A3           INC     DPTR
   \   0000C9   A3           INC     DPTR
   \   0000CA   A3           INC     DPTR
   \   0000CB   A3           INC     DPTR
   \   0000CC   A3           INC     DPTR
   \   0000CD   7011         JNZ     ??ZDP_SimpleDescMsg_7
    762              {
    763                *pBuf++ = (byte)((pSimpleDesc->AppDevVer << 4) | (pSimpleDesc->Reserved));
   \   0000CF   E0           MOVX    A,@DPTR
   \   0000D0   FC           MOV     R4,A
   \   0000D1   C4           SWAP    A
   \   0000D2   540F         ANL     A,#0xf
   \   0000D4   C0E0         PUSH    A
   \   0000D6   EC           MOV     A,R4
   \   0000D7   C4           SWAP    A
   \   0000D8   54F0         ANL     A,#0xf0
   \   0000DA   FC           MOV     R4,A
   \   0000DB   D0E0         POP     A
   \   0000DD   4C           ORL     A,R4
   \   0000DE   8004         SJMP    ??ZDP_SimpleDescMsg_8
    764              }
    765              else
    766              {
    767                *pBuf++ = (byte)(pSimpleDesc->AppDevVer << 4);
   \                     ??ZDP_SimpleDescMsg_7:
   \   0000E0   E0           MOVX    A,@DPTR
   \   0000E1   C4           SWAP    A
   \   0000E2   54F0         ANL     A,#0xf0
   \                     ??ZDP_SimpleDescMsg_8:
   \   0000E4   8E82         MOV     DPL,R6
   \   0000E6   8F83         MOV     DPH,R7
   \   0000E8   F0           MOVX    @DPTR,A
   \   0000E9   A3           INC     DPTR
   \   0000EA   0E           INC     R6
   \   0000EB   AF83         MOV     R7,DPH
    768              }
    769          
    770              *pBuf++ = pSimpleDesc->AppNumInClusters;
   \   0000ED   E5..         MOV     A,?V0 + 0
   \   0000EF   2406         ADD     A,#0x6
   \   0000F1   08           INC     R0
   \   0000F2   08           INC     R0
   \   0000F3   08           INC     R0
   \   0000F4   12....       LCALL   ??Subroutine40_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_163:
   \   0000F7   12....       LCALL   ??Subroutine4_0 & 0xFFFF
    771              if ( pSimpleDesc->AppNumInClusters )
   \                     ??CrossCallReturnLabel_11:
   \   0000FA   8882         MOV     DPL,R0
   \   0000FC   8983         MOV     DPH,R1
   \   0000FE   E0           MOVX    A,@DPTR
   \   0000FF   6033         JZ      ??ZDP_SimpleDescMsg_9
    772              {
    773                for (i=0; i<pSimpleDesc->AppNumInClusters; ++i)
   \   000101   7C00         MOV     R4,#0x0
   \   000103   801C         SJMP    ??ZDP_SimpleDescMsg_10
    774                {
    775                  *pBuf++ = LO_UINT16( pSimpleDesc->pAppInClusterList[i] );
   \                     ??ZDP_SimpleDescMsg_11:
   \   000105   EC           MOV     A,R4
   \   000106   C3           CLR     C
   \   000107   33           RLC     A
   \   000108   F8           MOV     R0,A
   \   000109   E4           CLR     A
   \   00010A   33           RLC     A
   \   00010B   F9           MOV     R1,A
   \   00010C   85..82       MOV     DPL,?V0 + 0
   \   00010F   85..83       MOV     DPH,?V0 + 1
   \   000112   12....       LCALL   ?Subroutine6 & 0xFFFF
    776                  if ( protoVer != ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_16:
   \   000115   6009         JZ      ??CrossCallReturnLabel_12
    777                  {
    778                  *pBuf++ = HI_UINT16( pSimpleDesc->pAppInClusterList[i] );
   \   000117   85..82       MOV     DPL,?V0 + 0
   \   00011A   85..83       MOV     DPH,?V0 + 1
   \   00011D   12....       LCALL   ?Subroutine4 & 0xFFFF
    779                }
    780              }
   \                     ??CrossCallReturnLabel_12:
   \   000120   0C           INC     R4
   \                     ??ZDP_SimpleDescMsg_10:
   \   000121   85..82       MOV     DPL,?V0 + 0
   \   000124   85..83       MOV     DPH,?V0 + 1
   \   000127   A3           INC     DPTR
   \   000128   A3           INC     DPTR
   \   000129   A3           INC     DPTR
   \   00012A   A3           INC     DPTR
   \   00012B   A3           INC     DPTR
   \   00012C   A3           INC     DPTR
   \   00012D   E0           MOVX    A,@DPTR
   \   00012E   FD           MOV     R5,A
   \   00012F   EC           MOV     A,R4
   \   000130   C3           CLR     C
   \   000131   9D           SUBB    A,R5
   \   000132   40D1         JC      ??ZDP_SimpleDescMsg_11
    781              }
    782              *pBuf++ = pSimpleDesc->AppNumOutClusters;
   \                     ??ZDP_SimpleDescMsg_9:
   \   000134   E5..         MOV     A,?V0 + 0
   \   000136   2409         ADD     A,#0x9
   \   000138   12....       LCALL   ?Subroutine40 & 0xFFFF
   \                     ??CrossCallReturnLabel_164:
   \   00013B   E0           MOVX    A,@DPTR
   \   00013C   8E82         MOV     DPL,R6
   \   00013E   8F83         MOV     DPH,R7
   \   000140   12....       LCALL   ?Subroutine36 & 0xFFFF
    783              if ( pSimpleDesc->AppNumOutClusters )
   \                     ??CrossCallReturnLabel_88:
   \   000143   8882         MOV     DPL,R0
   \   000145   8983         MOV     DPH,R1
   \   000147   E0           MOVX    A,@DPTR
   \   000148   603E         JZ      ??ZDP_SimpleDescMsg_12
    784              {
    785                for (i=0; i<pSimpleDesc->AppNumOutClusters; ++i)
   \   00014A   7C00         MOV     R4,#0x0
   \                     ??ZDP_SimpleDescMsg_13:
   \   00014C   85..82       MOV     DPL,?V0 + 0
   \   00014F   85..83       MOV     DPH,?V0 + 1
   \   000152   A3           INC     DPTR
   \   000153   A3           INC     DPTR
   \   000154   A3           INC     DPTR
   \   000155   A3           INC     DPTR
   \   000156   A3           INC     DPTR
   \   000157   A3           INC     DPTR
   \   000158   A3           INC     DPTR
   \   000159   A3           INC     DPTR
   \   00015A   A3           INC     DPTR
   \   00015B   E0           MOVX    A,@DPTR
   \   00015C   FD           MOV     R5,A
   \   00015D   EC           MOV     A,R4
   \   00015E   C3           CLR     C
   \   00015F   9D           SUBB    A,R5
   \   000160   5026         JNC     ??ZDP_SimpleDescMsg_12
    786                {
    787                  *pBuf++ = LO_UINT16( pSimpleDesc->pAppOutClusterList[i] );
   \   000162   EC           MOV     A,R4
   \   000163   C3           CLR     C
   \   000164   33           RLC     A
   \   000165   F8           MOV     R0,A
   \   000166   E4           CLR     A
   \   000167   33           RLC     A
   \   000168   F9           MOV     R1,A
   \   000169   85..82       MOV     DPL,?V0 + 0
   \   00016C   85..83       MOV     DPH,?V0 + 1
   \   00016F   A3           INC     DPTR
   \   000170   A3           INC     DPTR
   \   000171   A3           INC     DPTR
   \   000172   12....       LCALL   ?Subroutine6 & 0xFFFF
    788                  if ( protoVer != ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_17:
   \   000175   600C         JZ      ??CrossCallReturnLabel_13
    789                  {
    790                  *pBuf++ = HI_UINT16( pSimpleDesc->pAppOutClusterList[i] );
   \   000177   85..82       MOV     DPL,?V0 + 0
   \   00017A   85..83       MOV     DPH,?V0 + 1
   \   00017D   A3           INC     DPTR
   \   00017E   A3           INC     DPTR
   \   00017F   A3           INC     DPTR
   \   000180   12....       LCALL   ?Subroutine4 & 0xFFFF
    791                }
    792              }
   \                     ??CrossCallReturnLabel_13:
   \   000183   0C           INC     R4
   \   000184   80C6         SJMP    ??ZDP_SimpleDescMsg_13
    793            }
    794            }
    795            else
    796            {
    797              *pBuf = 0; // Description Length = 0;
   \                     ??ZDP_SimpleDescMsg_6:
   \   000186   E4           CLR     A
   \   000187   F0           MOVX    @DPTR,A
    798            }
    799          
    800            return fillAndSend( &TransSeq, dstAddr, clusterID, len );
   \                     ??ZDP_SimpleDescMsg_12:
   \   000188                ; Setup parameters for call to function fillAndSend
   \   000188   78..         MOV     R0,#?V0 + 2
   \   00018A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00018D   EA           MOV     A,R2
   \   00018E   F9           MOV     R1,A
   \   00018F   AC..         MOV     R4,?V0 + 4
   \   000191   AD..         MOV     R5,?V0 + 5
   \   000193   7402         MOV     A,#0x2
   \   000195   12....       LCALL   ?XSTACK_DISP0_8
   \   000198   AA82         MOV     R2,DPL
   \   00019A   AB83         MOV     R3,DPH
   \   00019C   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00019F   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   0001A1   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0001A4   7402         MOV     A,#0x2
   \   0001A6   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDP_SimpleDescMsg_5:
   \   0001A9   7401         MOV     A,#0x1
   \   0001AB   02....       LJMP    ?Subroutine62 & 0xFFFF
    801          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine40:
   \   000000   F8           MOV     R0,A
   \                     ??Subroutine40_0:
   \   000001   E5..         MOV     A,?V0 + 1
   \   000003   3400         ADDC    A,#0x0
   \   000005   F9           MOV     R1,A
   \   000006   02....       LJMP    ?Subroutine68 & 0xFFFF

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine6:
   \   000000   12....       LCALL   ?Subroutine50 & 0xFFFF
   \                     ??CrossCallReturnLabel_120:
   \   000003   12....       LCALL   ?Subroutine59 & 0xFFFF
   \                     ??CrossCallReturnLabel_138:
   \   000006   AE82         MOV     R6,DPL
   \   000008   AF83         MOV     R7,DPH
   \   00000A   7401         MOV     A,#0x1
   \   00000C   6B           XRL     A,R3
   \   00000D   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine59:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   8E82         MOV     DPL,R6
   \   000003   8F83         MOV     DPH,R7
   \   000005   F0           MOVX    @DPTR,A
   \   000006   A3           INC     DPTR
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine4:
   \   000000   12....       LCALL   ?Subroutine50 & 0xFFFF
   \                     ??CrossCallReturnLabel_119:
   \   000003   A3           INC     DPTR
   \                     ??Subroutine4_0:
   \   000004   12....       LCALL   ?Subroutine45 & 0xFFFF
   \                     ??CrossCallReturnLabel_107:
   \   000007   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine50:
   \   000000   A3           INC     DPTR
   \   000001   A3           INC     DPTR
   \   000002   A3           INC     DPTR
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   12....       LCALL   ?Subroutine60 & 0xFFFF
   \                     ??CrossCallReturnLabel_141:
   \   00000A   F583         MOV     DPH,A
   \   00000C   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   12....       LCALL   ?Subroutine45 & 0xFFFF
   \                     ??CrossCallReturnLabel_105:
   \   000003   8882         MOV     DPL,R0
   \   000005   8983         MOV     DPH,R1
   \   000007   A3           INC     DPTR
   \   000008   12....       LCALL   ?Subroutine45 & 0xFFFF
   \                     ??CrossCallReturnLabel_106:
   \   00000B   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine45:
   \   000000   12....       LCALL   ?Subroutine59 & 0xFFFF
   \                     ??CrossCallReturnLabel_139:
   \   000003   0E           INC     R6
   \   000004   AF83         MOV     R7,DPH
   \   000006   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine30:
   \   000000   12....       LCALL   ?Subroutine58 & 0xFFFF
   \                     ??CrossCallReturnLabel_135:
   \   000003   A3           INC     DPTR
   \   000004   22           RET
    802          
    803          /*********************************************************************
    804           * @fn          ZDP_EPRsp
    805           *
    806           * @brief       This builds and send an endpoint list. Used in
    807           *              Active_EP_rsp and Match_Desc_Rsp
    808           *              message.  This function sends unicast message to the
    809           *              requesting device.
    810           *
    811           * @param       MsgType - either Active_EP_rsp or Match_Desc_Rsp
    812           * @param       dstAddr - destination address
    813           * @param       Status - message status (ZDP_SUCCESS or other)
    814           * @param       nwkAddr - Device's short address that this response describes
    815           * @param       Count - number of endpoint/interfaces in list
    816           * @param       pEPIntfList - Array of Endpoint/Interfaces
    817           * @param       SecurityEnable - Security Options
    818           *
    819           * @return      afStatus_t
    820           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    821          afStatus_t ZDP_EPRsp( uint16 MsgType, byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_EPRsp:
    822                                  byte Status, uint16 nwkAddr, byte Count,
    823                                  byte *pEPList,
    824                                  byte SecurityEnable )
    825          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   EA           MOV     A,R2
   \   000013   FE           MOV     R6,A
   \   000014   EB           MOV     A,R3
   \   000015   FF           MOV     R7,A
   \   000016   8C..         MOV     ?V0 + 6,R4
   \   000018   8D..         MOV     ?V0 + 7,R5
   \   00001A   7411         MOV     A,#0x11
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   E0           MOVX    A,@DPTR
   \   000020   FD           MOV     R5,A
   \   000021   7412         MOV     A,#0x12
   \   000023   12....       LCALL   ?XSTACK_DISP0_8
   \   000026   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_35:
   \   000029   7414         MOV     A,#0x14
   \   00002B   12....       LCALL   ?XSTACK_DISP0_8
   \   00002E   E0           MOVX    A,@DPTR
   \   00002F   FC           MOV     R4,A
   \   000030   7415         MOV     A,#0x15
   \   000032   12....       LCALL   ?XSTACK_DISP0_8
   \   000035   12....       LCALL   ?Subroutine17 & 0xFFFF
    826            byte *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_43:
   \   000038   FB           MOV     R3,A
    827            byte len = 1 + 2 + 1;  // Status + nwkAddr + endpoint/interface count.
   \   000039   75..04       MOV     ?V0 + 3,#0x4
    828            byte txOptions;
    829          
    830            if ( MsgType == Match_Desc_rsp )
   \   00003C   7406         MOV     A,#0x6
   \   00003E   6E           XRL     A,R6
   \   00003F   7003         JNZ     ??ZDP_EPRsp_0
   \   000041   7480         MOV     A,#-0x80
   \   000043   6F           XRL     A,R7
   \                     ??ZDP_EPRsp_0:
   \   000044   7005         JNZ     ??ZDP_EPRsp_1
    831              txOptions = AF_MSG_ACK_REQUEST;
   \   000046   75..10       MOV     ?V0 + 4,#0x10
   \   000049   8003         SJMP    ??ZDP_EPRsp_2
    832            else
    833              txOptions = 0;
   \                     ??ZDP_EPRsp_1:
   \   00004B   75..00       MOV     ?V0 + 4,#0x0
    834          
    835              *pBuf++ = Status;
   \                     ??ZDP_EPRsp_2:
   \   00004E   ED           MOV     A,R5
   \   00004F   8A82         MOV     DPL,R2
   \   000051   8B83         MOV     DPH,R3
   \   000053   F0           MOVX    @DPTR,A
   \   000054   A3           INC     DPTR
    836            *pBuf++ = LO_UINT16( nwkAddr );
   \   000055   E8           MOV     A,R0
   \   000056   F0           MOVX    @DPTR,A
   \   000057   A3           INC     DPTR
    837            *pBuf++ = HI_UINT16( nwkAddr );
   \   000058   E9           MOV     A,R1
   \   000059   F0           MOVX    @DPTR,A
   \   00005A   A3           INC     DPTR
   \   00005B   AA82         MOV     R2,DPL
   \   00005D   AB83         MOV     R3,DPH
    838          
    839            *pBuf++ = Count;   // Endpoint/Interface count
   \   00005F   EC           MOV     A,R4
   \   000060   F0           MOVX    @DPTR,A
    840          
    841            if ( Count )
   \   000061   6024         JZ      ??ZDP_EPRsp_3
    842            {
    843              len += Count;
   \   000063   7404         MOV     A,#0x4
   \   000065   2C           ADD     A,R4
   \   000066   F5..         MOV     ?V0 + 3,A
    844              osal_memcpy( pBuf, pEPList, Count );
   \   000068                ; Setup parameters for call to function osal_memcpy
   \   000068   75..00       MOV     ?V0 + 2,#0x0
   \   00006B   78..         MOV     R0,#?V0 + 0
   \   00006D   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   000070   7D00         MOV     R5,#0x0
   \   000072   8A82         MOV     DPL,R2
   \   000074   8B83         MOV     DPH,R3
   \   000076   A3           INC     DPTR
   \   000077   0A           INC     R2
   \   000078   AB83         MOV     R3,DPH
   \   00007A   90....       MOV     DPTR,#(osal_memcpy & 0xffff)
   \   00007D   74..         MOV     A,#((osal_memcpy >> 16) & 0xff)
   \   00007F   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000082   7403         MOV     A,#0x3
   \   000084   12....       LCALL   ?DEALLOC_XSTACK8
    845            }
    846          
    847            FillAndSendTxOptions( &TransSeq, dstAddr, MsgType, len, txOptions );
   \                     ??ZDP_EPRsp_3:
   \   000087   E5..         MOV     A,?V0 + 4
   \   000089   90....       MOV     DPTR,#??ZDP_TxOptions
   \   00008C   F0           MOVX    @DPTR,A
   \   00008D                ; Setup parameters for call to function fillAndSend
   \   00008D   8E..         MOV     ?V0 + 0,R6
   \   00008F   8F..         MOV     ?V0 + 1,R7
   \   000091   78..         MOV     R0,#?V0 + 0
   \   000093   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000096   A9..         MOV     R1,?V0 + 3
   \   000098   AC..         MOV     R4,?V0 + 6
   \   00009A   AD..         MOV     R5,?V0 + 7
   \   00009C   7402         MOV     A,#0x2
   \   00009E   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A1   AA82         MOV     R2,DPL
   \   0000A3   AB83         MOV     R3,DPH
   \   0000A5   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   0000A8   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   0000AA   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000AD   7402         MOV     A,#0x2
   \   0000AF   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000B2   E4           CLR     A
   \   0000B3   90....       MOV     DPTR,#??ZDP_TxOptions
   \   0000B6   F0           MOVX    @DPTR,A
   \   0000B7                REQUIRE ?Subroutine72
   \   0000B7                ; // Fall through to label ?Subroutine72
    848          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine72:
   \   000000   7401         MOV     A,#0x1
   \   000002   80..         SJMP    ??Subroutine69_0

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine17:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   F5..         MOV     ?V0 + 0,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   F5..         MOV     ?V0 + 1,A
   \   000007   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   FA           MOV     R2,A
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   22           RET
    849          
    850          #if defined ( ZDO_USERDESC_RESPONSE )
    851          /*********************************************************************
    852           * @fn          ZDP_UserDescRsp
    853           *
    854           * @brief       Build and send the User Decriptor Response.
    855           *
    856           *
    857           * @param       dstAddr - destination address
    858           * @param       nwkAddrOfInterest -
    859           * @param       userDesc -
    860           * @param       SecurityEnable - Security Options
    861           *
    862           * @return      ZStatus_t
    863           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    864          ZStatus_t ZDP_UserDescRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_UserDescRsp:
    865                          uint16 nwkAddrOfInterest, UserDescriptorFormat_t *userDesc,
    866                          byte SecurityEnable )
    867          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   8A..         MOV     ?V0 + 6,R2
   \   000014   8B..         MOV     ?V0 + 7,R3
   \   000016   7411         MOV     A,#0x11
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   12....       LCALL   ?Subroutine20 & 0xFFFF
    868            byte *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_53:
   \   00001E   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FA           MOV     R2,A
   \   000023   A3           INC     DPTR
   \   000024   E0           MOVX    A,@DPTR
   \   000025   FB           MOV     R3,A
    869            byte len = 1 + 2 + 1;  // Status + nwkAddr + descriptor length.
    870          
    871            len += userDesc->len;
   \   000026   85..82       MOV     DPL,?V0 + 4
   \   000029   85..83       MOV     DPH,?V0 + 5
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   2404         ADD     A,#0x4
   \   00002F   FF           MOV     R7,A
    872          
    873            *pBuf++ = ZSUCCESS;
   \   000030   E4           CLR     A
   \   000031   8A82         MOV     DPL,R2
   \   000033   8B83         MOV     DPH,R3
   \   000035   12....       LCALL   ?Subroutine39 & 0xFFFF
    874          
    875            *pBuf++ = LO_UINT16( nwkAddrOfInterest );
    876            *pBuf++ = HI_UINT16( nwkAddrOfInterest );
   \                     ??CrossCallReturnLabel_94:
   \   000038   AA82         MOV     R2,DPL
   \   00003A   AB83         MOV     R3,DPH
    877          
    878            *pBuf++ = userDesc->len;
   \   00003C   85..82       MOV     DPL,?V0 + 4
   \   00003F   85..83       MOV     DPH,?V0 + 5
   \   000042   E0           MOVX    A,@DPTR
   \   000043   8A82         MOV     DPL,R2
   \   000045   8B83         MOV     DPH,R3
   \   000047   F0           MOVX    @DPTR,A
    879            osal_memcpy( pBuf, userDesc->desc, userDesc->len );
   \   000048                ; Setup parameters for call to function osal_memcpy
   \   000048   85..82       MOV     DPL,?V0 + 4
   \   00004B   85..83       MOV     DPH,?V0 + 5
   \   00004E   A3           INC     DPTR
   \   00004F   AC82         MOV     R4,DPL
   \   000051   AD83         MOV     R5,DPH
   \   000053   8C..         MOV     ?V0 + 0,R4
   \   000055   8D..         MOV     ?V0 + 1,R5
   \   000057   75..00       MOV     ?V0 + 2,#0x0
   \   00005A   78..         MOV     R0,#?V0 + 0
   \   00005C   12....       LCALL   ?PUSH_XSTACK_I_THREE
   \   00005F   85..82       MOV     DPL,?V0 + 4
   \   000062   85..83       MOV     DPH,?V0 + 5
   \   000065   E0           MOVX    A,@DPTR
   \   000066   FC           MOV     R4,A
   \   000067   7D00         MOV     R5,#0x0
   \   000069   8A82         MOV     DPL,R2
   \   00006B   8B83         MOV     DPH,R3
   \   00006D   A3           INC     DPTR
   \   00006E   0A           INC     R2
   \   00006F   AB83         MOV     R3,DPH
   \   000071   90....       MOV     DPTR,#(osal_memcpy & 0xffff)
   \   000074   74..         MOV     A,#((osal_memcpy >> 16) & 0xff)
   \   000076   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000079   7403         MOV     A,#0x3
   \   00007B   12....       LCALL   ?DEALLOC_XSTACK8
    880          
    881            return (ZStatus_t)fillAndSend( &TransSeq, dstAddr, User_Desc_rsp, len );
   \   00007E                ; Setup parameters for call to function fillAndSend
   \   00007E   75..11       MOV     ?V0 + 0,#0x11
   \   000081   75..80       MOV     ?V0 + 1,#-0x80
   \   000084   78..         MOV     R0,#?V0 + 0
   \   000086   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000089   EF           MOV     A,R7
   \   00008A   F9           MOV     R1,A
   \   00008B   AC..         MOV     R4,?V0 + 6
   \   00008D   AD..         MOV     R5,?V0 + 7
   \   00008F   7402         MOV     A,#0x2
   \   000091   12....       LCALL   ?XSTACK_DISP0_8
   \   000094   AA82         MOV     R2,DPL
   \   000096   AB83         MOV     R3,DPH
   \   000098   90....       MOV     DPTR,#(??fillAndSend & 0xffff)
   \   00009B   74..         MOV     A,#((??fillAndSend >> 16) & 0xff)
   \   00009D   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000A0   7402         MOV     A,#0x2
   \   0000A2   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000A5   02....       LJMP    ?Subroutine72 & 0xFFFF
    882          }
    883          #endif // ZDO_USERDESC_RESPONSE
    884          
    885          #if defined ( ZDO_SERVERDISC_RESPONSE )
    886          /*********************************************************************
    887           * @fn          ZDP_ServerDiscRsp
    888           *
    889           * @brief       Build and send the Server_Discovery_rsp response.
    890           *
    891           * @param       transID - Transaction sequence number of request.
    892           * @param       dstAddr - Network Destination Address.
    893           * @param       status - Status of response to request.
    894           * @param       aoi - Network Address of Interest of request.
    895           * @param       serverMask - Bit map of service(s) being sought.
    896           * @param       SecurityEnable - Security Options
    897           *
    898           * @return      ZStatus_t
    899           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    900          ZStatus_t ZDP_ServerDiscRsp( byte transID, zAddrType_t *dstAddr, byte status,
   \                     ZDP_ServerDiscRsp:
    901                                     uint16 aoi, uint16 serverMask, byte SecurityEnable )
    902          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   EC           MOV     A,R4
   \   000013   FE           MOV     R6,A
   \   000014   740D         MOV     A,#0xd
   \   000016   12....       LCALL   ?XSTACK_DISP0_8
   \   000019   12....       LCALL   ??Subroutine14_0 & 0xFFFF
    903            const byte len = 1  + 2;  // status + aoi + mask.
    904            byte *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_36:
   \   00001C   12....       LCALL   ?Subroutine23 & 0xFFFF
   \                     ??CrossCallReturnLabel_59:
   \   00001F   8C82         MOV     DPL,R4
   \   000021   8D83         MOV     DPH,R5
    905          
    906            *pBuf++ = status;
   \   000023   EE           MOV     A,R6
   \   000024   F0           MOVX    @DPTR,A
   \   000025   A3           INC     DPTR
    907          
    908            *pBuf++ = LO_UINT16( serverMask );
   \   000026   E8           MOV     A,R0
   \   000027   F0           MOVX    @DPTR,A
    909            *pBuf++ = HI_UINT16( serverMask );
   \   000028   E9           MOV     A,R1
   \   000029   A3           INC     DPTR
   \   00002A   F0           MOVX    @DPTR,A
    910          
    911            return (ZStatus_t)fillAndSend( &transID, dstAddr, Server_Discovery_rsp, len );
   \   00002B                ; Setup parameters for call to function fillAndSend
   \   00002B   75..15       MOV     ?V0 + 0,#0x15
   \   00002E   75..80       MOV     ?V0 + 1,#-0x80
   \   000031   78..         MOV     R0,#?V0 + 0
   \   000033   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000036   7903         MOV     R1,#0x3
   \   000038   02....       LJMP    ?Subroutine63 & 0xFFFF
    912          }
    913          #endif // ZDO_USERDESC_RESPONSE
    914          
    915          /*********************************************************************
    916           * @fn          ZDP_GenericRsp
    917           *
    918           * @brief       Sends a response message with only the parameter status
    919           *              byte and the addr of interest for data.
    920           *              This function sends unicast message to the
    921           *              requesting device.
    922           *
    923           * @param       dstAddr - destination address
    924           * @param       status  - generic status for response
    925           * @param       aoi     - address of interest
    926           * @param       dstAddr - destination address
    927           * @param       rspId   - response cluster ID
    928           * @param       SecurityEnable - Security Options
    929           *
    930           * @return      afStatus_t
    931           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    932          afStatus_t ZDP_GenericRsp( byte TransSeq, zAddrType_t *dstAddr,
   \                     ZDP_GenericRsp:
    933                               byte status, uint16 aoi, uint16 rspID, byte SecurityEnable )
    934          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 1
   \   000005   74FF         MOV     A,#-0x1
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   85..82       MOV     DPL,?XSP + 0
   \   00000E   85..83       MOV     DPH,?XSP + 1
   \   000011   F0           MOVX    @DPTR,A
   \   000012   EA           MOV     A,R2
   \   000013   FE           MOV     R6,A
   \   000014   EB           MOV     A,R3
   \   000015   FF           MOV     R7,A
   \   000016   740B         MOV     A,#0xb
   \   000018   12....       LCALL   ?XSTACK_DISP0_8
   \   00001B   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_37:
   \   00001E   740D         MOV     A,#0xd
   \   000020   12....       LCALL   ?XSTACK_DISP0_8
   \   000023   12....       LCALL   ?Subroutine17 & 0xFFFF
    935            uint8 len;
    936          
    937            ZDP_TmpBuf[0] = status;
   \                     ??CrossCallReturnLabel_44:
   \   000026   F583         MOV     DPH,A
   \   000028   8A82         MOV     DPL,R2
   \   00002A   EC           MOV     A,R4
   \   00002B   F0           MOVX    @DPTR,A
    938            ZDP_TmpBuf[1] = LO_UINT16( aoi );
   \   00002C   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FA           MOV     R2,A
   \   000031   A3           INC     DPTR
   \   000032   E0           MOVX    A,@DPTR
   \   000033   F583         MOV     DPH,A
   \   000035   8A82         MOV     DPL,R2
   \   000037   A3           INC     DPTR
   \   000038   E8           MOV     A,R0
   \   000039   F0           MOVX    @DPTR,A
    939            ZDP_TmpBuf[2] = HI_UINT16( aoi );
   \   00003A   12....       LCALL   ?Subroutine21 & 0xFFFF
    940          
    941            if ( NLME_GetProtocolVersion() != ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_56:
   \   00003D                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   00003D   90....       MOV     DPTR,#(NLME_GetProtocolVersion & 0xffff)
   \   000040   74..         MOV     A,#((NLME_GetProtocolVersion >> 16) & 0xff)
   \   000042   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000045   E9           MOV     A,R1
   \   000046   6401         XRL     A,#0x1
   \   000048   600E         JZ      ??ZDP_GenericRsp_0
    942            {
    943              // Length byte
    944              ZDP_TmpBuf[3] = 0;
   \   00004A   90....       MOV     DPTR,#??ZDP_TmpBuf
   \   00004D   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_68:
   \   000050   A3           INC     DPTR
   \   000051   A3           INC     DPTR
   \   000052   E4           CLR     A
   \   000053   F0           MOVX    @DPTR,A
    945              len = 4;
   \   000054   7904         MOV     R1,#0x4
   \   000056   8002         SJMP    ??ZDP_GenericRsp_1
    946            }
    947            else
    948            {
    949              len = 3;
   \                     ??ZDP_GenericRsp_0:
   \   000058   7903         MOV     R1,#0x3
    950            }
    951          
    952          
    953            return fillAndSend( &TransSeq, dstAddr, rspID, len );
   \                     ??ZDP_GenericRsp_1:
   \   00005A                ; Setup parameters for call to function fillAndSend
   \   00005A   78..         MOV     R0,#?V0 + 0
   \   00005C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005F   EE           MOV     A,R6
   \   000060   FC           MOV     R4,A
   \   000061   EF           MOV     A,R7
   \   000062   02....       LJMP    ??Subroutine63_0 & 0xFFFF
    954          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine26:
   \   000000   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_115:
   \   000003   22           RET
    955          
    956          /*********************************************************************
    957           * Binding
    958           */
    959          #if defined ( ZDO_ENDDEVICEBIND_REQUEST )
    960          /*********************************************************************
    961           * @fn          ZDP_EndDeviceBindReq
    962           *
    963           * @brief       This builds and sends a End_Device_Bind_req message.
    964           *              This function sends a unicast message.
    965           *
    966           * @param       dstAddr - destination address
    967           * @param       LocalCoordinator - short address of local coordinator
    968           * @param       epIntf - Endpoint/Interface of Simple Desc
    969           * @param       ProfileID - Profile ID
    970           *
    971           *   The Input cluster list is the opposite of what you would think.
    972           *   This is the output cluster list of this device
    973           * @param       NumInClusters - number of input clusters
    974           * @param       InClusterList - input cluster ID list
    975           *
    976           *   The Output cluster list is the opposite of what you would think.
    977           *   This is the input cluster list of this device
    978           * @param       NumOutClusters - number of output clusters
    979           * @param       OutClusterList - output cluster ID list
    980           *
    981           * @param       SecurityEnable - Security Options
    982           *
    983           * @return      afStatus_t
    984           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
    985          afStatus_t ZDP_EndDeviceBindReq( zAddrType_t *dstAddr,
   \                     ZDP_EndDeviceBindReq:
    986                                           uint16 LocalCoordinator,
    987                                           byte endPoint,
    988                                           uint16 ProfileID,
    989                                           byte NumInClusters, cId_t *InClusterList,
    990                                           byte NumOutClusters, cId_t *OutClusterList,
    991                                           byte SecurityEnable )
    992          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EA           MOV     A,R2
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   EB           MOV     A,R3
   \   000013   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_89:
   \   000016   8C..         MOV     ?V0 + 0,R4
   \   000018   8D..         MOV     ?V0 + 1,R5
   \   00001A   7413         MOV     A,#0x13
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   12....       LCALL   ??Subroutine25_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_66:
   \   000022   7415         MOV     A,#0x15
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   E0           MOVX    A,@DPTR
   \   000028   F5..         MOV     ?V0 + 7,A
   \   00002A   7418         MOV     A,#0x18
   \   00002C   12....       LCALL   ?XSTACK_DISP0_8
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   F5..         MOV     ?V0 + 6,A
    993            uint8 *pBuf = ZDP_TmpBuf;
   \   000032   12....       LCALL   ?Subroutine19 & 0xFFFF
    994            uint8 i, len;
    995            uint8 *ieeeAddr;
    996            uint8 protoVer = NLME_GetProtocolVersion();
   \                     ??CrossCallReturnLabel_153:
   \   000035   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000038   E9           MOV     A,R1
   \   000039   F5..         MOV     ?V0 + 5,A
    997          
    998            if ( protoVer != ZB_PROT_V1_0 )
   \   00003B   7401         MOV     A,#0x1
   \   00003D   65..         XRL     A,?V0 + 5
   \   00003F   6007         JZ      ??ZDP_EndDeviceBindReq_0
    999            {
   1000              // LocalCoordinator + SrcExtAddr + ep + ProfileID +  NumInClusters + NumOutClusters.
   1001              len = 2 + Z_EXTADDR_LEN + 1 + 2 + 1 + 1;
   \   000041   75..0F       MOV     ?V0 + 4,#0xf
   \   000044   7802         MOV     R0,#0x2
   \   000046   8005         SJMP    ??ZDP_EndDeviceBindReq_1
   1002            }
   1003            else
   1004            {
   1005              // LocalCoordinator + ep + ProfileID +  NumInClusters + NumOutClusters.
   1006              len = 2 + 1 + 2 + 1 + 1;
   \                     ??ZDP_EndDeviceBindReq_0:
   \   000048   75..07       MOV     ?V0 + 4,#0x7
   \   00004B   7801         MOV     R0,#0x1
   \                     ??ZDP_EndDeviceBindReq_1:
   \   00004D   E5..         MOV     A,?V0 + 6
   \   00004F   25..         ADD     A,?V0 + 7
   \   000051   F5F0         MOV     B,A
   \   000053   E8           MOV     A,R0
   \   000054   A4           MUL     AB
   \   000055   25..         ADD     A,?V0 + 4
   \   000057   F5..         MOV     ?V0 + 4,A
   1007            }
   1008          
   1009            len += (NumInClusters + NumOutClusters) * ((protoVer != ZB_PROT_V1_0) ? sizeof ( uint16 ) : sizeof( uint8 ));
   1010            if ( len >= ZDP_BUF_SZ-1 )
   \   000059   C3           CLR     C
   \   00005A   944F         SUBB    A,#0x4f
   \   00005C   4005         JC      ??ZDP_EndDeviceBindReq_2
   1011            {
   1012              return afStatus_MEM_FAIL;
   \   00005E   7981         MOV     R1,#-0x7f
   \   000060   02....       LJMP    ??ZDP_EndDeviceBindReq_3 & 0xFFFF
   1013            }
   1014          
   1015            *pBuf++ = LO_UINT16( LocalCoordinator );
   \                     ??ZDP_EndDeviceBindReq_2:
   \   000063   85..82       MOV     DPL,?V0 + 2
   \   000066   85..83       MOV     DPH,?V0 + 3
   \   000069   E5..         MOV     A,?V0 + 0
   \   00006B   F0           MOVX    @DPTR,A
   \   00006C   A3           INC     DPTR
   1016            *pBuf++ = HI_UINT16( LocalCoordinator );
   \   00006D   E5..         MOV     A,?V0 + 1
   \   00006F   12....       LCALL   ?Subroutine35 & 0xFFFF
   1017          
   1018            if ( protoVer != ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_85:
   \   000072   7401         MOV     A,#0x1
   \   000074   65..         XRL     A,?V0 + 5
   \   000076   601C         JZ      ??ZDP_EndDeviceBindReq_4
   1019            {
   1020              ieeeAddr = NLME_GetExtAddr();
   1021              pBuf = osal_cpyExtAddr( pBuf, ieeeAddr );
   \   000078                ; Setup parameters for call to function osal_cpyExtAddr
   \   000078                ; Setup parameters for call to function NLME_GetExtAddr
   \   000078   90....       MOV     DPTR,#(NLME_GetExtAddr & 0xffff)
   \   00007B   74..         MOV     A,#((NLME_GetExtAddr >> 16) & 0xff)
   \   00007D   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000080   EA           MOV     A,R2
   \   000081   FC           MOV     R4,A
   \   000082   EB           MOV     A,R3
   \   000083   FD           MOV     R5,A
   \   000084   AA..         MOV     R2,?V0 + 2
   \   000086   AB..         MOV     R3,?V0 + 3
   \   000088   90....       MOV     DPTR,#(osal_cpyExtAddr & 0xffff)
   \   00008B   74..         MOV     A,#((osal_cpyExtAddr >> 16) & 0xff)
   \   00008D   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000090   8A..         MOV     ?V0 + 2,R2
   \   000092   8B..         MOV     ?V0 + 3,R3
   1022            }
   1023          
   1024            *pBuf++ = endPoint;
   \                     ??ZDP_EndDeviceBindReq_4:
   \   000094   85..82       MOV     DPL,?XSP + 0
   \   000097   85..83       MOV     DPH,?XSP + 1
   \   00009A   E0           MOVX    A,@DPTR
   \   00009B   85..82       MOV     DPL,?V0 + 2
   \   00009E   85..83       MOV     DPH,?V0 + 3
   \   0000A1   F0           MOVX    @DPTR,A
   \   0000A2   A3           INC     DPTR
   1025          
   1026            *pBuf++ = LO_UINT16( ProfileID );   // Profile ID
   \   0000A3   EE           MOV     A,R6
   \   0000A4   F0           MOVX    @DPTR,A
   \   0000A5   A3           INC     DPTR
   1027            *pBuf++ = HI_UINT16( ProfileID );
   \   0000A6   EF           MOV     A,R7
   \   0000A7   F0           MOVX    @DPTR,A
   \   0000A8   A3           INC     DPTR
   1028          
   1029            *pBuf++ = NumInClusters; // Input cluster list
   \   0000A9   E5..         MOV     A,?V0 + 7
   \   0000AB   12....       LCALL   ?Subroutine34 & 0xFFFF
   1030            for ( i = 0; i < NumInClusters; ++i )
   \                     ??CrossCallReturnLabel_81:
   \   0000AE   801A         SJMP    ??ZDP_EndDeviceBindReq_5
   1031            {
   1032              *pBuf++ = LO_UINT16(InClusterList[i]);
   \                     ??ZDP_EndDeviceBindReq_6:
   \   0000B0   EA           MOV     A,R2
   \   0000B1   C3           CLR     C
   \   0000B2   33           RLC     A
   \   0000B3   F8           MOV     R0,A
   \   0000B4   E4           CLR     A
   \   0000B5   33           RLC     A
   \   0000B6   F9           MOV     R1,A
   \   0000B7   7416         MOV     A,#0x16
   \   0000B9   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BC   12....       LCALL   ?Subroutine0 & 0xFFFF
   1033              if (protoVer != ZB_PROT_V1_0)  {
   \                     ??CrossCallReturnLabel_0:
   \   0000BF   6008         JZ      ??CrossCallReturnLabel_2
   1034                *pBuf++ = HI_UINT16(InClusterList[i]);
   \   0000C1   7416         MOV     A,#0x16
   \   0000C3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C6   12....       LCALL   ?Subroutine1 & 0xFFFF
   1035              }
   1036            }
   \                     ??CrossCallReturnLabel_2:
   \   0000C9   0A           INC     R2
   \                     ??ZDP_EndDeviceBindReq_5:
   \   0000CA   EA           MOV     A,R2
   \   0000CB   C3           CLR     C
   \   0000CC   95..         SUBB    A,?V0 + 7
   \   0000CE   40E0         JC      ??ZDP_EndDeviceBindReq_6
   1037          
   1038            *pBuf++ = NumOutClusters; // Output cluster list
   \   0000D0   85..82       MOV     DPL,?V0 + 2
   \   0000D3   85..83       MOV     DPH,?V0 + 3
   \   0000D6   E5..         MOV     A,?V0 + 6
   \   0000D8   12....       LCALL   ?Subroutine34 & 0xFFFF
   1039            for ( i = 0; i < NumOutClusters; ++i )
   \                     ??CrossCallReturnLabel_82:
   \   0000DB   801A         SJMP    ??ZDP_EndDeviceBindReq_7
   1040            {
   1041              *pBuf++ = LO_UINT16(OutClusterList[i]);
   \                     ??ZDP_EndDeviceBindReq_8:
   \   0000DD   EA           MOV     A,R2
   \   0000DE   C3           CLR     C
   \   0000DF   33           RLC     A
   \   0000E0   F8           MOV     R0,A
   \   0000E1   E4           CLR     A
   \   0000E2   33           RLC     A
   \   0000E3   F9           MOV     R1,A
   \   0000E4   7419         MOV     A,#0x19
   \   0000E6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E9   12....       LCALL   ?Subroutine0 & 0xFFFF
   1042              if (protoVer != ZB_PROT_V1_0)  {
   \                     ??CrossCallReturnLabel_1:
   \   0000EC   6008         JZ      ??CrossCallReturnLabel_3
   1043                *pBuf++ = HI_UINT16(OutClusterList[i]);
   \   0000EE   7419         MOV     A,#0x19
   \   0000F0   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F3   12....       LCALL   ?Subroutine1 & 0xFFFF
   1044              }
   1045            }
   \                     ??CrossCallReturnLabel_3:
   \   0000F6   0A           INC     R2
   \                     ??ZDP_EndDeviceBindReq_7:
   \   0000F7   EA           MOV     A,R2
   \   0000F8   C3           CLR     C
   \   0000F9   95..         SUBB    A,?V0 + 6
   \   0000FB   40E0         JC      ??ZDP_EndDeviceBindReq_8
   1046          
   1047            return fillAndSend( &ZDP_TransID, dstAddr, End_Device_Bind_req, len );
   \   0000FD                ; Setup parameters for call to function fillAndSend
   \   0000FD   75..20       MOV     ?V0 + 0,#0x20
   \   000100   75..00       MOV     ?V0 + 1,#0x0
   \   000103   78..         MOV     R0,#?V0 + 0
   \   000105   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000108   A9..         MOV     R1,?V0 + 4
   \   00010A   7403         MOV     A,#0x3
   \   00010C   12....       LCALL   ?XSTACK_DISP0_8
   \   00010F   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000112   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000115   7402         MOV     A,#0x2
   \   000117   12....       LCALL   ?DEALLOC_XSTACK8
   \                     ??ZDP_EndDeviceBindReq_3:
   \   00011A                REQUIRE ?Subroutine73
   \   00011A                ; // Fall through to label ?Subroutine73
   1048          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine73:
   \   000000   7403         MOV     A,#0x3
   \   000002   02....       LJMP    ??Subroutine69_0 & 0xFFFF

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine34:
   \   000000   12....       LCALL   ?Subroutine53 & 0xFFFF
   \                     ??CrossCallReturnLabel_125:
   \   000003   7A00         MOV     R2,#0x0
   \   000005   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   12....       LCALL   ?Subroutine51 & 0xFFFF
   \                     ??CrossCallReturnLabel_122:
   \   000003   12....       LCALL   ?Subroutine46 & 0xFFFF
   \                     ??CrossCallReturnLabel_108:
   \   000006   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   12....       LCALL   ?Subroutine51 & 0xFFFF
   \                     ??CrossCallReturnLabel_121:
   \   000003   12....       LCALL   ?Subroutine44 & 0xFFFF
   \                     ??CrossCallReturnLabel_104:
   \   000006   65..         XRL     A,?V0 + 5
   \   000008   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine51:
   \   000000   E0           MOVX    A,@DPTR
   \   000001   28           ADD     A,R0
   \   000002   FB           MOV     R3,A
   \   000003   A3           INC     DPTR
   \   000004   E0           MOVX    A,@DPTR
   \   000005   39           ADDC    A,R1
   \   000006   8B82         MOV     DPL,R3
   \   000008   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine37:
   \   000000   F0           MOVX    @DPTR,A
   \   000001   E9           MOV     A,R1
   \   000002   85..82       MOV     DPL,?XSP + 0
   \   000005   85..83       MOV     DPH,?XSP + 1
   \   000008   F0           MOVX    @DPTR,A
   \   000009   22           RET
   1049          #endif // ZDO_ENDDEVICEBIND_REQUEST
   1050          
   1051          #if defined ( ZDO_BIND_UNBIND_REQUEST ) || defined ( ZDO_COORDINATOR )
   1052          /*********************************************************************
   1053           * @fn          ZDP_BindUnbindReq
   1054           *
   1055           * @brief       This builds and send a Bind_req or Unbind_req message
   1056           *              Depending on the ClusterID. This function
   1057           *              sends a unicast message to the local coordinator.
   1058           *
   1059           * @param       BindOrUnbind - either Bind_req or Unbind_req
   1060           * @param       dstAddr - destination address of the message
   1061           * @param       SourceAddr - source 64 bit address of the binding
   1062           * @param       SrcEPIntf - Source endpoint/interface
   1063           * @param       ClusterID - Binding cluster ID
   1064           * @param       DestinationAddr - destination 64 bit addr of binding
   1065           * @param       DstEPIntf - destination endpoint/interface
   1066           * @param       SecurityEnable - Security Options
   1067           *
   1068           * @return      afStatus_t
   1069           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   1070          afStatus_t ZDP_BindUnbindReq( uint16 BindOrUnbind, zAddrType_t *dstAddr,
   \                     ZDP_BindUnbindReq:
   1071                                        byte *SourceAddr, byte SrcEndPoint,
   1072                                        cId_t ClusterID,
   1073                                        zAddrType_t *destinationAddr, byte DstEndPoint,
   1074                                        byte SecurityEnable )
   1075          {
   \   000000   74F0         MOV     A,#-0x10
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 16
   \   000005                ; Auto size: 3
   \   000005   74FD         MOV     A,#-0x3
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   7401         MOV     A,#0x1
   \   00000C   12....       LCALL   ?XSTACK_DISP0_8
   \   00000F   EC           MOV     A,R4
   \   000010   F0           MOVX    @DPTR,A
   \   000011   A3           INC     DPTR
   \   000012   ED           MOV     A,R5
   \   000013   12....       LCALL   ?Subroutine37 & 0xFFFF
   \                     ??CrossCallReturnLabel_90:
   \   000016   8A..         MOV     ?V0 + 6,R2
   \   000018   8B..         MOV     ?V0 + 7,R3
   \   00001A   7413         MOV     A,#0x13
   \   00001C   12....       LCALL   ?XSTACK_DISP0_8
   \   00001F   12....       LCALL   ?Subroutine20 & 0xFFFF
   \                     ??CrossCallReturnLabel_54:
   \   000022   7415         MOV     A,#0x15
   \   000024   12....       LCALL   ?XSTACK_DISP0_8
   \   000027   12....       LCALL   ??Subroutine25_0 & 0xFFFF
   1076            uint8 *pBuf = ZDP_TmpBuf;
   \                     ??CrossCallReturnLabel_67:
   \   00002A   12....       LCALL   ?Subroutine18 & 0xFFFF
   1077            uint8  protoVer;
   1078            byte len;
   1079          
   1080            protoVer = NLME_GetProtocolVersion();
   \                     ??CrossCallReturnLabel_50:
   \   00002D                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   00002D   90....       MOV     DPTR,#(NLME_GetProtocolVersion & 0xffff)
   \   000030   74..         MOV     A,#((NLME_GetProtocolVersion >> 16) & 0xff)
   \   000032   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000035   E9           MOV     A,R1
   \   000036   F5..         MOV     ?V0 + 3,A
   1081          
   1082            if ( protoVer == ZB_PROT_V1_0 )
   \   000038   7401         MOV     A,#0x1
   \   00003A   65..         XRL     A,?V0 + 3
   \   00003C   7005         JNZ     ??ZDP_BindUnbindReq_0
   1083            {
   1084              // SourceAddr + SrcEPIntf + ClusterID +  DestinationAddr + DstEPIntf.
   1085              len = Z_EXTADDR_LEN + 1 + sizeof( uint8 ) + Z_EXTADDR_LEN + 1;
   \   00003E   75..13       MOV     ?V0 + 2,#0x13
   \   000041   802C         SJMP    ??ZDP_BindUnbindReq_1
   1086            }
   1087            else
   1088            {
   1089              // SourceAddr + SrcEPIntf + ClusterID +  addrMode.
   1090              len = Z_EXTADDR_LEN + 1 + sizeof( cId_t ) + sizeof( uint8 );
   \                     ??ZDP_BindUnbindReq_0:
   \   000043   75..0C       MOV     ?V0 + 2,#0xc
   1091              if ( destinationAddr->addrMode == Addr64Bit )
   \   000046   7417         MOV     A,#0x17
   \   000048   12....       LCALL   ?XSTACK_DISP0_8
   \   00004B   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_24:
   \   00004E   6403         XRL     A,#0x3
   \   000050   7005         JNZ     ??ZDP_BindUnbindReq_2
   1092                len += Z_EXTADDR_LEN + 1;     // +1 for DstEPIntf
   \   000052   75..15       MOV     ?V0 + 2,#0x15
   \   000055   8018         SJMP    ??ZDP_BindUnbindReq_1
   1093              else if ( destinationAddr->addrMode == AddrGroup )
   \                     ??ZDP_BindUnbindReq_2:
   \   000057   7417         MOV     A,#0x17
   \   000059   12....       LCALL   ?XSTACK_DISP0_8
   \   00005C   12....       LCALL   ?Subroutine65 & 0xFFFF
   \                     ??CrossCallReturnLabel_144:
   \   00005F   A3           INC     DPTR
   \   000060   A3           INC     DPTR
   \   000061   A3           INC     DPTR
   \   000062   A3           INC     DPTR
   \   000063   A3           INC     DPTR
   \   000064   A3           INC     DPTR
   \   000065   A3           INC     DPTR
   \   000066   A3           INC     DPTR
   \   000067   E0           MOVX    A,@DPTR
   \   000068   6401         XRL     A,#0x1
   \   00006A   7003         JNZ     ??ZDP_BindUnbindReq_1
   1094                len += sizeof ( uint16 );
   \   00006C   75..0E       MOV     ?V0 + 2,#0xe
   1095            }
   1096          
   1097            pBuf = osal_cpyExtAddr( pBuf, SourceAddr );
   \                     ??ZDP_BindUnbindReq_1:
   \   00006F                ; Setup parameters for call to function osal_cpyExtAddr
   \   00006F   AC..         MOV     R4,?V0 + 4
   \   000071   AD..         MOV     R5,?V0 + 5
   \   000073   AA..         MOV     R2,?V0 + 0
   \   000075   AB..         MOV     R3,?V0 + 1
   \   000077   90....       MOV     DPTR,#(osal_cpyExtAddr & 0xffff)
   \   00007A   74..         MOV     A,#((osal_cpyExtAddr >> 16) & 0xff)
   \   00007C   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   1098            *pBuf++ = SrcEndPoint;
   \   00007F   85..82       MOV     DPL,?XSP + 0
   \   000082   85..83       MOV     DPH,?XSP + 1
   \   000085   E0           MOVX    A,@DPTR
   \   000086   8A82         MOV     DPL,R2
   \   000088   8B83         MOV     DPH,R3
   \   00008A   F0           MOVX    @DPTR,A
   \   00008B   A3           INC     DPTR
   1099          
   1100            *pBuf++ = LO_UINT16( ClusterID );
   \   00008C   EE           MOV     A,R6
   \   00008D   12....       LCALL   ?Subroutine31 & 0xFFFF
   1101            if ( protoVer != ZB_PROT_V1_0 )
   \                     ??CrossCallReturnLabel_75:
   \   000090   603F         JZ      ??ZDP_BindUnbindReq_3
   1102            {
   1103              *pBuf++ = HI_UINT16( ClusterID );
   \   000092   EF           MOV     A,R7
   \   000093   12....       LCALL   ?Subroutine38 & 0xFFFF
   1104          
   1105              *pBuf++ = destinationAddr->addrMode;
   \                     ??CrossCallReturnLabel_92:
   \   000096   7417         MOV     A,#0x17
   \   000098   12....       LCALL   ?XSTACK_DISP0_8
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   2408         ADD     A,#0x8
   \   00009E   F8           MOV     R0,A
   \   00009F   A3           INC     DPTR
   \   0000A0   E0           MOVX    A,@DPTR
   \   0000A1   3400         ADDC    A,#0x0
   \   0000A3   F9           MOV     R1,A
   \   0000A4   12....       LCALL   ?Subroutine8 & 0xFFFF
   1106              if ( destinationAddr->addrMode == Addr64Bit )
   \                     ??CrossCallReturnLabel_157:
   \   0000A7   E0           MOVX    A,@DPTR
   \   0000A8   6403         XRL     A,#0x3
   \   0000AA   6025         JZ      ??ZDP_BindUnbindReq_3
   1107              {
   1108                pBuf = osal_cpyExtAddr( pBuf, destinationAddr->addr.extAddr );
   \   0000AC                ; Setup parameters for call to function osal_cpyExtAddr
   1109                *pBuf = DstEndPoint;
   1110              }
   1111              else if ( destinationAddr->addrMode == AddrGroup )
   \   0000AC   7417         MOV     A,#0x17
   \   0000AE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B1   12....       LCALL   ?Subroutine11 & 0xFFFF
   \                     ??CrossCallReturnLabel_25:
   \   0000B4   6401         XRL     A,#0x1
   \   0000B6   7038         JNZ     ??ZDP_BindUnbindReq_4
   1112              {
   1113                *pBuf++ = LO_UINT16( destinationAddr->addr.shortAddr );
   \   0000B8   7417         MOV     A,#0x17
   \   0000BA   12....       LCALL   ?XSTACK_DISP0_8
   \   0000BD   12....       LCALL   ?Subroutine65 & 0xFFFF
   \                     ??CrossCallReturnLabel_145:
   \   0000C0   12....       LCALL   ?Subroutine58 & 0xFFFF
   \                     ??CrossCallReturnLabel_134:
   \   0000C3   F0           MOVX    @DPTR,A
   1114                *pBuf++ = HI_UINT16( destinationAddr->addr.shortAddr );
   \   0000C4   7417         MOV     A,#0x17
   \   0000C6   12....       LCALL   ?XSTACK_DISP0_8
   \   0000C9   12....       LCALL   ?Subroutine26 & 0xFFFF
   \                     ??CrossCallReturnLabel_69:
   \   0000CC   12....       LCALL   ?Subroutine30 & 0xFFFF
   \                     ??CrossCallReturnLabel_73:
   \   0000CF   801E         SJMP    ??ZDP_BindUnbindReq_5
   1115              }
   1116            }
   1117            else
   1118            {
   1119              pBuf = osal_cpyExtAddr( pBuf, destinationAddr->addr.extAddr );
   \                     ??ZDP_BindUnbindReq_3:
   \   0000D1                ; Setup parameters for call to function osal_cpyExtAddr
   \   0000D1   7417         MOV     A,#0x17
   \   0000D3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D6   12....       LCALL   ??Subroutine23_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_60:
   \   0000D9   AA..         MOV     R2,?V0 + 0
   \   0000DB   AB..         MOV     R3,?V0 + 1
   \   0000DD   90....       MOV     DPTR,#(osal_cpyExtAddr & 0xffff)
   \   0000E0   74..         MOV     A,#((osal_cpyExtAddr >> 16) & 0xff)
   \   0000E2   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   1120              *pBuf = DstEndPoint;
   \   0000E5   7419         MOV     A,#0x19
   \   0000E7   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   8A82         MOV     DPL,R2
   \   0000ED   8B83         MOV     DPH,R3
   \                     ??ZDP_BindUnbindReq_5:
   \   0000EF   F0           MOVX    @DPTR,A
   1121            }
   1122          
   1123            FillAndSendTxOptions( &ZDP_TransID, dstAddr, BindOrUnbind, len, AF_MSG_ACK_REQUEST );
   \                     ??ZDP_BindUnbindReq_4:
   \   0000F0   7410         MOV     A,#0x10
   \   0000F2   90....       MOV     DPTR,#??ZDP_TxOptions
   \   0000F5   F0           MOVX    @DPTR,A
   \   0000F6                ; Setup parameters for call to function fillAndSend
   \   0000F6   78..         MOV     R0,#?V0 + 6
   \   0000F8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000FB   A9..         MOV     R1,?V0 + 2
   \   0000FD   7403         MOV     A,#0x3
   \   0000FF   12....       LCALL   ?XSTACK_DISP0_8
   \   000102   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_6:
   \   000105   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000108   7402         MOV     A,#0x2
   \   00010A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00010D   E4           CLR     A
   \   00010E   90....       MOV     DPTR,#??ZDP_TxOptions
   \   000111   F0           MOVX    @DPTR,A
   \   000112   02....       LJMP    ?Subroutine73 & 0xFFFF
   1124          }

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine11:
   \   000000   12....       LCALL   ??Subroutine48_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_113:
   \   000003   A3           INC     DPTR
   \   000004   A3           INC     DPTR
   \   000005   A3           INC     DPTR
   \   000006   A3           INC     DPTR
   \   000007   A3           INC     DPTR
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET
   1125          #endif // ZDO_BIND_UNBIND_REQUEST
   1126          
   1127          /*********************************************************************
   1128           * Network Management
   1129           */
   1130          
   1131          #if defined ( ZDO_MGMT_NWKDISC_REQUEST )
   1132          /*********************************************************************
   1133           * @fn          ZDP_MgmtNwkDiscReq
   1134           *
   1135           * @brief       This builds and send a Mgmt_NWK_Disc_req message. This
   1136           *              function sends a unicast message.
   1137           *
   1138           * @param       dstAddr - destination address of the message
   1139           * @param       ScanChannels - 32 bit address bit map
   1140           * @param       StartIndex - Starting index within the reporting network
   1141           *                           list
   1142           * @param       SecurityEnable - Security Options
   1143           *
   1144           * @return      afStatus_t
   1145           */
   1146          afStatus_t ZDP_MgmtNwkDiscReq( zAddrType_t *dstAddr,
   1147                                         uint32 ScanChannels,
   1148                                         byte ScanDuration,
   1149                                         byte StartIndex,
   1150                                         byte SecurityEnable )
   1151          {
   1152            byte *pBuf = ZDP_TmpBuf;
   1153            byte len = sizeof( uint32 )+1+1;  // ScanChannels + ScanDuration + StartIndex.
   1154          
   1155            *pBuf++ = BREAK_UINT32( ScanChannels, 0 );
   1156            *pBuf++ = BREAK_UINT32( ScanChannels, 1 );
   1157            *pBuf++ = BREAK_UINT32( ScanChannels, 2 );
   1158            *pBuf++ = BREAK_UINT32( ScanChannels, 3 );
   1159          
   1160            *pBuf++ = ScanDuration;
   1161            *pBuf = StartIndex;
   1162          
   1163            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_NWK_Disc_req, len );
   1164          }
   1165          #endif // ZDO_MGMT_NWKDISC_REQUEST
   1166          
   1167          #if defined ( ZDO_MGMT_JOINDIRECT_REQUEST )
   1168          /*********************************************************************
   1169           * @fn          ZDP_MgmtDirectJoinReq
   1170           *
   1171           * @brief       This builds and send a Mgmt_Direct_Join_req message. This
   1172           *              function sends a unicast message.
   1173           *
   1174           * @param       dstAddr - destination address of the message
   1175           * @param       deviceAddr - 64 bit IEEE Address
   1176           * @param       SecurityEnable - Security Options
   1177           *
   1178           * @return      afStatus_t
   1179           */
   1180          afStatus_t ZDP_MgmtDirectJoinReq( zAddrType_t *dstAddr,
   1181                                         byte *deviceAddr,
   1182                                         byte capInfo,
   1183                                         byte SecurityEnable )
   1184          {
   1185            osal_cpyExtAddr( ZDP_TmpBuf, deviceAddr );
   1186            ZDP_TmpBuf[Z_EXTADDR_LEN] = capInfo;
   1187          
   1188            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_Direct_Join_req, (Z_EXTADDR_LEN + 1) );
   1189          }
   1190          #endif // ZDO_MGMT_JOINDIRECT_REQUEST
   1191          
   1192          #if defined ( ZDO_MGMT_PERMIT_JOIN_REQUEST )
   1193          /*********************************************************************
   1194           * @fn          ZDP_MgmtPermitJoinReq
   1195           *
   1196           * @brief       This builds and send a Mgmt_Permit_Join_req message.
   1197           *
   1198           * @param       dstAddr - destination address of the message
   1199           * @param       duration - Permit duration
   1200           * @param       TcSignificance - Trust Center Significance
   1201           *
   1202           * @return      afStatus_t
   1203           */
   1204          afStatus_t ZDP_MgmtPermitJoinReq( zAddrType_t *dstAddr, byte duration,
   1205                                            byte TcSignificance, byte SecurityEnable )
   1206          {
   1207            // Build buffer
   1208            ZDP_TmpBuf[ZDP_MGMT_PERMIT_JOIN_REQ_DURATION] = duration;
   1209            ZDP_TmpBuf[ZDP_MGMT_PERMIT_JOIN_REQ_TC_SIG]   = TcSignificance;
   1210          
   1211            // Send the message
   1212            return fillAndSend( &ZDP_TransID, dstAddr, Mgmt_Permit_Join_req,
   1213                                ZDP_MGMT_PERMIT_JOIN_REQ_SIZE );
   1214          }
   1215          #endif // ZDO_MGMT_PERMIT_JOIN_REQUEST
   1216          
   1217          /*********************************************************************
   1218           * Network Management Responses
   1219           */
   1220          
   1221          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1222          /*********************************************************************
   1223           * @fn          ZDP_MgmtNwkDiscRsp
   1224           *
   1225           * @brief       This builds and send a Mgmt_NWK_Disc_rsp message. This
   1226           *              function sends a unicast message.
   1227           *
   1228           * @param       dstAddr - destination address of the message
   1229           * @param       Status - message status (ZDP_SUCCESS or other)
   1230           * @param       NetworkCount - Total number of networks found
   1231           * @param       StartIndex - Starting index within the reporting network
   1232           *                           list
   1233           * @param       NetworkListCount - number of network lists included
   1234           *                                 in this message
   1235           * @param       NetworkList - List of network descriptors
   1236           * @param       SecurityEnable - Security Options
   1237           *
   1238           * @return      afStatus_t
   1239           */
   1240          afStatus_t ZDP_MgmtNwkDiscRsp( byte TransSeq, zAddrType_t *dstAddr,
   1241                                      byte Status,
   1242                                      byte NetworkCount,
   1243                                      byte StartIndex,
   1244                                      byte NetworkListCount,
   1245                                      networkDesc_t *NetworkList,
   1246                                      byte SecurityEnable )
   1247          {
   1248            byte *buf;
   1249            byte *pBuf;
   1250            byte len = 1+1+1+1;  // Status + NetworkCount + StartIndex + NetworkCountList.
   1251            byte idx;
   1252          
   1253            byte proVer = NLME_GetProtocolVersion();
   1254          
   1255            if ( proVer == ZB_PROT_V1_0 )
   1256            {
   1257              len += ((NetworkListCount - StartIndex) * ( ZDP_NETWORK_DISCRIPTOR_SIZE - 2 ));  // Four half bytes
   1258            }
   1259            else //Include the extended PanID
   1260            {
   1261              len += ((NetworkListCount - StartIndex) * ( ZDP_NETWORK_EXTENDED_DISCRIPTOR_SIZE - 2 ));
   1262            }
   1263          
   1264            buf = osal_mem_alloc( len+1 );
   1265            if ( buf == NULL )
   1266            {
   1267              return afStatus_MEM_FAIL;
   1268            }
   1269          
   1270            pBuf = buf+1;
   1271          
   1272            *pBuf++ = Status;
   1273            *pBuf++ = NetworkCount;
   1274            *pBuf++ = StartIndex;
   1275            *pBuf++ = NetworkListCount;
   1276          
   1277            for ( idx = StartIndex; idx < (NetworkListCount - StartIndex); idx++ )
   1278            {
   1279              if ( proVer == ZB_PROT_V1_0 )
   1280              {
   1281                *pBuf++  = LO_UINT16( NetworkList->panId );            // PANID
   1282                *pBuf++  = HI_UINT16( NetworkList->panId );
   1283              }
   1284              else
   1285              {
   1286                osal_cpyExtAddr( pBuf, NetworkList->extendedPANID);
   1287                pBuf += Z_EXTADDR_LEN;
   1288              }
   1289          
   1290              *pBuf++  = NetworkList->logicalChannel;                // LogicalChannel
   1291              *pBuf    = NetworkList->stackProfile;                  // Stack profile
   1292              *pBuf++ |= (byte)(NetworkList->version << 4);          // ZigBee Version
   1293              *pBuf    = NetworkList->beaconOrder;                   // Beacon Order
   1294              *pBuf++ |= (byte)(NetworkList->superFrameOrder << 4);  // Superframe Order
   1295          
   1296              if ( NetworkList->chosenRouter != INVALID_NODE_ADDR )
   1297              {
   1298                *pBuf++ = TRUE;                         // Permit Joining
   1299              }
   1300              else
   1301              {
   1302                *pBuf++ = FALSE;
   1303              }
   1304          
   1305              NetworkList = NetworkList->nextDesc;    // Move to next list entry
   1306            }
   1307          
   1308            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_NWK_Disc_rsp, len, buf );
   1309          }
   1310          #endif // ZDO_MGMT_NWKDISC_RESPONSE
   1311          
   1312          #if defined ( ZDO_MGMT_LQI_RESPONSE ) && defined ( RTR_NWK )
   1313          /*********************************************************************
   1314           * @fn          ZDP_MgmtLqiRsp
   1315           *
   1316           * @brief       This builds and send a Mgmt_Lqi_rsp message. This
   1317           *              function sends a unicast message.
   1318           *
   1319           * @param       dstAddr - destination address of the message
   1320           * @param       Status - message status (ZDP_SUCCESS or other)
   1321           * @param       NeighborLqiEntries - Total number of entries found
   1322           * @param       StartIndex - Starting index within the reporting list
   1323           * @param       NeighborLqiCount - number of lists included
   1324           *                                 in this message
   1325           * @param       NeighborLqiList - List of NeighborLqiItems.  This list
   1326           *                is the list to be sent, not the entire list
   1327           * @param       SecurityEnable - true if secure
   1328           *
   1329           * @return      ZStatus_t
   1330           */
   1331          ZStatus_t ZDP_MgmtLqiRsp( byte TransSeq, zAddrType_t *dstAddr,
   1332                                    byte Status,
   1333                                    byte NeighborLqiEntries,
   1334                                    byte StartIndex,
   1335                                    byte NeighborLqiCount,
   1336                                    ZDP_MgmtLqiItem_t* NeighborList,
   1337                                    byte SecurityEnable )
   1338          {
   1339            ZDP_MgmtLqiItem_t* list = NeighborList;
   1340            byte *buf, *pBuf;
   1341            byte len, x;
   1342            byte proVer = NLME_GetProtocolVersion();
   1343          
   1344            if ( ZSuccess != Status )
   1345            {
   1346              ZDP_TmpBuf[0] = Status;
   1347              return fillAndSend( &TransSeq, dstAddr, Mgmt_Lqi_rsp, 1 );
   1348            }
   1349          
   1350            // (Status + NeighborLqiEntries + StartIndex + NeighborLqiCount) +
   1351            //  neighbor LQI data.
   1352            len = (1 + 1 + 1 + 1) + (NeighborLqiCount * (( proVer == ZB_PROT_V1_0 ) ? ZDP_MGMTLQI_SIZE : ZDP_MGMTLQI_EXTENDED_SIZE));
   1353          
   1354            buf = osal_mem_alloc( len+1 );
   1355            if ( buf == NULL )
   1356            {
   1357              return afStatus_MEM_FAIL;
   1358            }
   1359          
   1360            pBuf = buf+1;
   1361          
   1362            *pBuf++ = Status;
   1363            *pBuf++ = NeighborLqiEntries;
   1364            *pBuf++ = StartIndex;
   1365            *pBuf++ = NeighborLqiCount;
   1366          
   1367            for ( x = 0; x < NeighborLqiCount; x++ )
   1368            {
   1369              if ( proVer == ZB_PROT_V1_0 )
   1370              {
   1371                *pBuf++  = LO_UINT16( list->panID );            // PANID
   1372                *pBuf++  = HI_UINT16( list->panID );
   1373              }
   1374              else
   1375              {
   1376                osal_cpyExtAddr( pBuf, list->extPanID);         // Extended PanID
   1377                pBuf += Z_EXTADDR_LEN;
   1378              }
   1379          
   1380              // EXTADDR
   1381              pBuf = osal_cpyExtAddr( pBuf, list->extAddr );
   1382          
   1383              // NWKADDR
   1384              *pBuf++ = LO_UINT16( list->nwkAddr );
   1385              *pBuf++ = HI_UINT16( list->nwkAddr );
   1386          
   1387              // DEVICETYPE
   1388              *pBuf = list->devType;
   1389          
   1390              // RXONIDLE
   1391              *pBuf |= (uint8)(list->rxOnIdle << 2);
   1392          
   1393              if ( proVer == ZB_PROT_V1_0 )
   1394              {
   1395                // RELATIONSHIP
   1396                *pBuf |= (uint8)(list->relation << 3);
   1397          
   1398                // PERMITJOINING
   1399                *pBuf++ |= (uint8)(list->permit << 5);
   1400          
   1401                // DEPTH
   1402                *pBuf++ = list->depth;
   1403              }
   1404          
   1405              else
   1406              {
   1407                // RELATIONSHIP
   1408                *pBuf++ |= (uint8)(list->relation << 4);
   1409          
   1410                // PERMITJOINING
   1411                *pBuf++ = (uint8)(list->permit);
   1412          
   1413                // DEPTH
   1414                *pBuf++ = list->depth;
   1415              }
   1416          
   1417              // LQI
   1418              *pBuf++ = list->lqi;
   1419          
   1420              list++; // next list entry
   1421            }
   1422          
   1423            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_Lqi_rsp, len, buf );
   1424          }
   1425          #endif // ZDO_MGMT_LQI_RESPONSE && RTR_NWK
   1426          
   1427          #if defined ( ZDO_MGMT_RTG_RESPONSE )
   1428          /*********************************************************************
   1429           * @fn          ZDP_MgmtRtgRsp
   1430           *
   1431           * @brief       This builds and send a Mgmt_Rtg_rsp message. This
   1432           *              function sends a unicast message.
   1433           *
   1434           * @param       dstAddr - destination address of the message
   1435           * @param       Status - message status (ZDP_SUCCESS or other)
   1436           * @param       RoutingTableEntries - Total number of entries
   1437           * @param       StartIndex - Starting index within the reporting list
   1438           * @param       RoutingTableListCount - number of entries included
   1439           *                                      in this message
   1440           * @param       RoutingTableList - List of Routing Table entries
   1441           * @param       SecurityEnable - true to enable security for this message
   1442           *
   1443           * @return      ZStatus_t
   1444           */
   1445          ZStatus_t ZDP_MgmtRtgRsp( byte TransSeq, zAddrType_t *dstAddr,
   1446                                      byte Status,
   1447                                      byte RoutingTableEntries,
   1448                                      byte StartIndex,
   1449                                      byte RoutingListCount,
   1450                                      rtgItem_t *RoutingTableList,
   1451                                      byte SecurityEnable )
   1452          {
   1453            byte *buf;
   1454            byte *pBuf;
   1455            // Status + RoutingTableEntries + StartIndex + RoutingListCount.
   1456            byte len = 1 + 1 + 1 + 1;
   1457            byte x;
   1458          
   1459            // Add an array for Routing List data
   1460            len += (RoutingListCount * ZDP_ROUTINGENTRY_SIZE);
   1461          
   1462            buf = osal_mem_alloc( (short)(len+1) );
   1463            if ( buf == NULL )
   1464            {
   1465              return afStatus_MEM_FAIL;
   1466            }
   1467          
   1468            pBuf = buf+1;
   1469          
   1470            *pBuf++ = Status;
   1471            *pBuf++ = RoutingTableEntries;
   1472            *pBuf++ = StartIndex;
   1473            *pBuf++ = RoutingListCount;
   1474          
   1475            for ( x = 0; x < RoutingListCount; x++ )
   1476            {
   1477              *pBuf++ = LO_UINT16( RoutingTableList->dstAddress );  // Destination Address
   1478              *pBuf++ = HI_UINT16( RoutingTableList->dstAddress );
   1479              *pBuf++ = RoutingTableList->status;
   1480              *pBuf++ = LO_UINT16( RoutingTableList->nextHopAddress );  // Next hop
   1481              *pBuf++ = HI_UINT16( RoutingTableList->nextHopAddress );
   1482              RoutingTableList++;    // Move to next list entry
   1483            }
   1484          
   1485            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_Rtg_rsp, len, buf );
   1486          }
   1487          #endif // ZDO_MGMT_RTG_RESPONSE
   1488          
   1489          #if defined ( ZDO_MGMT_BIND_RESPONSE ) && defined ( REFLECTOR )
   1490          /*********************************************************************
   1491           * @fn          ZDP_MgmtBindRsp
   1492           *
   1493           * @brief       This builds and send a Mgmt_Bind_rsp message. This
   1494           *              function sends a unicast message.
   1495           *
   1496           * @param       dstAddr - destination address of the message
   1497           * @param       Status - message status (ZDP_SUCCESS or other)
   1498           * @param       BindingTableEntries - Total number of entries
   1499           * @param       StartIndex - Starting index within the reporting list
   1500           * @param       BindingTableListCount - number of entries included
   1501           *                                 in this message
   1502           * @param       BindingTableList - List of Binding Table entries
   1503           * @param       SecurityEnable - Security Options
   1504           *
   1505           * @return      ZStatus_t
   1506           */
   1507          ZStatus_t ZDP_MgmtBindRsp( byte TransSeq, zAddrType_t *dstAddr,
   1508                                      byte Status,
   1509                                      byte BindingTableEntries,
   1510                                      byte StartIndex,
   1511                                      byte BindingTableListCount,
   1512                                      apsBindingItem_t *BindingTableList,
   1513                                      byte SecurityEnable )
   1514          {
   1515            uint8 *buf;
   1516            uint8 *pBuf;
   1517            uint8 maxLen; // maxLen is the maximum packet length to allocate enough memory space
   1518            uint8 len;    // Actual length varies due to different addrMode
   1519            uint8 x;
   1520            uint8 protoVer;
   1521            byte extZdpBindEntrySize = ZDP_BINDINGENTRY_SIZE + 1 + 1; // One more byte for cluserID and DstAddrMode
   1522            byte shortZdpBindEntrySize = ZDP_BINDINGENTRY_SIZE + 1 + 1 + 2 - 8 - 1; // clusterID + DstAddrMode + shortAddr - ExtAddr - DstEndpoint
   1523          
   1524            protoVer = NLME_GetProtocolVersion();
   1525          
   1526            // Status + BindingTableEntries + StartIndex + BindingTableListCount.
   1527            maxLen = 1 + 1 + 1 + 1;
   1528            maxLen += (BindingTableListCount * extZdpBindEntrySize );  //max length
   1529            buf = osal_mem_alloc( maxLen + 1 );  // +1 for transaction ID
   1530          
   1531            if ( buf == NULL )
   1532            {
   1533              return afStatus_MEM_FAIL;
   1534            }
   1535          
   1536            pBuf = buf+1;
   1537          
   1538            *pBuf++ = Status;
   1539            *pBuf++ = BindingTableEntries;
   1540            *pBuf++ = StartIndex;
   1541            *pBuf++ = BindingTableListCount;
   1542          
   1543            // Initial length = Status + BindingTableEntries + StartIndex + BindingTableListCount.
   1544            // length += ZDP_BINDINGENTRY_SIZE   -- Version 1.0
   1545            //           extZdpBindEntrySize     -- Version 1.1 extended address mode
   1546            //           shortZdpBindEntrySize   -- Version 1.1 group address mode
   1547          
   1548            len = 1 + 1 + 1 + 1;
   1549            for ( x = 0; x < BindingTableListCount; x++ )
   1550            {
   1551              pBuf = osal_cpyExtAddr( pBuf, BindingTableList->srcAddr );
   1552              *pBuf++ = BindingTableList->srcEP;
   1553          
   1554              // Cluster ID
   1555              *pBuf++ = LO_UINT16( BindingTableList->clusterID );
   1556          
   1557              if ( protoVer != ZB_PROT_V1_0 )
   1558              {
   1559                *pBuf++ = HI_UINT16( BindingTableList->clusterID );
   1560              }
   1561          
   1562              if ( protoVer == ZB_PROT_V1_0 )
   1563              {
   1564                len += ZDP_BINDINGENTRY_SIZE;
   1565                pBuf = osal_cpyExtAddr( pBuf, BindingTableList->dstAddr.addr.extAddr );
   1566                *pBuf++ = BindingTableList->dstEP;
   1567              }
   1568              else
   1569              {
   1570                *pBuf++ = BindingTableList->dstAddr.addrMode;
   1571                if ( BindingTableList->dstAddr.addrMode == Addr64Bit )
   1572                {
   1573                  len += extZdpBindEntrySize;
   1574                  pBuf = osal_cpyExtAddr( pBuf, BindingTableList->dstAddr.addr.extAddr );
   1575                 *pBuf++ = BindingTableList->dstEP;
   1576                }
   1577                else
   1578                {
   1579                  len += shortZdpBindEntrySize;
   1580                  *pBuf++ = LO_UINT16( BindingTableList->dstAddr.addr.shortAddr );
   1581                  *pBuf++ = HI_UINT16( BindingTableList->dstAddr.addr.shortAddr );
   1582                }
   1583              }
   1584              BindingTableList++;    // Move to next list entry
   1585            }
   1586          
   1587            FillAndSendBuffer( &TransSeq, dstAddr, Mgmt_Bind_rsp, len, buf );
   1588          }
   1589          #endif // ZDO_MGMT_BIND_RESPONSE && REFLECTOR
   1590          
   1591          /*********************************************************************
   1592           * Callbacks from the APS layer
   1593           */
   1594          
   1595          /*********************************************************************
   1596           * @fn          ZDP_IncomingData
   1597           *
   1598           * @brief       This function indicates the transfer of a data PDU (ASDU)
   1599           *              from the APS sub-layer to the ZDO.
   1600           *
   1601           * @param       pData - Incoming Message
   1602           *
   1603           * @return      none
   1604           */

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   1605          void ZDP_IncomingData( afIncomingMSGPacket_t *pData )
   \                     ZDP_IncomingData:
   1606          {
   \   000000   74F3         MOV     A,#-0xd
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 13
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FE           MOV     R6,A
   \   00000C   EB           MOV     A,R3
   \   00000D   FF           MOV     R7,A
   1607            byte proVer = NLME_GetProtocolVersion();
   \   00000E                ; Setup parameters for call to function NLME_GetProtocolVersion
   \   00000E   90....       MOV     DPTR,#(NLME_GetProtocolVersion & 0xffff)
   \   000011   74..         MOV     A,#((NLME_GetProtocolVersion >> 16) & 0xff)
   \   000013   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000016   E9           MOV     A,R1
   \   000017   FC           MOV     R4,A
   1608            zAddrType_t addr;
   1609            zAddrType_t *srcAddr;
   1610            byte wasBroadcast;
   1611            cId_t clusterID;
   1612            byte asduLen;
   1613            byte *asdu;
   1614            byte SecurityUse;
   1615            byte TransSeq;
   1616          
   1617            addr.addrMode = Addr16Bit;
   \   000018   7408         MOV     A,#0x8
   \   00001A   12....       LCALL   ?XSTACK_DISP0_8
   \   00001D   7402         MOV     A,#0x2
   \   00001F   F0           MOVX    @DPTR,A
   1618            addr.addr.shortAddr = pData->srcAddr.addr.shortAddr;
   \   000020   8E82         MOV     DPL,R6
   \   000022   8F83         MOV     DPH,R7
   \   000024   A3           INC     DPTR
   \   000025   A3           INC     DPTR
   \   000026   A3           INC     DPTR
   \   000027   A3           INC     DPTR
   \   000028   A3           INC     DPTR
   \   000029   A3           INC     DPTR
   \   00002A   12....       LCALL   ?Subroutine13 & 0xFFFF
   \                     ??CrossCallReturnLabel_29:
   \   00002D   F0           MOVX    @DPTR,A
   1619            srcAddr = &addr;
   1620            wasBroadcast = pData->wasBroadcast;
   \   00002E   EE           MOV     A,R6
   \   00002F   240B         ADD     A,#0xb
   \   000031   12....       LCALL   ??Subroutine41_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_95:
   \   000034   F5..         MOV     ?V0 + 2,A
   1621            clusterID = pData->clusterId;
   \   000036   8E82         MOV     DPL,R6
   \   000038   8F83         MOV     DPH,R7
   \   00003A   A3           INC     DPTR
   \   00003B   A3           INC     DPTR
   \   00003C   A3           INC     DPTR
   \   00003D   A3           INC     DPTR
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   FA           MOV     R2,A
   \   000040   A3           INC     DPTR
   \   000041   E0           MOVX    A,@DPTR
   \   000042   FB           MOV     R3,A
   1622            SecurityUse = pData->SecurityUse;
   \   000043   EE           MOV     A,R6
   \   000044   240D         ADD     A,#0xd
   \   000046   12....       LCALL   ??Subroutine41_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_96:
   \   000049   F5..         MOV     ?V0 + 4,A
   1623          
   1624            if ( proVer == ZB_PROT_V1_0 )
   \   00004B   7401         MOV     A,#0x1
   \   00004D   6C           XRL     A,R4
   \   00004E   7015         JNZ     ??ZDP_IncomingData_0
   1625            {
   1626            asduLen = pData->cmd.DataLength;
   \   000050   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_97:
   \   000053   12....       LCALL   ?Subroutine42 & 0xFFFF
   1627            asdu = pData->cmd.Data;
   \                     ??CrossCallReturnLabel_99:
   \   000056   12....       LCALL   ??Subroutine23_0 & 0xFFFF
   1628            TransSeq = pData->cmd.TransSeqNumber;
   \                     ??CrossCallReturnLabel_61:
   \   000059   EE           MOV     A,R6
   \   00005A   2412         ADD     A,#0x12
   \   00005C   F582         MOV     DPL,A
   \   00005E   EF           MOV     A,R7
   \   00005F   3400         ADDC    A,#0x0
   \   000061   F583         MOV     DPH,A
   \   000063   8017         SJMP    ??ZDP_IncomingData_1
   1629            }
   1630            else
   1631            {
   1632              asduLen = pData->cmd.DataLength-1;
   \                     ??ZDP_IncomingData_0:
   \   000065   12....       LCALL   ?Subroutine41 & 0xFFFF
   \                     ??CrossCallReturnLabel_98:
   \   000068   14           DEC     A
   \   000069   12....       LCALL   ?Subroutine42 & 0xFFFF
   1633              asdu = pData->cmd.Data+1;
   \                     ??CrossCallReturnLabel_100:
   \   00006C   12....       LCALL   ??Subroutine14_0 & 0xFFFF
   \                     ??CrossCallReturnLabel_38:
   \   00006F   8882         MOV     DPL,R0
   \   000071   8983         MOV     DPH,R1
   \   000073   A3           INC     DPTR
   \   000074   AC82         MOV     R4,DPL
   \   000076   AD83         MOV     R5,DPH
   1634              TransSeq = pData->cmd.Data[0];
   \   000078   8882         MOV     DPL,R0
   \   00007A   8983         MOV     DPH,R1
   \                     ??ZDP_IncomingData_1:
   \   00007C   E0           MOVX    A,@DPTR
   \   00007D   F9           MOV     R1,A
   1635            }
   1636          
   1637            switch ( clusterID )
   \   00007E   8A..         MOV     ?V0 + 0,R2
   \   000080   8B..         MOV     ?V0 + 1,R3
   \   000082   78..         MOV     R0,#?V0 + 0
   \   000084   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for ZDP_IncomingData>_0`:
   \   000087   0400         DW        4
   \   000089   0000         DW        0
   \   00008B   0100         DW        1
   \   00008D   ....         DW        ??ZDP_IncomingData_2
   \   00008F   0080         DW        32768
   \   000091   0180         DW        32769
   \   000093   ....         DW        ??ZDP_IncomingData_3
   \   000095   0580         DW        32773
   \   000097   0680         DW        32774
   \   000099   ....         DW        ??ZDP_IncomingData_4
   \   00009B   2080         DW        32800
   \   00009D   2280         DW        32802
   \   00009F   ....         DW        ??ZDP_IncomingData_5
   \   0000A1   0E00         DW        14
   \   0000A3   0200         DW        2
   \   0000A5   ....         DW        ??ZDP_IncomingData_6
   \   0000A7   0300         DW        3
   \   0000A9   ....         DW        ??ZDP_IncomingData_7
   \   0000AB   0400         DW        4
   \   0000AD   ....         DW        ??ZDP_IncomingData_8
   \   0000AF   0500         DW        5
   \   0000B1   ....         DW        ??ZDP_IncomingData_9
   \   0000B3   0600         DW        6
   \   0000B5   ....         DW        ??ZDP_IncomingData_10
   \   0000B7   1100         DW        17
   \   0000B9   ....         DW        ??ZDP_IncomingData_11
   \   0000BB   1400         DW        20
   \   0000BD   ....         DW        ??ZDP_IncomingData_12
   \   0000BF   1500         DW        21
   \   0000C1   ....         DW        ??ZDP_IncomingData_13
   \   0000C3   2000         DW        32
   \   0000C5   ....         DW        ??ZDP_IncomingData_14
   \   0000C7   0280         DW        32770
   \   0000C9   ....         DW        ??ZDP_IncomingData_15
   \   0000CB   0380         DW        32771
   \   0000CD   ....         DW        ??ZDP_IncomingData_16
   \   0000CF   0480         DW        32772
   \   0000D1   ....         DW        ??ZDP_IncomingData_17
   \   0000D3   1180         DW        32785
   \   0000D5   ....         DW        ??ZDP_IncomingData_18
   \   0000D7   1580         DW        32789
   \   0000D9   ....         DW        ??ZDP_IncomingData_19
   \   0000DB   ....         DW        ??ZDP_IncomingData_20
   1638            {
   1639              // Response messages for our requests
   1640          
   1641          #if defined ( ZDO_NWKADDR_REQUEST ) || defined ( ZDO_IEEEADDR_REQUEST ) || defined ( REFLECTOR )
   1642              case NWK_addr_rsp:
   1643              case IEEE_addr_rsp:
   1644                ZDO_ProcessAddrRsp( srcAddr, clusterID, asdu, asduLen);
   \                     ??ZDP_IncomingData_3:
   \   0000DD                ; Setup parameters for call to function ZDO_ProcessAddrRsp
   \   0000DD   8C..         MOV     ?V0 + 0,R4
   \   0000DF   8D..         MOV     ?V0 + 1,R5
   \   0000E1   78..         MOV     R0,#?V0 + 0
   \   0000E3   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000E6   A9..         MOV     R1,?V0 + 3
   \   0000E8   EA           MOV     A,R2
   \   0000E9   FC           MOV     R4,A
   \   0000EA   EB           MOV     A,R3
   \   0000EB   FD           MOV     R5,A
   \   0000EC   7402         MOV     A,#0x2
   \   0000EE   12....       LCALL   ?XSTACK_DISP0_8
   \   0000F1   AA82         MOV     R2,DPL
   \   0000F3   AB83         MOV     R3,DPH
   \   0000F5   90....       MOV     DPTR,#(ZDO_ProcessAddrRsp & 0xffff)
   \   0000F8   74..         MOV     A,#((ZDO_ProcessAddrRsp >> 16) & 0xff)
   \                     ??ZDP_IncomingData_21:
   \   0000FA   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0000FD   7402         MOV     A,#0x2
   \   0000FF   12....       LCALL   ?DEALLOC_XSTACK8
   \   000102   02....       LJMP    ??ZDP_IncomingData_22 & 0xFFFF
   1645                break;
   1646          #endif
   1647          
   1648          #if defined ( ZDO_NODEDESC_REQUEST )
   1649              case Node_Desc_rsp:
   1650                ZDO_ProcessNodeDescRsp( srcAddr, asdu );
   \                     ??ZDP_IncomingData_15:
   \   000105                ; Setup parameters for call to function ZDO_ProcessNodeDescRsp
   \   000105   85..82       MOV     DPL,?XSP + 0
   \   000108   85..83       MOV     DPH,?XSP + 1
   \   00010B   AA82         MOV     R2,DPL
   \   00010D   AB83         MOV     R3,DPH
   \   00010F   90....       MOV     DPTR,#(ZDO_ProcessNodeDescRsp & 0xffff)
   \   000112   74..         MOV     A,#((ZDO_ProcessNodeDescRsp >> 16) & 0xff)
   \                     ??ZDP_IncomingData_23:
   \   000114   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   000117   02....       LJMP    ??ZDP_IncomingData_22 & 0xFFFF
   1651                break;
   1652          #endif
   1653          
   1654          #if defined ( ZDO_POWERDESC_REQUEST )
   1655              case Power_Desc_rsp:
   1656                ZDO_ProcessPowerDescRsp( srcAddr, asdu );
   \                     ??ZDP_IncomingData_16:
   \   00011A                ; Setup parameters for call to function ZDO_ProcessPowerDescRsp
   \   00011A   85..82       MOV     DPL,?XSP + 0
   \   00011D   85..83       MOV     DPH,?XSP + 1
   \   000120   AA82         MOV     R2,DPL
   \   000122   AB83         MOV     R3,DPH
   \   000124   90....       MOV     DPTR,#(ZDO_ProcessPowerDescRsp & 0xffff)
   \   000127   74..         MOV     A,#((ZDO_ProcessPowerDescRsp >> 16) & 0xff)
   \   000129   80E9         SJMP    ??ZDP_IncomingData_23
   1657                break;
   1658          #endif
   1659          
   1660          #if defined ( ZDO_SIMPLEDESC_REQUEST )
   1661              case Simple_Desc_rsp:
   1662                ZDO_ProcessSimpleDescRsp( srcAddr, asdu );
   \                     ??ZDP_IncomingData_17:
   \   00012B                ; Setup parameters for call to function ZDO_ProcessSimpleDescRsp
   \   00012B   85..82       MOV     DPL,?XSP + 0
   \   00012E   85..83       MOV     DPH,?XSP + 1
   \   000131   AA82         MOV     R2,DPL
   \   000133   AB83         MOV     R3,DPH
   \   000135   90....       MOV     DPTR,#(ZDO_ProcessSimpleDescRsp & 0xffff)
   \   000138   74..         MOV     A,#((ZDO_ProcessSimpleDescRsp >> 16) & 0xff)
   \                     ??ZDP_IncomingData_24:
   \   00013A   80D8         SJMP    ??ZDP_IncomingData_23
   1663                break;
   1664          #endif
   1665          
   1666          #if defined ( ZDO_MATCH_REQUEST ) || defined ( ZDO_ACTIVEEP_REQUEST )
   1667              case Match_Desc_rsp:
   1668              case Active_EP_rsp:
   1669                ZDO_ProcessEPListRsp( srcAddr, clusterID, asdu );
   \                     ??ZDP_IncomingData_4:
   \   00013C                ; Setup parameters for call to function ZDO_ProcessEPListRsp
   \   00013C   8C..         MOV     ?V0 + 0,R4
   \   00013E   8D..         MOV     ?V0 + 1,R5
   \   000140   78..         MOV     R0,#?V0 + 0
   \   000142   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000145   EA           MOV     A,R2
   \   000146   FC           MOV     R4,A
   \   000147   EB           MOV     A,R3
   \   000148   FD           MOV     R5,A
   \   000149   7402         MOV     A,#0x2
   \   00014B   12....       LCALL   ?XSTACK_DISP0_8
   \   00014E   AA82         MOV     R2,DPL
   \   000150   AB83         MOV     R3,DPH
   \   000152   90....       MOV     DPTR,#(ZDO_ProcessEPListRsp & 0xffff)
   \   000155   74..         MOV     A,#((ZDO_ProcessEPListRsp >> 16) & 0xff)
   \   000157   80A1         SJMP    ??ZDP_IncomingData_21
   1670                break;
   1671          #endif
   1672          
   1673          #if defined ( ZDO_BIND_UNBIND_REQUEST ) || defined ( ZDO_ENDDEVICEBIND_REQUEST ) || defined ( ZDO_COORDINATOR )
   1674            #if defined ( ZDO_BIND_UNBIND_REQUEST ) || defined ( ZDO_COORDINATOR )
   1675              case Bind_rsp:
   1676              case Unbind_rsp:
   1677            #endif
   1678            #if defined ( ZDO_BIND_UNBIND_REQUEST ) || defined ( ZDO_ENDDEVICEBIND_REQUEST )
   1679              case End_Device_Bind_rsp:
   1680            #endif
   1681                ZDO_ProcessBindUnbindRsp( srcAddr, clusterID, *asdu, TransSeq );
   \                     ??ZDP_IncomingData_5:
   \   000159                ; Setup parameters for call to function ZDO_ProcessBindUnbindRsp
   \   000159   E9           MOV     A,R1
   \   00015A   F5..         MOV     ?V0 + 0,A
   \   00015C   78..         MOV     R0,#?V0 + 0
   \   00015E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000161   8C82         MOV     DPL,R4
   \   000163   8D83         MOV     DPH,R5
   \   000165   E0           MOVX    A,@DPTR
   \   000166   F9           MOV     R1,A
   \   000167   EA           MOV     A,R2
   \   000168   FC           MOV     R4,A
   \   000169   EB           MOV     A,R3
   \   00016A   FD           MOV     R5,A
   \   00016B   7401         MOV     A,#0x1
   \   00016D   12....       LCALL   ?XSTACK_DISP0_8
   \   000170   AA82         MOV     R2,DPL
   \   000172   AB83         MOV     R3,DPH
   \   000174   90....       MOV     DPTR,#(ZDO_ProcessBindUnbindRsp & 0xffff)
   \   000177   74..         MOV     A,#((ZDO_ProcessBindUnbindRsp >> 16) & 0xff)
   \                     ??ZDP_IncomingData_25:
   \   000179   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   00017C   7401         MOV     A,#0x1
   \   00017E   12....       LCALL   ?DEALLOC_XSTACK8
   \   000181   02....       LJMP    ??ZDP_IncomingData_22 & 0xFFFF
   1682                break;
   1683          #endif
   1684          
   1685          #if defined ( ZDO_MGMT_NWKDISC_REQUEST )
   1686              case Mgmt_NWK_Disc_rsp:
   1687                ZDO_ProcessMgmNwkDiscRsp( srcAddr, asdu, SecurityUse );
   1688                break;
   1689          #endif
   1690          
   1691          #if defined ( ZDO_MGMT_LQI_REQUEST )
   1692              case Mgmt_Lqi_rsp:
   1693                ZDO_ProcessMgmtLqiRsp( srcAddr, asdu, SecurityUse );
   1694                break;
   1695          #endif
   1696          
   1697          #if defined ( ZDO_MGMT_RTG_REQUEST )
   1698              case Mgmt_Rtg_rsp:
   1699                ZDO_ProcessMgmtRtgRsp( srcAddr, asdu, SecurityUse );
   1700                break;
   1701          #endif
   1702          
   1703          #if defined ( ZDO_MGMT_BIND_REQUEST )
   1704              case Mgmt_Bind_rsp:
   1705                ZDO_ProcessMgmtBindRsp( srcAddr, asdu, SecurityUse );
   1706                break;
   1707          #endif
   1708          
   1709          #if defined ( ZDO_MGMT_JOINDIRECT_REQUEST )
   1710              case Mgmt_Direct_Join_rsp:
   1711                ZDO_ProcessMgmtDirectJoinRsp( srcAddr, *asdu, SecurityUse );
   1712                break;
   1713          #endif
   1714          
   1715          #if defined ( ZDO_MGMT_LEAVE_REQUEST )
   1716              case Mgmt_Leave_rsp:
   1717                ZDO_ProcessMgmtLeaveRsp( srcAddr, *asdu, SecurityUse );
   1718                break;
   1719          #endif
   1720          
   1721          #if defined ( ZDO_MGMT_PERMIT_JOIN_REQUEST )
   1722              case Mgmt_Permit_Join_rsp:
   1723                ZDO_ProcessMgmtPermitJoinRsp( srcAddr, *asdu, SecurityUse );
   1724                break;
   1725          #endif
   1726          
   1727          #if defined ( ZDO_USERDESC_REQUEST )
   1728              case User_Desc_rsp:
   1729                ZDO_ProcessUserDescRsp( srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_18:
   \   000184                ; Setup parameters for call to function ZDO_ProcessUserDescRsp
   \   000184   A9..         MOV     R1,?V0 + 4
   \   000186   85..82       MOV     DPL,?XSP + 0
   \   000189   85..83       MOV     DPH,?XSP + 1
   \   00018C   AA82         MOV     R2,DPL
   \   00018E   AB83         MOV     R3,DPH
   \   000190   90....       MOV     DPTR,#(ZDO_ProcessUserDescRsp & 0xffff)
   \   000193   74..         MOV     A,#((ZDO_ProcessUserDescRsp >> 16) & 0xff)
   \   000195   02....       LJMP    ??ZDP_IncomingData_23 & 0xFFFF
   1730                break;
   1731          #endif
   1732          
   1733          #if defined ( ZDO_SERVERDISC_REQUEST )
   1734              case Server_Discovery_rsp:
   1735                ZDO_ProcessServerDiscRsp( srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_19:
   \   000198                ; Setup parameters for call to function ZDO_ProcessServerDiscRsp
   \   000198   A9..         MOV     R1,?V0 + 4
   \   00019A   85..82       MOV     DPL,?XSP + 0
   \   00019D   85..83       MOV     DPH,?XSP + 1
   \   0001A0   AA82         MOV     R2,DPL
   \   0001A2   AB83         MOV     R3,DPH
   \   0001A4   90....       MOV     DPTR,#(ZDO_ProcessServerDiscRsp & 0xffff)
   \   0001A7   74..         MOV     A,#((ZDO_ProcessServerDiscRsp >> 16) & 0xff)
   \   0001A9   808F         SJMP    ??ZDP_IncomingData_24
   1736                break;
   1737          #endif
   1738          
   1739          #if defined( ZDO_CACHE )
   1740              case Discovery_Cache_rsp:
   1741              case Discovery_store_rsp:
   1742              case Remove_node_cache_rsp:
   1743              case Find_node_cache_rsp:
   1744              case Node_Desc_store_rsp:
   1745              case Power_Desc_store_rsp:
   1746              case Active_EP_store_rsp:
   1747              case Simple_Desc_store_rsp:
   1748              case Mgmt_Cache_rsp:
   1749          #if ( CACHE_DEV_MAX == 0 )
   1750                ZDCacheProcessRsp( srcAddr, asdu, asduLen, clusterID, TransSeq );
   1751          #endif
   1752                break;
   1753          #endif
   1754          
   1755              // Request messages
   1756              case NWK_addr_req:
   1757              case IEEE_addr_req:
   1758                zdpProcessAddrReq( TransSeq, srcAddr, asdu, clusterID, SecurityUse );
   \                     ??ZDP_IncomingData_2:
   \   0001AB                ; Setup parameters for call to function zdpProcessAddrReq
   \   0001AB   E5..         MOV     A,?V0 + 4
   \   0001AD   F5..         MOV     ?V0 + 0,A
   \   0001AF   78..         MOV     R0,#?V0 + 0
   \   0001B1   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001B4   8A..         MOV     ?V0 + 0,R2
   \   0001B6   78..         MOV     R0,#?V0 + 0
   \   0001B8   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0001BB   7403         MOV     A,#0x3
   \   0001BD   12....       LCALL   ?XSTACK_DISP0_8
   \   0001C0   AA82         MOV     R2,DPL
   \   0001C2   AB83         MOV     R3,DPH
   \   0001C4   90....       MOV     DPTR,#(??zdpProcessAddrReq & 0xffff)
   \   0001C7   74..         MOV     A,#((??zdpProcessAddrReq >> 16) & 0xff)
   \   0001C9   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0001CC   7403         MOV     A,#0x3
   \   0001CE   12....       LCALL   ?DEALLOC_XSTACK8
   \   0001D1   02....       LJMP    ??ZDP_IncomingData_22 & 0xFFFF
   1759                break;
   1760          
   1761              case Node_Desc_req:
   1762                ZDO_ProcessNodeDescReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_6:
   \   0001D4                ; Setup parameters for call to function ZDO_ProcessNodeDescReq
   \   0001D4   E5..         MOV     A,?V0 + 4
   \   0001D6   F5..         MOV     ?V0 + 0,A
   \   0001D8   78..         MOV     R0,#?V0 + 0
   \   0001DA   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001DD   7401         MOV     A,#0x1
   \   0001DF   12....       LCALL   ?XSTACK_DISP0_8
   \   0001E2   AA82         MOV     R2,DPL
   \   0001E4   AB83         MOV     R3,DPH
   \   0001E6   90....       MOV     DPTR,#(ZDO_ProcessNodeDescReq & 0xffff)
   \   0001E9   74..         MOV     A,#((ZDO_ProcessNodeDescReq >> 16) & 0xff)
   \   0001EB   808C         SJMP    ??ZDP_IncomingData_25
   1763                break;
   1764          
   1765              case Power_Desc_req:
   1766                ZDO_ProcessPowerDescReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_7:
   \   0001ED                ; Setup parameters for call to function ZDO_ProcessPowerDescReq
   \   0001ED   E5..         MOV     A,?V0 + 4
   \   0001EF   F5..         MOV     ?V0 + 0,A
   \   0001F1   78..         MOV     R0,#?V0 + 0
   \   0001F3   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0001F6   7401         MOV     A,#0x1
   \   0001F8   12....       LCALL   ?XSTACK_DISP0_8
   \   0001FB   AA82         MOV     R2,DPL
   \   0001FD   AB83         MOV     R3,DPH
   \   0001FF   90....       MOV     DPTR,#(ZDO_ProcessPowerDescReq & 0xffff)
   \   000202   74..         MOV     A,#((ZDO_ProcessPowerDescReq >> 16) & 0xff)
   \                     ??ZDP_IncomingData_26:
   \   000204   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1767                break;
   1768          
   1769              case Simple_Desc_req:
   1770                ZDO_ProcessSimpleDescReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_8:
   \   000207                ; Setup parameters for call to function ZDO_ProcessSimpleDescReq
   \   000207   E5..         MOV     A,?V0 + 4
   \   000209   F5..         MOV     ?V0 + 0,A
   \   00020B   78..         MOV     R0,#?V0 + 0
   \   00020D   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000210   7401         MOV     A,#0x1
   \   000212   12....       LCALL   ?XSTACK_DISP0_8
   \   000215   AA82         MOV     R2,DPL
   \   000217   AB83         MOV     R3,DPH
   \   000219   90....       MOV     DPTR,#(ZDO_ProcessSimpleDescReq & 0xffff)
   \   00021C   74..         MOV     A,#((ZDO_ProcessSimpleDescReq >> 16) & 0xff)
   \   00021E   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1771                break;
   1772          
   1773              case Active_EP_req:
   1774                ZDO_ProcessActiveEPReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_9:
   \   000221                ; Setup parameters for call to function ZDO_ProcessActiveEPReq
   \   000221   E5..         MOV     A,?V0 + 4
   \   000223   F5..         MOV     ?V0 + 0,A
   \   000225   78..         MOV     R0,#?V0 + 0
   \   000227   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00022A   7401         MOV     A,#0x1
   \   00022C   12....       LCALL   ?XSTACK_DISP0_8
   \   00022F   AA82         MOV     R2,DPL
   \   000231   AB83         MOV     R3,DPH
   \   000233   90....       MOV     DPTR,#(ZDO_ProcessActiveEPReq & 0xffff)
   \   000236   74..         MOV     A,#((ZDO_ProcessActiveEPReq >> 16) & 0xff)
   \   000238   80CA         SJMP    ??ZDP_IncomingData_26
   1775                break;
   1776          
   1777              case Match_Desc_req:
   1778                ZDO_ProcessMatchDescReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_10:
   \   00023A                ; Setup parameters for call to function ZDO_ProcessMatchDescReq
   \   00023A   E5..         MOV     A,?V0 + 4
   \   00023C   F5..         MOV     ?V0 + 0,A
   \   00023E   78..         MOV     R0,#?V0 + 0
   \   000240   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000243   7401         MOV     A,#0x1
   \   000245   12....       LCALL   ?XSTACK_DISP0_8
   \   000248   AA82         MOV     R2,DPL
   \   00024A   AB83         MOV     R3,DPH
   \   00024C   90....       MOV     DPTR,#(ZDO_ProcessMatchDescReq & 0xffff)
   \   00024F   74..         MOV     A,#((ZDO_ProcessMatchDescReq >> 16) & 0xff)
   \   000251   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1779                break;
   1780          
   1781          #if defined ( ZDO_COORDINATOR )
   1782              case End_Device_Bind_req:
   1783                ZDO_ProcessEndDeviceBindReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_14:
   \   000254                ; Setup parameters for call to function ZDO_ProcessEndDeviceBindReq
   \   000254   E5..         MOV     A,?V0 + 4
   \   000256   F5..         MOV     ?V0 + 0,A
   \   000258   78..         MOV     R0,#?V0 + 0
   \   00025A   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00025D   7401         MOV     A,#0x1
   \   00025F   12....       LCALL   ?XSTACK_DISP0_8
   \   000262   AA82         MOV     R2,DPL
   \   000264   AB83         MOV     R3,DPH
   \   000266   90....       MOV     DPTR,#(ZDO_ProcessEndDeviceBindReq & 0xffff)
   \   000269   74..         MOV     A,#((ZDO_ProcessEndDeviceBindReq >> 16) & 0xff)
   \   00026B   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1784                break;
   1785          #endif
   1786          
   1787          #if defined ( REFLECTOR ) || defined ( ZDO_BIND_UNBIND_RESPONSE )
   1788              case Bind_req:
   1789              case Unbind_req:
   1790                ZDO_ProcessBindUnbindReq( TransSeq, srcAddr, clusterID, asdu, SecurityUse );
   1791                break;
   1792          #endif
   1793          
   1794          #if defined ( ZDO_MGMT_NWKDISC_RESPONSE )
   1795              case Mgmt_NWK_Disc_req:
   1796                ZDO_ProcessMgmtNwkDiscReq( TransSeq, srcAddr, asdu, SecurityUse );
   1797                break;
   1798          #endif
   1799          
   1800          #if defined ( ZDO_MGMT_LQI_RESPONSE ) && defined ( RTR_NWK )
   1801              case Mgmt_Lqi_req:
   1802                ZDO_ProcessMgmtLqiReq( TransSeq, srcAddr, *asdu, SecurityUse );
   1803                break;
   1804          #endif
   1805          
   1806          #if defined ( ZDO_MGMT_RTG_RESPONSE ) && defined ( RTR_NWK )
   1807              case Mgmt_Rtg_req:
   1808                ZDO_ProcessMgmtRtgReq( TransSeq, srcAddr, *asdu, SecurityUse );
   1809                break;
   1810          #endif
   1811          
   1812          #if defined ( ZDO_MGMT_BIND_RESPONSE )
   1813              case Mgmt_Bind_req:
   1814                ZDO_ProcessMgmtBindReq( TransSeq, srcAddr, *asdu, SecurityUse );
   1815                break;
   1816          #endif
   1817          
   1818          #if defined ( ZDO_MGMT_JOINDIRECT_RESPONSE ) && defined ( RTR_NWK )
   1819              case Mgmt_Direct_Join_req:
   1820                ZDO_ProcessMgmtDirectJoinReq( TransSeq, srcAddr, asdu, SecurityUse );
   1821                break;
   1822          #endif
   1823          
   1824          #if defined ( ZDO_MGMT_LEAVE_RESPONSE )
   1825              case Mgmt_Leave_req:
   1826                ZDO_ProcessMgmtLeaveReq( TransSeq, srcAddr, asdu, SecurityUse );
   1827                break;
   1828          #endif
   1829          
   1830          #if defined ( ZDO_MGMT_PERMIT_JOIN_RESPONSE )  && defined ( RTR_NWK )
   1831              case Mgmt_Permit_Join_req:
   1832                ZDO_ProcessMgmtPermitJoinReq( TransSeq, srcAddr, asdu, SecurityUse );
   1833                break;
   1834          #endif
   1835          
   1836          #if defined ( ZDO_USERDESC_RESPONSE )
   1837              case User_Desc_req:
   1838                ZDO_ProcessUserDescReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_11:
   \   00026E                ; Setup parameters for call to function ZDO_ProcessUserDescReq
   \   00026E   E5..         MOV     A,?V0 + 4
   \   000270   F5..         MOV     ?V0 + 0,A
   \   000272   78..         MOV     R0,#?V0 + 0
   \   000274   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000277   7401         MOV     A,#0x1
   \   000279   12....       LCALL   ?XSTACK_DISP0_8
   \   00027C   AA82         MOV     R2,DPL
   \   00027E   AB83         MOV     R3,DPH
   \   000280   90....       MOV     DPTR,#(ZDO_ProcessUserDescReq & 0xffff)
   \   000283   74..         MOV     A,#((ZDO_ProcessUserDescReq >> 16) & 0xff)
   \   000285   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1839                break;
   1840          #endif
   1841          
   1842          #if defined ( ZDO_USERDESCSET_RESPONSE )
   1843              case User_Desc_set:
   1844                ZDO_ProcessUserDescSet( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_12:
   \   000288                ; Setup parameters for call to function ZDO_ProcessUserDescSet
   \   000288   E5..         MOV     A,?V0 + 4
   \   00028A   F5..         MOV     ?V0 + 0,A
   \   00028C   78..         MOV     R0,#?V0 + 0
   \   00028E   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000291   7401         MOV     A,#0x1
   \   000293   12....       LCALL   ?XSTACK_DISP0_8
   \   000296   AA82         MOV     R2,DPL
   \   000298   AB83         MOV     R3,DPH
   \   00029A   90....       MOV     DPTR,#(ZDO_ProcessUserDescSet & 0xffff)
   \   00029D   74..         MOV     A,#((ZDO_ProcessUserDescSet >> 16) & 0xff)
   \   00029F   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1845                break;
   1846          #endif
   1847          
   1848          #if defined ( ZDO_SERVERDISC_RESPONSE )
   1849              case Server_Discovery_req:
   1850                ZDO_ProcessServerDiscReq( TransSeq, srcAddr, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_13:
   \   0002A2                ; Setup parameters for call to function ZDO_ProcessServerDiscReq
   \   0002A2   E5..         MOV     A,?V0 + 4
   \   0002A4   F5..         MOV     ?V0 + 0,A
   \   0002A6   78..         MOV     R0,#?V0 + 0
   \   0002A8   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0002AB   7401         MOV     A,#0x1
   \   0002AD   12....       LCALL   ?XSTACK_DISP0_8
   \   0002B0   AA82         MOV     R2,DPL
   \   0002B2   AB83         MOV     R3,DPH
   \   0002B4   90....       MOV     DPTR,#(ZDO_ProcessServerDiscReq & 0xffff)
   \   0002B7   74..         MOV     A,#((ZDO_ProcessServerDiscReq >> 16) & 0xff)
   \   0002B9   02....       LJMP    ??ZDP_IncomingData_25 & 0xFFFF
   1851                break;
   1852          #endif
   1853          
   1854          #if defined ( ZDO_ENDDEVICE_ANNCE ) && defined ( RTR_NWK )
   1855              case End_Device_annce:
   1856                ZDO_ProcessEndDeviceAnnce( TransSeq, srcAddr, asdu, SecurityUse );
   1857                break;
   1858          #endif
   1859          
   1860          #if defined( ZDO_CACHE )
   1861              case Discovery_Cache_req:
   1862              case Discovery_store_req:
   1863              case Remove_node_cache_req:
   1864              case Find_node_cache_req:
   1865              case Node_Desc_store_req:
   1866              case Power_Desc_store_req:
   1867              case Active_EP_store_req:
   1868              case Simple_Desc_store_req:
   1869              case Mgmt_Cache_req:
   1870          #if ( CACHE_DEV_MAX > 0 )
   1871                ZDCacheProcessReq(srcAddr,asdu,asduLen,clusterID,TransSeq,SecurityUse);
   1872          #endif
   1873                break;
   1874          #endif
   1875          
   1876              case Complex_Desc_req:
   1877              case Complex_Desc_rsp:
   1878              default:
   1879                ZDApp_InMsgCB( TransSeq, srcAddr, wasBroadcast,
   1880                               clusterID, asduLen, asdu, SecurityUse );
   \                     ??ZDP_IncomingData_20:
   \   0002BC                ; Setup parameters for call to function ZDApp_InMsgCB
   \   0002BC   E5..         MOV     A,?V0 + 4
   \   0002BE   F5..         MOV     ?V0 + 0,A
   \   0002C0   78..         MOV     R0,#?V0 + 0
   \   0002C2   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0002C5   8C..         MOV     ?V0 + 0,R4
   \   0002C7   8D..         MOV     ?V0 + 1,R5
   \   0002C9   78..         MOV     R0,#?V0 + 0
   \   0002CB   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0002CE   8A..         MOV     ?V0 + 0,R2
   \   0002D0   8B..         MOV     ?V0 + 1,R3
   \   0002D2   78..         MOV     R0,#?V0 + 0
   \   0002D4   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0002D7   AD..         MOV     R5,?V0 + 3
   \   0002D9   AC..         MOV     R4,?V0 + 2
   \   0002DB   7405         MOV     A,#0x5
   \   0002DD   12....       LCALL   ?XSTACK_DISP0_8
   \   0002E0   AA82         MOV     R2,DPL
   \   0002E2   AB83         MOV     R3,DPH
   \   0002E4   90....       MOV     DPTR,#(ZDApp_InMsgCB & 0xffff)
   \   0002E7   74..         MOV     A,#((ZDApp_InMsgCB >> 16) & 0xff)
   \   0002E9   12....       LCALL   ?BCALL               ; Banked call to: DPTR()
   \   0002EC   7405         MOV     A,#0x5
   \   0002EE   12....       LCALL   ?DEALLOC_XSTACK8
   1881                break;
   1882            }
   1883          }
   \                     ??ZDP_IncomingData_22:
   \   0002F1   7409         MOV     A,#0x9
   \   0002F3   12....       LCALL   ?DEALLOC_XSTACK8
   \   0002F6   7F05         MOV     R7,#0x5
   \   0002F8   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine42:
   \   000000   F5..         MOV     ?V0 + 3,A
   \   000002   EE           MOV     A,R6
   \   000003   2415         ADD     A,#0x15
   \   000005   F582         MOV     DPL,A
   \   000007   EF           MOV     A,R7
   \   000008   3400         ADDC    A,#0x0
   \   00000A   F583         MOV     DPH,A
   \   00000C   22           RET

   \                                 In segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine41:
   \   000000   EE           MOV     A,R6
   \   000001   2413         ADD     A,#0x13
   \                     ??Subroutine41_0:
   \   000003   F582         MOV     DPL,A
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET

   \                                 In segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for ZDP_TmpBuf>`:
   \   000000   ....         DW ??ZDP_Buf + 1H
   1884          
   1885          /*********************************************************************
   1886          *********************************************************************/
   1887          

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     ZDP_BindUnbindReq                  1      0     29
       -> NLME_GetProtocolVersion       0      0     38
       -> osal_cpyExtAddr               0      0     38
       -> osal_cpyExtAddr               0      0     38
       -> osal_cpyExtAddr               0      0     38
       -> fillAndSend                   0      0     42
     ZDP_EPRsp                          1      0     27
       -> osal_memcpy                   0      0     40
       -> fillAndSend                   0      0     38
     ZDP_EndDeviceBindReq               1      0     30
       -> NLME_GetProtocolVersion       0      0     38
       -> NLME_GetExtAddr               0      0     38
       -> osal_cpyExtAddr               0      0     38
       -> fillAndSend                   0      0     42
     ZDP_GenericRsp                     1      0     17
       -> NLME_GetProtocolVersion       0      0     22
       -> fillAndSend                   0      0     26
     ZDP_IEEEAddrReq                    1      0     21
       -> fillAndSend                   0      0     42
     ZDP_IncomingData                   1      0     27
       -> NLME_GetProtocolVersion       0      0     44
       -> ZDO_ProcessAddrRsp            0      0     48
       -> ZDO_ProcessNodeDescRsp        0      0     44
       -> ZDO_ProcessPowerDescRsp       0      0     44
       -> ZDO_ProcessSimpleDescRsp      0      0     44
       -> ZDO_ProcessEPListRsp          0      0     48
       -> ZDO_ProcessBindUnbindRsp      0      0     46
       -> ZDO_ProcessUserDescRsp        0      0     44
       -> ZDO_ProcessServerDiscRsp      0      0     44
       -> zdpProcessAddrReq             0      0     50
       -> ZDO_ProcessNodeDescReq        0      0     46
       -> ZDO_ProcessPowerDescReq       0      0     46
       -> ZDO_ProcessSimpleDescReq      0      0     46
       -> ZDO_ProcessActiveEPReq        0      0     46
       -> ZDO_ProcessMatchDescReq       0      0     46
       -> ZDO_ProcessEndDeviceBindReq
                                        0      0     46
       -> ZDO_ProcessUserDescReq        0      0     46
       -> ZDO_ProcessUserDescSet        0      0     46
       -> ZDO_ProcessServerDiscReq      0      0     46
       -> ZDApp_InMsgCB                 0      0     54
     ZDP_MatchDescReq                   1      0     28
       -> NLME_GetProtocolVersion       0      0     36
       -> fillAndSend                   0      0     40
     ZDP_NWKAddrOfInterestReq           1      0     13
       -> fillAndSend                   0      0     24
     ZDP_NodeDescMsg                    1      0     18
       -> NLME_GetProtocolVersion       0      0     26
       -> fillAndSend                   0      0     30
     ZDP_NwkAddrReq                     1      0     23
       -> osal_ExtAddrEqual             0      0     42
       -> osal_cpyExtAddr               0      0     42
       -> fillAndSend                   0      0     46
     ZDP_PowerDescMsg                   1      0     16
       -> fillAndSend                   0      0     26
     ZDP_SendData                       1      0     21
       -> fillAndSend                   0      0     32
     ZDP_ServerDiscReq                  1      0     21
       -> fillAndSend                   0      0     42
     ZDP_ServerDiscRsp                  1      0     17
       -> fillAndSend                   0      0     26
     ZDP_SimpleDescMsg                  2      0     22
       -> NLME_GetProtocolVersion       0      0     32
       -> fillAndSend                   0      0     36
     ZDP_SimpleDescReq                  1      0     13
       -> fillAndSend                   0      0     24
     ZDP_UserDescRsp                    1      0     23
       -> osal_memcpy                   0      0     40
       -> fillAndSend                   0      0     38
     ZDP_UserDescSet                    1      0     21
       -> NLME_GetProtocolVersion       0      0     32
       -> osal_memcpy                   0      0     38
       -> osal_memset                   0      0     32
       -> fillAndSend                   0      0     36
     fillAndSend                        1      0     52
       -> AF_DataRequest                0      0     56
     zdpProcessAddrReq                  1      0     49
       -> osal_ExtAddrEqual             0      0     44
       -> osal_cpyExtAddr               0      0     44
       -> AssocMakeList                 0      0     44
       -> osal_mem_free                 0      0     44
       -> fillAndSend                   0      0     48


   Segment part sizes:

     Function/Label                Bytes
     --------------                -----
     ZDP_AF_ENDPOINT                  1
     ZDP_TransID                      1
     ZDP_Buf                         80
     ZDP_TmpBuf                       2
     ZDP_TxOptions                    1
     fillAndSend                    174
     ?Subroutine62                    8
     ?Subroutine49                    8
     ZDP_SendData                   115
     ?Subroutine66                    6
     ?Subroutine22                   12
     ?Subroutine18                   11
     ?Subroutine25                    9
     ?Subroutine14                    9
     ZDP_NWKAddrOfInterestReq        20
     ?Subroutine70                   20
     ?Subroutine63                   36
     ?Subroutine5                    14
     ?Subroutine48                    8
     ?Subroutine61                    2
     ?Subroutine65                    7
     ZDP_NwkAddrReq                 145
     ?Subroutine64                    8
     ?Subroutine32                   10
     ?Subroutine13                   16
     ZDP_IEEEAddrReq                 84
     ?Subroutine71                    5
     ZDP_MatchDescReq               236
     ?Subroutine29                    4
     ?Subroutine60                    9
     ?Subroutine15                    4
     ?Subroutine10                    5
     ?Subroutine33                   11
     ?Subroutine67                    6
     ?Subroutine69                   10
     ?Subroutine20                    8
     ?Subroutine35                    4
     ?Subroutine53                    4
     ?Subroutine19                    9
     ?Subroutine2                    15
     ?Subroutine46                    7
     ?Subroutine55                   16
     ?Subroutine44                    8
     ZDP_SimpleDescReq               27
     ?Subroutine21                    7
     ZDP_UserDescSet                180
     ?Subroutine36                    7
     ZDP_ServerDiscReq               95
     ?Subroutine23                    9
     zdpProcessAddrReq              520
     ?Subroutine16                    4
     ?Subroutine47                    7
     ?Subroutine68                    5
     ?Subroutine58                    8
     ?Subroutine38                    4
     ?Subroutine54                    4
     ?Subroutine57                    9
     ?Subroutine31                    8
     ?Subroutine8                    10
     ZDP_NodeDescMsg                187
     ?Subroutine12                    6
     ?Subroutine52                    4
     ?Subroutine56                    9
     ?Subroutine9                     4
     ?Subroutine43                    8
     ?Subroutine7                     6
     ?Subroutine28                    2
     ?Subroutine24                    5
     ZDP_PowerDescMsg                69
     ?Subroutine39                    9
     ZDP_SimpleDescMsg              430
     ?Subroutine40                    9
     ?Subroutine6                    14
     ?Subroutine59                    8
     ?Subroutine4                     8
     ?Subroutine50                   13
     ?Subroutine3                    12
     ?Subroutine45                    7
     ?Subroutine30                    5
     ZDP_EPRsp                      183
     ?Subroutine72                    4
     ?Subroutine17                   15
     ZDP_UserDescRsp                168
     ZDP_ServerDiscRsp               59
     ZDP_GenericRsp                 101
     ?Subroutine26                    4
     ZDP_EndDeviceBindReq           282
     ?Subroutine73                    5
     ?Subroutine34                    6
     ?Subroutine1                     7
     ?Subroutine0                     9
     ?Subroutine51                    9
     ?Subroutine37                   10
     ZDP_BindUnbindReq              277
     ?Subroutine11                   12
     ZDP_IncomingData               763
     ?Subroutine42                   13
     ?Subroutine41                   12
     ?<Initializer for ZDP_TmpBuf>    2

 
 4 741 bytes in segment BANKED_CODE
     1 byte  in segment CODE_C
     2 bytes in segment XDATA_I
     2 bytes in segment XDATA_ID
    82 bytes in segment XDATA_Z
 
 4 744 bytes of CODE  memory
    84 bytes of XDATA memory

Errors: none
Warnings: none
